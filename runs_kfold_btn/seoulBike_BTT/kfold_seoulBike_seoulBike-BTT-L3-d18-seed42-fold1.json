{
  "experiment_name": "kfold_seoulBike",
  "run_name": "seoulBike-BTT-L3-d18-seed42-fold1",
  "config": {
    "params": {
      "model": "BTT",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 1,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 1,
    "dataset": "seoulBike",
    "n_features": 18,
    "n_train": 5957,
    "n_val": 1051,
    "n_test": 1752,
    "L": 3,
    "bond_dim": 18,
    "model": "BTT",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 986360.0797516725,
      "train_quality": -1.391200459527099,
      "val_loss": 973832.9593722397,
      "val_quality": -1.2164794878980998,
      "patience_counter": 0,
      "elbo_raw": -2938392410.388855,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -62763.19238978982,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -1.0,
      "h_nodes": -5298.807500668584,
      "h_bonds": 271.35147773421374,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 1,
      "train_loss": 104339.20532155751,
      "train_quality": 0.7470538793759637,
      "val_loss": 477609.07252943027,
      "val_quality": -0.08705574432182739,
      "test_quality": 0.23721418327328803,
      "patience_counter": 0,
      "elbo_raw": -1328257.123736901,
      "elbo_relative": 2937064153.265118,
      "e_log_p_nodes": -1249202.7064407286,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -0.0001,
      "h_nodes": -14793.839337227917,
      "h_bonds": 271.35147773421374,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 2,
      "train_loss": 119327.06414712404,
      "train_quality": 0.7107193037511625,
      "val_loss": 132487.04033237233,
      "val_quality": 0.6984546430854736,
      "test_quality": 0.6273179671239186,
      "patience_counter": 0,
      "elbo_raw": -95578.99391131713,
      "elbo_relative": 2938296831.3949437,
      "e_log_p_nodes": -19581.081601873157,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -0.0001,
      "h_nodes": -7269.899023712703,
      "h_bonds": 271.35147773421374,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 3,
      "train_loss": 115669.71063365377,
      "train_quality": 0.7195857061751789,
      "val_loss": 126978.6397329631,
      "val_quality": 0.710991964627339,
      "test_quality": 0.6110196006702613,
      "patience_counter": 0,
      "elbo_raw": -90794.99173405005,
      "elbo_relative": 2938301615.397121,
      "e_log_p_nodes": -16299.290170730217,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6855.162723401856,
      "h_bonds": 271.35147773421374,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 4,
      "train_loss": 114516.6260143072,
      "train_quality": 0.7223810914794477,
      "val_loss": 125544.34088627726,
      "val_quality": 0.7142564813420376,
      "test_quality": 0.590702031580769,
      "patience_counter": 0,
      "elbo_raw": -89950.87725524888,
      "elbo_relative": 2938302459.5115995,
      "e_log_p_nodes": -15808.518029021398,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6845.330913893022,
      "h_bonds": 271.35147773421374,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 5,
      "train_loss": 114029.37152767208,
      "train_quality": 0.7235623265844227,
      "val_loss": 125042.57292201337,
      "val_quality": 0.7153985236089089,
      "test_quality": 0.5969876483255201,
      "patience_counter": 0,
      "elbo_raw": -89579.6444422795,
      "elbo_relative": 2938302830.744413,
      "e_log_p_nodes": -15579.6358032843,
      "e_log_p_bonds": -535.0928264886039,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6848.319847038615,
      "h_bonds": 271.35147773421374,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 6,
      "train_loss": 113732.18881575279,
      "train_quality": 0.7242827769066658,
      "val_loss": 124746.06621646743,
      "val_quality": 0.7160733837320354,
      "test_quality": 0.6044337514615894,
      "patience_counter": 0,
      "elbo_raw": -82078.57005354237,
      "elbo_relative": 2938310331.8188014,
      "e_log_p_nodes": -7264.347950466235,
      "e_log_p_bonds": -1223.5456724003488,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6851.257797363147,
      "h_bonds": 60.0442551640054,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 2.609929812526538,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 7,
      "train_loss": 109403.52241976983,
      "train_quality": 0.7347766211808784,
      "val_loss": 124941.58040969612,
      "val_quality": 0.7156283862663884,
      "test_quality": 0.4054142096941057,
      "patience_counter": 1,
      "elbo_raw": -73286.3605682941,
      "elbo_relative": 2938319124.0282865,
      "e_log_p_nodes": -7445.924183833726,
      "e_log_p_bonds": -1423.6560833981673,
      "e_log_p_tau": -0.0001,
      "h_nodes": 1149.4559196075247,
      "h_bonds": 42.081543746794836,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 2.9150568620735453,
      "n_parameters": 7128,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 8,
      "train_loss": 2075899.4072313793,
      "train_quality": -4.0325349924476095,
      "val_loss": 2018015.62261258,
      "val_quality": -3.5930774787721784,
      "test_quality": -4.942097170976681,
      "patience_counter": 2,
      "elbo_raw": -653010.9519902532,
      "elbo_relative": 2938325770.844261,
      "e_log_p_nodes": -3492.9016746891116,
      "e_log_p_bonds": -1572.9936384207056,
      "e_log_p_tau": -0.0001,
      "h_nodes": 3312.592544358962,
      "h_bonds": 3.731748147505762,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 3.179422115008465,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 9,
      "train_loss": 105906.23099907087,
      "train_quality": 0.7432549903119374,
      "val_loss": 132342.39742726216,
      "val_quality": 0.6987838556359025,
      "test_quality": -0.19166093560400865,
      "patience_counter": 3,
      "elbo_raw": -65451.90630076497,
      "elbo_relative": 2938913329.8899508,
      "e_log_p_nodes": -3512.5423091645225,
      "e_log_p_bonds": -1778.2838341955687,
      "e_log_p_tau": -0.0001,
      "h_nodes": 4326.7422574775455,
      "h_bonds": -8.783629751412484,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 3.5244983964889394,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 10,
      "train_loss": 105461.26991501746,
      "train_quality": 0.7443336949052215,
      "val_loss": 139501.70058578774,
      "val_quality": 0.6824890193954603,
      "test_quality": -0.20056122929534848,
      "patience_counter": 4,
      "elbo_raw": -63774.28295395225,
      "elbo_relative": 2938915007.5132976,
      "e_log_p_nodes": -3530.090982043631,
      "e_log_p_bonds": -1973.1480825576182,
      "e_log_p_tau": -0.0001,
      "h_nodes": 6095.460647725432,
      "h_bonds": -21.481716467080503,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 4.1218310226261385,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 11,
      "train_loss": 105230.10420257016,
      "train_quality": 0.744894102376264,
      "val_loss": 157731.8810005663,
      "val_quality": 0.6409964609837119,
      "test_quality": -0.16865703406927013,
      "patience_counter": 5,
      "elbo_raw": -62195.39946925179,
      "elbo_relative": 2938916586.396782,
      "e_log_p_nodes": -3530.0406554849737,
      "e_log_p_bonds": -2183.4499448467614,
      "e_log_p_tau": -0.0001,
      "h_nodes": 7832.039856944724,
      "h_bonds": -37.90182171059679,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 4.606505013194743,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 12,
      "train_loss": 105122.27712970036,
      "train_quality": 0.7451555040200335,
      "val_loss": 176827.33694578227,
      "val_quality": 0.5975345037688762,
      "test_quality": -0.09354951947004286,
      "patience_counter": 6,
      "elbo_raw": -60745.471975112625,
      "elbo_relative": 2938918036.324276,
      "e_log_p_nodes": -3525.9679915491747,
      "e_log_p_bonds": -2398.124165052902,
      "e_log_p_tau": -0.0001,
      "h_nodes": 9478.738040482825,
      "h_bonds": -56.15624896069403,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.004795372714326,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 13,
      "train_loss": 105116.8849923341,
      "train_quality": 0.7451685760021753,
      "val_loss": 203413.4714167221,
      "val_quality": 0.5370234878392808,
      "test_quality": -0.10840546373078386,
      "patience_counter": 7,
      "elbo_raw": -59272.09659884514,
      "elbo_relative": 2938919509.6996527,
      "e_log_p_nodes": -3522.4894206179674,
      "e_log_p_bonds": -2612.324000482278,
      "e_log_p_tau": -0.0001,
      "h_nodes": 11180.472287604542,
      "h_bonds": -75.34655473382966,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.335444283266158,
      "n_parameters": 3191,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 11,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 14,
      "train_loss": 22585804.141778037,
      "train_quality": -53.75402578762679,
      "val_loss": 21504554.15443752,
      "val_quality": -47.94515298643255,
      "test_quality": -158.73093151677273,
      "patience_counter": 8,
      "elbo_raw": -6753350.459208051,
      "elbo_relative": 2938921056.6514087,
      "e_log_p_nodes": -3483.315260714392,
      "e_log_p_bonds": -2818.4454038641466,
      "e_log_p_tau": -0.0001,
      "h_nodes": 13165.284550774955,
      "h_bonds": -96.44117140922685,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.564165554125088,
      "n_parameters": 3166,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 10,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 15,
      "train_loss": 138523.67534643083,
      "train_quality": 0.6641815874916988,
      "val_loss": 188863.88510561563,
      "val_quality": 0.5701388792476378,
      "test_quality": 0.35725417417520966,
      "patience_counter": 9,
      "elbo_raw": -65301.51047504079,
      "elbo_relative": 2945609105.6001415,
      "e_log_p_nodes": -3493.3955238658145,
      "e_log_p_bonds": -3030.338474819164,
      "e_log_p_tau": -0.0001,
      "h_nodes": 15530.644150046024,
      "h_bonds": -118.82282200686687,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.6210909743607775,
      "n_parameters": 3166,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 10,
      "dim_b_lvl0_0": 7
    },
    {
      "step": 16,
      "train_loss": 109808.79233465927,
      "train_quality": 0.7337941385899769,
      "val_loss": 227223.51312234398,
      "val_quality": 0.48283096073429443,
      "test_quality": -0.08428988555913208,
      "patience_counter": 10,
      "elbo_raw": -55293.74278629673,
      "elbo_relative": 2945619113.3678303,
      "e_log_p_nodes": -3502.3892785390317,
      "e_log_p_bonds": -3234.6718248611733,
      "e_log_p_tau": -0.0001,
      "h_nodes": 17218.46642549445,
      "h_bonds": -138.61840715472434,
      "h_tau": -11.791269113840826,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.8255584011848445,
      "n_parameters": 3166,
      "dim_x0": 18,
      "dim_b_leaf_0": 18,
      "dim_x1": 18,
      "dim_b_leaf_1": 18,
      "dim_x2": 18,
      "dim_b_leaf_2": 10,
      "dim_b_lvl0_0": 7
    }
  ],
  "summary": {}
}