{
  "experiment_name": "kfold_bike",
  "run_name": "bike-BTT-L3-d18-seed42-fold4",
  "config": {
    "params": {
      "model": "BTT",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 4,
    "dataset": "bike",
    "n_features": 13,
    "n_train": 11819,
    "n_val": 2085,
    "n_test": 3475,
    "L": 3,
    "bond_dim": 18,
    "model": "BTT",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 73109.6783035422,
      "train_quality": -1.2402211971017572,
      "val_loss": 74174.10163830382,
      "val_quality": -1.2836038512009775,
      "patience_counter": 0,
      "elbo_raw": -432148412.6371963,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -49331.19347033597,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -1.0,
      "h_nodes": -5166.4389073937355,
      "h_bonds": 239.0477303849026,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 1,
      "train_loss": 11626.98910241619,
      "train_quality": 0.643726685028487,
      "val_loss": 11410.189532484455,
      "val_quality": 0.6487136051020405,
      "patience_counter": 0,
      "elbo_raw": -168632.86322162225,
      "elbo_relative": 431979779.77397466,
      "e_log_p_nodes": -83004.22111503556,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -0.0001,
      "h_nodes": -13223.245377334479,
      "h_bonds": 239.0477303849026,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 2,
      "train_loss": 12437.726774511832,
      "train_quality": 0.61888412299755,
      "val_loss": 11846.964150227297,
      "val_quality": 0.6352665908861067,
      "patience_counter": 1,
      "elbo_raw": -93998.54041224344,
      "elbo_relative": 432054414.09678406,
      "e_log_p_nodes": -14556.250648396803,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6556.353998650302,
      "h_bonds": 239.0477303849026,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 3,
      "train_loss": 12406.63184045948,
      "train_quality": 0.6198369315996798,
      "val_loss": 11740.215611810157,
      "val_quality": 0.6385530664625574,
      "patience_counter": 2,
      "elbo_raw": -92429.39974693651,
      "elbo_relative": 432055983.23744935,
      "e_log_p_nodes": -13173.76005096401,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6387.153544200524,
      "h_bonds": 239.0477303849026,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 4,
      "train_loss": 12425.393943001136,
      "train_quality": 0.6192620246818638,
      "val_loss": 11755.971520061314,
      "val_quality": 0.6380679880865905,
      "patience_counter": 3,
      "elbo_raw": -91848.82651432739,
      "elbo_relative": 432056563.810682,
      "e_log_p_nodes": -12621.350930710287,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6347.748311137386,
      "h_bonds": 239.0477303849026,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 5,
      "train_loss": 12457.150232187587,
      "train_quality": 0.6182889508860605,
      "val_loss": 11815.927085060373,
      "val_quality": 0.636222131431657,
      "patience_counter": 4,
      "elbo_raw": -91516.02023501573,
      "elbo_relative": 432056896.6169613,
      "e_log_p_nodes": -12295.98486545258,
      "e_log_p_bonds": -471.39129952567487,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6321.41520583979,
      "h_bonds": 239.0477303849026,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.0,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 6,
      "train_loss": 12471.67278757376,
      "train_quality": 0.6178439518494472,
      "val_loss": 11849.93474245404,
      "val_quality": 0.6351751350315766,
      "patience_counter": 5,
      "elbo_raw": -86712.31208418612,
      "elbo_relative": 432061700.3251121,
      "e_log_p_nodes": -6941.890568183459,
      "e_log_p_bonds": -876.2706221832966,
      "e_log_p_tau": -0.0001,
      "h_nodes": -6303.814584110346,
      "h_bonds": 84.58442157524964,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 3.2839005504999936,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 7,
      "train_loss": 12205.069260241067,
      "train_quality": 0.6260131968387779,
      "val_loss": 11606.559803491424,
      "val_quality": 0.642667938255685,
      "patience_counter": 6,
      "elbo_raw": -79857.05415614249,
      "elbo_relative": 432068555.5830402,
      "e_log_p_nodes": -7039.380531910431,
      "e_log_p_bonds": -1090.272114668744,
      "e_log_p_tau": -0.0001,
      "h_nodes": 827.0764017999173,
      "h_bonds": 66.88065171899746,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 3.8555670330650034,
      "n_parameters": 6858,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 18,
      "dim_b_lvl0_0": 18
    },
    {
      "step": 8,
      "train_loss": 40747.82153236873,
      "train_quality": -0.2485916454663033,
      "val_loss": 41108.33743274703,
      "val_quality": -0.26560559015133234,
      "patience_counter": 7,
      "elbo_raw": -90156.82303444145,
      "elbo_relative": 432074368.67381454,
      "e_log_p_nodes": -3439.3976441838345,
      "e_log_p_bonds": -1243.3534294805188,
      "e_log_p_tau": -0.0001,
      "h_nodes": 3906.9965283426277,
      "h_bonds": 9.175369682480273,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 4.232921440024705,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 9,
      "train_loss": 14527.476652538931,
      "train_quality": 0.5548501663172851,
      "val_loss": 13772.983973304472,
      "val_quality": 0.5759700684028849,
      "patience_counter": 8,
      "elbo_raw": -71563.45137391196,
      "elbo_relative": 432092962.04547507,
      "e_log_p_nodes": -3459.721378243334,
      "e_log_p_bonds": -1483.228816480271,
      "e_log_p_tau": -0.0001,
      "h_nodes": 7269.947422678312,
      "h_bonds": -1.7461877937905648,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.10038112500686,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 10,
      "train_loss": 15447.02310824721,
      "train_quality": 0.5266734938219602,
      "val_loss": 14822.979325958731,
      "val_quality": 0.5436437796025608,
      "patience_counter": 9,
      "elbo_raw": -69175.68095178893,
      "elbo_relative": 432095349.8158972,
      "e_log_p_nodes": -3483.246039270065,
      "e_log_p_bonds": -1749.7049319975777,
      "e_log_p_tau": -0.0001,
      "h_nodes": 10520.27952803174,
      "h_bonds": -28.544589148474337,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 5.8068582081737095,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 11,
      "train_loss": 13798.059198451034,
      "train_quality": 0.5772009204185315,
      "val_loss": 13211.763625805743,
      "val_quality": 0.5932484030050342,
      "patience_counter": 10,
      "elbo_raw": -65360.267198550086,
      "elbo_relative": 432099165.22965044,
      "e_log_p_nodes": -3509.283620833183,
      "e_log_p_bonds": -2012.1759789393732,
      "e_log_p_tau": -0.0001,
      "h_nodes": 13677.687236683423,
      "h_bonds": -56.42653683062932,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.260111551188595,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 12,
      "train_loss": 18650.364011880192,
      "train_quality": 0.42851696570721376,
      "val_loss": 18042.275457035554,
      "val_quality": 0.44453105857585906,
      "patience_counter": 11,
      "elbo_raw": -65410.982843810925,
      "elbo_relative": 432099114.5140052,
      "e_log_p_nodes": -3532.1145359625225,
      "e_log_p_bonds": -2277.354131362571,
      "e_log_p_tau": -0.0001,
      "h_nodes": 16810.650658373877,
      "h_bonds": -84.49593187119527,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.700270499606714,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 13,
      "train_loss": 32371.66012572171,
      "train_quality": 0.008070054720759057,
      "val_loss": 31952.65014922526,
      "val_quality": 0.016271268202758704,
      "patience_counter": 12,
      "elbo_raw": -70691.74330628203,
      "elbo_relative": 432093833.7535427,
      "e_log_p_nodes": -3557.066812100722,
      "e_log_p_bonds": -2542.189956547439,
      "e_log_p_tau": -0.0001,
      "h_nodes": 19957.122792760885,
      "h_bonds": -113.19978583786877,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.905383515353962,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 14,
      "train_loss": 33967.0821018796,
      "train_quality": -0.04081674402114843,
      "val_loss": 33576.433750264325,
      "val_quality": -0.03372028414433337,
      "patience_counter": 13,
      "elbo_raw": -68764.39223747015,
      "elbo_relative": 432095761.1046115,
      "e_log_p_nodes": -3584.109948553168,
      "e_log_p_bonds": -2806.4216008251237,
      "e_log_p_tau": -0.0001,
      "h_nodes": 23147.677540957877,
      "h_bonds": -142.30199718071276,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.975608930838042,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 15,
      "train_loss": 33866.30773005497,
      "train_quality": -0.0377288233911488,
      "val_loss": 33473.485324926376,
      "val_quality": -0.03055080294558299,
      "patience_counter": 14,
      "elbo_raw": -65828.28217296118,
      "elbo_relative": 432098697.214676,
      "e_log_p_nodes": -3612.5314802724247,
      "e_log_p_bonds": -3070.30588756987,
      "e_log_p_tau": -0.0001,
      "h_nodes": 26345.919466248553,
      "h_bonds": -171.68158580221373,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.986015335286951,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 16,
      "train_loss": 34312.504265690186,
      "train_quality": -0.0514011436693651,
      "val_loss": 33926.50244757881,
      "val_quality": -0.044497876426751404,
      "patience_counter": 15,
      "elbo_raw": -63208.40794438051,
      "elbo_relative": 432101317.0889046,
      "e_log_p_nodes": -3641.9538985452577,
      "e_log_p_bonds": -3334.0500233127505,
      "e_log_p_tau": -0.0001,
      "h_nodes": 29552.236449303688,
      "h_bonds": -201.2746802360444,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.964711194139186,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 17,
      "train_loss": 34305.072212087434,
      "train_quality": -0.051173411248634615,
      "val_loss": 33918.86454189274,
      "val_quality": -0.04426272762879391,
      "patience_counter": 16,
      "elbo_raw": -60339.50069750438,
      "elbo_relative": 432104185.9961515,
      "e_log_p_nodes": -3671.9767413017967,
      "e_log_p_bonds": -3597.912400329339,
      "e_log_p_tau": -0.0001,
      "h_nodes": 32740.341065764667,
      "h_bonds": -230.9788842024854,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.930658970213905,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 18,
      "train_loss": 34554.056702222355,
      "train_quality": -0.05880277504140086,
      "val_loss": 34168.880886986364,
      "val_quality": -0.05196000034135162,
      "patience_counter": 17,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -3702.3885568469977,
      "e_log_p_bonds": -3861.9113239180087,
      "e_log_p_tau": -0.0001,
      "h_nodes": 0.0,
      "h_bonds": -260.7461882936375,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.890689039403132,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 19,
      "train_loss": 34597.629291343714,
      "train_quality": -0.060137923000293414,
      "val_loss": 34214.73798274939,
      "val_quality": -0.05337180632452343,
      "patience_counter": 18,
      "elbo_raw": -54783.96598829836,
      "elbo_relative": 432109741.5308607,
      "e_log_p_nodes": -3733.262920080372,
      "e_log_p_bonds": -4125.946508723779,
      "e_log_p_tau": -0.0001,
      "h_nodes": 39117.72936160402,
      "h_bonds": -290.6233967018443,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.839634253255821,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 20,
      "train_loss": 34755.06493035666,
      "train_quality": -0.06496205386613774,
      "val_loss": 34376.8161654477,
      "val_quality": -0.05836171997403872,
      "patience_counter": 19,
      "elbo_raw": -52009.71611025607,
      "elbo_relative": 432112515.7807388,
      "e_log_p_nodes": -3764.947460723288,
      "e_log_p_bonds": -4390.210000742375,
      "e_log_p_tau": -0.0001,
      "h_nodes": 42311.02321073406,
      "h_bonds": -320.68161978062824,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.772798939479978,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 21,
      "train_loss": 34764.1198165836,
      "train_quality": -0.06523951300060027,
      "val_loss": 34392.19138358907,
      "val_quality": -0.0588350780139093,
      "patience_counter": 20,
      "elbo_raw": -49156.4226501615,
      "elbo_relative": 432115369.07419884,
      "e_log_p_nodes": -3795.8587959589086,
      "e_log_p_bonds": -4654.81738264974,
      "e_log_p_tau": -0.0001,
      "h_nodes": 45495.080571344195,
      "h_bonds": -350.5758102673305,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.72568017666926,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    },
    {
      "step": 22,
      "train_loss": 34691.105203082196,
      "train_quality": -0.06300220477192875,
      "val_loss": 34309.81000275681,
      "val_quality": -0.05629879601816423,
      "patience_counter": 21,
      "elbo_raw": -46264.56775630347,
      "elbo_relative": 432118260.9290927,
      "e_log_p_nodes": -3824.9740579574245,
      "e_log_p_bonds": -4919.448924353398,
      "e_log_p_tau": -0.0001,
      "h_nodes": 48666.91886895231,
      "h_bonds": -379.96093323252296,
      "h_tau": -12.133701092556294,
      "tau_mean": 0.0001,
      "bond_mean_avg": 6.728994273206453,
      "n_parameters": 3406,
      "dim_x0": 13,
      "dim_b_leaf_0": 18,
      "dim_x1": 13,
      "dim_b_leaf_1": 18,
      "dim_x2": 13,
      "dim_b_leaf_2": 1,
      "dim_b_lvl0_0": 9
    }
  ],
  "summary": {}
}