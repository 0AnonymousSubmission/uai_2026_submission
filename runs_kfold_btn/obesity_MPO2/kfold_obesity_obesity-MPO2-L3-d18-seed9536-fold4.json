{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed9536-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 4,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4473.784454686662,
      "train_quality": -1172.6000444832466,
      "val_loss": 4435.316212867852,
      "val_quality": -1198.4193253405529,
      "patience_counter": 0,
      "elbo_raw": -3392168.435347082,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145672.90423734512,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.280482843554251,
      "train_quality": 0.6640931771799999,
      "val_loss": 1.6579056648213897,
      "val_quality": 0.5516612573847169,
      "test_quality": 0.5222955743446733,
      "patience_counter": 0,
      "elbo_raw": -36953.33626244766,
      "elbo_relative": 3355215.0990846343,
      "e_log_p_nodes": -20118.07987189557,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7663972786141957,
      "h_nodes": -14282.74039658925,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.136510516946146,
      "tau_mean": 0.7663972786141957,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1080287826467108,
      "train_quality": 0.7093327490910658,
      "val_loss": 1.6648197824719042,
      "val_quality": 0.5497915087738635,
      "test_quality": 0.5508693434069303,
      "patience_counter": 1,
      "elbo_raw": -36145.52059952453,
      "elbo_relative": 3356022.9147475576,
      "e_log_p_nodes": -19762.441784784347,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8232667923810494,
      "h_nodes": -13882.02844338903,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.064930874010315,
      "tau_mean": 0.8232667923810494,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9728622447135189,
      "train_quality": 0.7447907503733718,
      "val_loss": 1.6055560879752024,
      "val_quality": 0.5658178791742867,
      "test_quality": 0.5810480440594219,
      "patience_counter": 0,
      "elbo_raw": -35961.712291064454,
      "elbo_relative": 3356206.7230560174,
      "e_log_p_nodes": -19699.564649219963,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9053479343829164,
      "h_nodes": -13829.430583122927,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9698918650310588,
      "tau_mean": 0.9053479343829164,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8895682417717018,
      "train_quality": 0.7666411203560604,
      "val_loss": 1.5198088649759327,
      "val_quality": 0.5890060514315947,
      "test_quality": 0.5997849341041339,
      "patience_counter": 0,
      "elbo_raw": -35877.2874682797,
      "elbo_relative": 3356291.1478788024,
      "e_log_p_nodes": -19683.35352346289,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9765000350638641,
      "h_nodes": -13815.613159229546,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8942364065032962,
      "tau_mean": 0.9765000350638641,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8384208158592866,
      "train_quality": 0.780058535060323,
      "val_loss": 1.4559465473368476,
      "val_quality": 0.6062760033946877,
      "test_quality": 0.6089344534613892,
      "patience_counter": 0,
      "elbo_raw": -35831.364643183486,
      "elbo_relative": 3356337.0707038986,
      "e_log_p_nodes": -19678.659330136747,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0301539403173832,
      "h_nodes": -13812.842927241192,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8407476660531756,
      "tau_mean": 1.0301539403173832,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.805919167336581,
      "train_quality": 0.7885846356220224,
      "val_loss": 1.4096279954993378,
      "val_quality": 0.6188016866897182,
      "test_quality": 0.6139830766300466,
      "patience_counter": 0,
      "elbo_raw": -30131.011096605533,
      "elbo_relative": 3362037.4242504765,
      "e_log_p_nodes": -13577.410204707632,
      "e_log_p_bonds": -1000.1423857621381,
      "e_log_p_tau": -1.0686703715503965,
      "h_nodes": -13813.177917589524,
      "h_bonds": 252.93216646893092,
      "h_tau": -1.8040406814043308,
      "tau_mean": 1.0686703715503965,
      "bond_mean_avg": 8.867336721552018,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.543524413260179,
      "train_quality": 0.33276169319707627,
      "val_loss": 3.501825061434909,
      "val_quality": 0.05301979586905281,
      "test_quality": 0.17502507384309163,
      "patience_counter": 1,
      "elbo_raw": -14680.985029253246,
      "elbo_relative": 3377487.450317829,
      "e_log_p_nodes": -13353.667001765125,
      "e_log_p_bonds": -1773.8330438345265,
      "e_log_p_tau": -0.363266494365729,
      "h_nodes": 2973.6818637015695,
      "h_bonds": 241.87122594702018,
      "h_tau": -2.883074483556811,
      "tau_mean": 0.363266494365729,
      "bond_mean_avg": 12.185824709030857,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.500462535740084,
      "train_quality": -0.967583207181135,
      "val_loss": 9.083033323730207,
      "val_quality": -1.4562771126864043,
      "test_quality": -1.1493392155805129,
      "patience_counter": 2,
      "elbo_raw": 4.845960161197581,
      "elbo_relative": 3392173.2813072433,
      "e_log_p_nodes": -13345.788906371332,
      "e_log_p_bonds": -2342.2402647928807,
      "e_log_p_tau": -0.12082103816385789,
      "h_nodes": 19045.149513983757,
      "h_bonds": 208.25776643740903,
      "h_tau": -3.9839007654054512,
      "tau_mean": 0.12082103816385789,
      "bond_mean_avg": 13.508670630683431,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 6.595600235981225,
      "train_quality": -0.7302122640782027,
      "val_loss": 7.974427592634856,
      "val_quality": -1.1564826731825542,
      "test_quality": -0.8743631857207808,
      "patience_counter": 3,
      "elbo_raw": 14714.384790745695,
      "elbo_relative": 3406882.8201378277,
      "e_log_p_nodes": -13383.527309221574,
      "e_log_p_bonds": -2785.4510072686835,
      "e_log_p_tau": -0.11084509081179583,
      "h_nodes": 34338.286339907674,
      "h_bonds": 167.57009320304064,
      "h_tau": -4.070077544413834,
      "tau_mean": 0.11084509081179583,
      "bond_mean_avg": 13.88281073706292,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.051290655615494,
      "train_quality": -0.3250962352282918,
      "val_loss": 6.329547446114204,
      "val_quality": -0.7116663532362921,
      "test_quality": -0.4973240424561942,
      "patience_counter": 4,
      "elbo_raw": 29105.304754239478,
      "elbo_relative": 3421273.7401013216,
      "e_log_p_nodes": -13427.889017144867,
      "e_log_p_bonds": -3188.6511516204846,
      "e_log_p_tau": -0.13011683267775964,
      "h_nodes": 49103.6243348449,
      "h_bonds": 125.45876629042739,
      "h_tau": -3.9097784329669594,
      "tau_mean": 0.13011683267775964,
      "bond_mean_avg": 13.993167720332758,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.650618717173353,
      "train_quality": -0.21998866700687647,
      "val_loss": 5.77925639836573,
      "val_quality": -0.5628540283525496,
      "test_quality": -0.36343093008362204,
      "patience_counter": 5,
      "elbo_raw": 43290.30343444654,
      "elbo_relative": 3435458.7387815285,
      "e_log_p_nodes": -13472.557856173122,
      "e_log_p_bonds": -3576.4910084162607,
      "e_log_p_tau": -0.14512056131992235,
      "h_nodes": 63685.05382992052,
      "h_bonds": 83.07082569821304,
      "h_tau": -3.8006463383972005,
      "tau_mean": 0.14512056131992235,
      "bond_mean_avg": 14.015628164387815,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.019748924777726,
      "train_quality": -0.31682194819251297,
      "val_loss": 6.208263141143658,
      "val_quality": -0.678868074092152,
      "test_quality": -0.47841106770529174,
      "patience_counter": 6,
      "elbo_raw": 57387.728766348955,
      "elbo_relative": 3449556.1641134312,
      "e_log_p_nodes": -13516.5991409114,
      "e_log_p_bonds": -3958.7309987221915,
      "e_log_p_tau": -0.1425524369433299,
      "h_nodes": 78263.96038608646,
      "h_bonds": 40.70843357109743,
      "h_tau": -3.8185012821568307,
      "tau_mean": 0.1425524369433299,
      "bond_mean_avg": 14.012845245056274,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.92835388797914,
      "train_quality": -0.2928464481793185,
      "val_loss": 6.154557827832197,
      "val_quality": -0.6643448275934349,
      "test_quality": -0.44608545391795196,
      "patience_counter": 7,
      "elbo_raw": 71533.17146759518,
      "elbo_relative": 3463701.6068146774,
      "e_log_p_nodes": -13560.086777072165,
      "e_log_p_bonds": -4338.649620571264,
      "e_log_p_tau": -0.143385595080067,
      "h_nodes": 92870.88693252068,
      "h_bonds": -1.5586969872040584,
      "h_tau": -3.8126737223274176,
      "tau_mean": 0.143385595080067,
      "bond_mean_avg": 14.004196534289687,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.296662611183588,
      "train_quality": -0.3894642308003593,
      "val_loss": 6.636599265280265,
      "val_quality": -0.7947007679461771,
      "test_quality": -0.5280024687776141,
      "patience_counter": 8,
      "elbo_raw": 85617.40987491657,
      "elbo_relative": 3477785.8452219986,
      "e_log_p_nodes": -13603.188647841205,
      "e_log_p_bonds": -4717.4072574505335,
      "e_log_p_tau": -0.1365534417132225,
      "h_nodes": 107454.28348388268,
      "h_bonds": -43.75480102399246,
      "h_tau": -3.8614951403415034,
      "tau_mean": 0.1365534417132225,
      "bond_mean_avg": 13.994113154562646,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.012854870948332,
      "train_quality": -0.315013443119728,
      "val_loss": 6.197549455850464,
      "val_quality": -0.6759708283108945,
      "test_quality": -0.46280036124413737,
      "patience_counter": 9,
      "elbo_raw": 99766.13110979473,
      "elbo_relative": 3491934.5664568767,
      "e_log_p_nodes": -13646.014632860746,
      "e_log_p_bonds": -5095.654911029145,
      "e_log_p_tau": -0.1399473742073056,
      "h_nodes": 122048.56207140259,
      "h_bonds": -85.89026273424975,
      "h_tau": -3.8369447393051814,
      "tau_mean": 0.1399473742073056,
      "bond_mean_avg": 13.985186565005785,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.407751303126125,
      "train_quality": -0.4186059328930407,
      "val_loss": 6.639884850326282,
      "val_quality": -0.7955892714958923,
      "test_quality": -0.5658431955524832,
      "patience_counter": 10,
      "elbo_raw": 113835.00956396539,
      "elbo_relative": 3506003.4449110474,
      "e_log_p_nodes": -13688.647816304152,
      "e_log_p_bonds": -5473.58522137344,
      "e_log_p_tau": -0.13367822903194979,
      "h_nodes": 136613.04821252116,
      "h_bonds": -127.98213093677037,
      "h_tau": -3.8827755563443134,
      "tau_mean": 0.13367822903194979,
      "bond_mean_avg": 13.977416227219635,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.620170651417184,
      "train_quality": -0.2120012792174546,
      "val_loss": 5.670316508538213,
      "val_quality": -0.5333939847190188,
      "test_quality": -0.37613562888335017,
      "patience_counter": 11,
      "elbo_raw": 128026.25903362436,
      "elbo_relative": 3520194.6943807066,
      "e_log_p_nodes": -13731.13466350165,
      "e_log_p_bonds": -5851.43369885405,
      "e_log_p_tau": -0.14711504159951602,
      "h_nodes": 151197.83303410688,
      "h_bonds": -170.04759074600534,
      "h_tau": -3.7869963161028863,
      "tau_mean": 0.14711504159951602,
      "bond_mean_avg": 13.97106238319235,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.984926083072378,
      "train_quality": -0.30768693308653994,
      "val_loss": 6.029187511404922,
      "val_quality": -0.6304415897790325,
      "test_quality": -0.4741051422924061,
      "patience_counter": 12,
      "elbo_raw": 142093.0665134745,
      "elbo_relative": 3534261.5018605567,
      "e_log_p_nodes": -13773.521553090875,
      "e_log_p_bonds": -6229.250341599305,
      "e_log_p_tau": -0.14387304902084677,
      "h_nodes": 165742.91907679217,
      "h_bonds": -212.1007038876606,
      "h_tau": -3.809279886015247,
      "tau_mean": 0.14387304902084677,
      "bond_mean_avg": 13.96560967934569,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.652457033967866,
      "train_quality": -0.22047090943354375,
      "val_loss": 5.885109485504675,
      "val_quality": -0.591479324107802,
      "test_quality": -0.3982087470439013,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.826489538355,
      "e_log_p_bonds": -6607.123390830314,
      "e_log_p_tau": -0.14986037726778942,
      "h_nodes": 0.0,
      "h_bonds": -254.15859254742776,
      "h_tau": -3.7685071503265135,
      "tau_mean": 0.14986037726778942,
      "bond_mean_avg": 13.960621065272957,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}