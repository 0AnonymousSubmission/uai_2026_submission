{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed9536-fold2",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 2,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 2,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4285.142564722155,
      "train_quality": -1129.1072599840077,
      "val_loss": 4855.837263353229,
      "val_quality": -1300.7870824920917,
      "patience_counter": 0,
      "elbo_raw": -3256703.8881372237,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145672.90423734512,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.3350153489911218,
      "train_quality": 0.6479205731670274,
      "val_loss": 1.9495061370769018,
      "val_quality": 0.47736265264926836,
      "test_quality": 0.5094349394491158,
      "patience_counter": 0,
      "elbo_raw": -36943.18324565589,
      "elbo_relative": 3219760.7048915676,
      "e_log_p_nodes": -20080.82928139653,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7358861721549338,
      "h_nodes": -14280.628521827926,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1771357433581215,
      "tau_mean": 0.7358861721549338,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.2037581748699817,
      "train_quality": 0.6825366175946889,
      "val_loss": 1.61470930441279,
      "val_quality": 0.5671173475420785,
      "test_quality": 0.5596025101329762,
      "patience_counter": 0,
      "elbo_raw": -36161.45124722597,
      "elbo_relative": 3220542.4368899977,
      "e_log_p_nodes": -19744.841618386243,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7608500970628236,
      "h_nodes": -13858.870718092223,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.143774835790282,
      "tau_mean": 0.7608500970628236,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 1.0805989407312122,
      "train_quality": 0.7150170176122128,
      "val_loss": 1.4526725433137089,
      "val_quality": 0.6105573046591704,
      "test_quality": 0.6028804677459527,
      "patience_counter": 0,
      "elbo_raw": -35990.221228789655,
      "elbo_relative": 3220713.666908434,
      "e_log_p_nodes": -19685.47108334946,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8187620191920156,
      "h_nodes": -13799.754986699987,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0704177259567587,
      "tau_mean": 0.8187620191920156,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 1.0133040160422115,
      "train_quality": 0.7327644978424411,
      "val_loss": 1.334863457077695,
      "val_quality": 0.6421403949368569,
      "test_quality": 0.6281295358600403,
      "patience_counter": 0,
      "elbo_raw": -35914.25720797579,
      "elbo_relative": 3220789.630929248,
      "e_log_p_nodes": -19668.703197021692,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8620595245778372,
      "h_nodes": -13777.60952857725,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.018886870413553,
      "tau_mean": 0.8620595245778372,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.9791261890982998,
      "train_quality": 0.7417781093562732,
      "val_loss": 1.2579178985870223,
      "val_quality": 0.6627685026484252,
      "test_quality": 0.6402551209616414,
      "patience_counter": 0,
      "elbo_raw": -35874.27006140592,
      "elbo_relative": 3220829.618075818,
      "e_log_p_nodes": -19662.425340376845,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8875262393516933,
      "h_nodes": -13764.833038939725,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9897731063483661,
      "tau_mean": 0.8875262393516933,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.955631159894,
      "train_quality": 0.7479743799998468,
      "val_loss": 1.202732675378909,
      "val_quality": 0.6775629462882344,
      "test_quality": 0.6481096827228909,
      "patience_counter": 0,
      "elbo_raw": -30188.135206407354,
      "elbo_relative": 3226515.7529308163,
      "e_log_p_nodes": -13574.281209881576,
      "e_log_p_bonds": -999.6766035008369,
      "e_log_p_tau": -0.9061216692344346,
      "h_nodes": -13755.636882668792,
      "h_bonds": 253.30515997655962,
      "h_tau": -1.9690376029484469,
      "tau_mean": 0.9061216692344346,
      "bond_mean_avg": 8.884540575829735,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.9134074150336486,
      "train_quality": 0.23165616515859178,
      "val_loss": 3.6750954089951593,
      "val_quality": 0.014754516906496318,
      "test_quality": 0.08240030787749553,
      "patience_counter": 1,
      "elbo_raw": -14721.699799696387,
      "elbo_relative": 3241982.188337527,
      "e_log_p_nodes": -13349.906360776571,
      "e_log_p_bonds": -1773.6441532126864,
      "e_log_p_tau": -0.31691954404545636,
      "h_nodes": 3026.547682933707,
      "h_bonds": 242.47667790578464,
      "h_tau": -3.019563255336834,
      "tau_mean": 0.31691954404545636,
      "bond_mean_avg": 12.216087088931351,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.269815592379098,
      "train_quality": -0.9172457521784356,
      "val_loss": 8.781163252553815,
      "val_quality": -1.3541161434094082,
      "test_quality": -1.1295149981426444,
      "patience_counter": 2,
      "elbo_raw": 13.190351221237506,
      "elbo_relative": 3256717.078488445,
      "e_log_p_nodes": -13344.83113123251,
      "e_log_p_bonds": -2338.537069402725,
      "e_log_p_tau": -0.12260798718690988,
      "h_nodes": 19038.015812260408,
      "h_bonds": 208.5187030431679,
      "h_tau": -3.9692190230043707,
      "tau_mean": 0.12260798718690988,
      "bond_mean_avg": 13.503928490326368,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 6.556456008060302,
      "train_quality": -0.7291136578451594,
      "val_loss": 8.142238806612824,
      "val_quality": -1.1828287741453,
      "test_quality": -1.0111482333988713,
      "patience_counter": 3,
      "elbo_raw": 14657.976931861995,
      "elbo_relative": 3271361.8650690857,
      "e_log_p_nodes": -13382.981052079318,
      "e_log_p_bonds": -2783.319324343159,
      "e_log_p_tau": -0.11176401455311956,
      "h_nodes": 34272.9902622758,
      "h_bonds": 167.8443815212467,
      "h_tau": -4.061821557225812,
      "tau_mean": 0.11176401455311956,
      "bond_mean_avg": 13.886190631980877,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.298292141581289,
      "train_quality": -0.3973020323783474,
      "val_loss": 6.491485027481756,
      "val_quality": -0.7402830648263949,
      "test_quality": -0.5924772000562217,
      "patience_counter": 4,
      "elbo_raw": 29010.86123103193,
      "elbo_relative": 3285714.7493682555,
      "e_log_p_nodes": -13427.42557799164,
      "e_log_p_bonds": -3186.886068673678,
      "e_log_p_tau": -0.12638172895977853,
      "h_nodes": 49027.656768628796,
      "h_bonds": 125.6960106930633,
      "h_tau": -3.9389042708316993,
      "tau_mean": 0.12638172895977853,
      "bond_mean_avg": 13.996355609627221,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.782372392350646,
      "train_quality": -0.26124012886674675,
      "val_loss": 6.168615071526758,
      "val_quality": -0.6537258111146504,
      "test_quality": -0.48797609601745373,
      "patience_counter": 5,
      "elbo_raw": 43211.35119355454,
      "elbo_relative": 3299915.2393307784,
      "e_log_p_nodes": -13472.165377853456,
      "e_log_p_bonds": -3574.8912229636107,
      "e_log_p_tau": -0.14113276069416608,
      "h_nodes": 63623.9330543154,
      "h_bonds": 83.28094192606913,
      "h_tau": -3.8285101801375276,
      "tau_mean": 0.14113276069416608,
      "bond_mean_avg": 14.01814586187734,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.871753944503125,
      "train_quality": -0.28481244634988867,
      "val_loss": 6.080675720114003,
      "val_quality": -0.6301504099009776,
      "test_quality": -0.48130841450166906,
      "patience_counter": 6,
      "elbo_raw": 57352.741583211326,
      "elbo_relative": 3314056.629720435,
      "e_log_p_nodes": -13516.263301073848,
      "e_log_p_bonds": -3957.2761526230543,
      "e_log_p_tau": -0.14441295422031367,
      "h_nodes": 78217.67371452312,
      "h_bonds": 40.89384423289496,
      "h_tau": -3.8055342596253467,
      "tau_mean": 0.14441295422031367,
      "bond_mean_avg": 14.014759917484287,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.930462557926358,
      "train_quality": -0.300295485537289,
      "val_loss": 6.179390439534924,
      "val_quality": -0.6566145477261494,
      "test_quality": -0.5086483566219628,
      "patience_counter": 7,
      "elbo_raw": 71464.22439275551,
      "elbo_relative": 3328168.112529979,
      "e_log_p_nodes": -13559.796986239371,
      "e_log_p_bonds": -4337.2643773724,
      "e_log_p_tau": -0.14408727258809698,
      "h_nodes": 92796.58207456546,
      "h_bonds": -1.3860786319952467,
      "h_tau": -3.807792017092652,
      "tau_mean": 0.14408727258809698,
      "bond_mean_avg": 14.005715478152922,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.76407809684848,
      "train_quality": -0.2564154314731302,
      "val_loss": 5.984877845566356,
      "val_quality": -0.6044682404103534,
      "test_quality": -0.4581787173277265,
      "patience_counter": 8,
      "elbo_raw": 85607.27516351345,
      "elbo_relative": 3342311.1633007373,
      "e_log_p_nodes": -13602.931017857165,
      "e_log_p_bonds": -4716.088806467554,
      "e_log_p_tau": -0.1476337761911793,
      "h_nodes": 107386.31521260548,
      "h_bonds": -43.59304098183715,
      "h_tau": -3.7834764707567956,
      "tau_mean": 0.1476337761911793,
      "bond_mean_avg": 13.995344670204219,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 4.782745357764222,
      "train_quality": -0.26133848986996644,
      "val_loss": 5.990595130806676,
      "val_quality": -0.6060009705388816,
      "test_quality": -0.4689519644563571,
      "patience_counter": 9,
      "elbo_raw": 99726.94851894546,
      "elbo_relative": 3356430.836656169,
      "e_log_p_nodes": -13645.78509381154,
      "e_log_p_bonds": -5094.392201502451,
      "e_log_p_tau": -0.1482572600244262,
      "h_nodes": 121966.26278947003,
      "h_bonds": -85.7398846175549,
      "h_tau": -3.7792621845519534,
      "tau_mean": 0.1482572600244262,
      "bond_mean_avg": 13.986075380933892,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.617699429634773,
      "train_quality": -0.2178114429181499,
      "val_loss": 5.909486137156586,
      "val_quality": -0.5842566997816063,
      "test_quality": -0.43052802934751155,
      "patience_counter": 10,
      "elbo_raw": 113871.01310283273,
      "elbo_relative": 3370574.9012400564,
      "e_log_p_nodes": -13688.446345648861,
      "e_log_p_bonds": -5472.494292761389,
      "e_log_p_tau": -0.15222323520946676,
      "h_nodes": 136554.22843081574,
      "h_bonds": -127.85822170049272,
      "h_tau": -3.7528630966035053,
      "tau_mean": 0.15222323520946676,
      "bond_mean_avg": 13.977880567251052,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.366119586302094,
      "train_quality": -0.1514630768785865,
      "val_loss": 5.5238785074589245,
      "val_quality": -0.4808802882533161,
      "test_quality": -0.37527719418982053,
      "patience_counter": 11,
      "elbo_raw": 128020.46084888348,
      "elbo_relative": 3384724.348986107,
      "e_log_p_nodes": -13730.9685946934,
      "e_log_p_bonds": -5850.545950674984,
      "e_log_p_tau": -0.159663459762765,
      "h_nodes": 151132.0291283333,
      "h_bonds": -169.94853614129192,
      "h_tau": -3.7051429691800877,
      "tau_mean": 0.159663459762765,
      "bond_mean_avg": 13.97135460877648,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.268877053344711,
      "train_quality": -0.12581760748881865,
      "val_loss": 5.689945203414114,
      "val_quality": -0.5254006187137565,
      "test_quality": -0.3373858618207366,
      "patience_counter": 12,
      "elbo_raw": 142164.77023995196,
      "elbo_relative": 3398868.6583771757,
      "e_log_p_nodes": -13773.391931076718,
      "e_log_p_bonds": -6228.667693977089,
      "e_log_p_tau": -0.16467374600232013,
      "h_nodes": 165716.75867615128,
      "h_bonds": -212.03944772476126,
      "h_tau": -3.6742449732155364,
      "tau_mean": 0.16467374600232013,
      "bond_mean_avg": 13.96566780114444,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.122792275575433,
      "train_quality": -0.08729112547878182,
      "val_loss": 5.291564025521429,
      "val_quality": -0.41859978434424705,
      "test_quality": -0.3229833604687009,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.740188117981,
      "e_log_p_bonds": -6606.883787976737,
      "e_log_p_tau": -0.17028098080210308,
      "h_nodes": 0.0,
      "h_bonds": -254.13465456164886,
      "h_tau": -3.6407612918474115,
      "tau_mean": 0.17028098080210308,
      "bond_mean_avg": 13.960673495140497,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}