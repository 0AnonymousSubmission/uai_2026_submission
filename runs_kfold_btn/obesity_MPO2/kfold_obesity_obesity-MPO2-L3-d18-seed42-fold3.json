{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed42-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 3,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 3970.585713913247,
      "train_quality": -1056.360465357016,
      "val_loss": 3158.698872787568,
      "val_quality": -872.8909421091591,
      "patience_counter": 0,
      "elbo_raw": -3031126.9184169997,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145697.51316341065,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.191803898030723,
      "train_quality": 0.6826245760618268,
      "val_loss": 1.7420818863397984,
      "val_quality": 0.5180326956772328,
      "test_quality": 0.4909504720837894,
      "patience_counter": 0,
      "elbo_raw": -37005.39438782047,
      "elbo_relative": 2994121.5240291795,
      "e_log_p_nodes": -20178.972344973205,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.82450796579857,
      "h_nodes": -14326.455071901619,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0634243894055544,
      "tau_mean": 0.82450796579857,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0309876882956273,
      "train_quality": 0.7254496690365524,
      "val_loss": 1.5238599400798079,
      "val_quality": 0.5784063463119771,
      "test_quality": 0.550237627619637,
      "patience_counter": 0,
      "elbo_raw": -36160.69494914978,
      "elbo_relative": 2994966.22346785,
      "e_log_p_nodes": -19802.7619093986,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8851085934214206,
      "h_nodes": -13908.959943088748,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9925008508162136,
      "tau_mean": 0.8851085934214206,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.8853460516550545,
      "train_quality": 0.7642337980767644,
      "val_loss": 1.430327557009048,
      "val_quality": 0.6042831727051456,
      "test_quality": 0.5772523632903594,
      "patience_counter": 0,
      "elbo_raw": -35971.25876324551,
      "elbo_relative": 2995155.6596537544,
      "e_log_p_nodes": -19740.55609567721,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9929495023009107,
      "h_nodes": -13864.392803922843,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.877531383650421,
      "tau_mean": 0.9929495023009107,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.7921824420460198,
      "train_quality": 0.7890431145625841,
      "val_loss": 1.3400856930490104,
      "val_quality": 0.6292496385474968,
      "test_quality": 0.5947969211073529,
      "patience_counter": 0,
      "elbo_raw": -35884.92108518211,
      "elbo_relative": 2995241.9973318176,
      "e_log_p_nodes": -19726.852134202134,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0943838593866715,
      "h_nodes": -13861.693825332131,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.7802643943359726,
      "tau_mean": 1.0943838593866715,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.7351503042731727,
      "train_quality": 0.8042306793403686,
      "val_loss": 1.278932289184689,
      "val_quality": 0.6461684421018892,
      "test_quality": 0.6059026188823134,
      "patience_counter": 0,
      "elbo_raw": -35838.94633278801,
      "elbo_relative": 2995287.9720842117,
      "e_log_p_nodes": -19723.962918774185,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.1737328813002617,
      "h_nodes": -13868.936701235552,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.7102667469334847,
      "tau_mean": 1.1737328813002617,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.6976544129214464,
      "train_quality": 0.8142157737282602,
      "val_loss": 1.2356421982251715,
      "val_quality": 0.6581451514674193,
      "test_quality": 0.6140030033436799,
      "patience_counter": 0,
      "elbo_raw": -30091.522922723794,
      "elbo_relative": 3001035.3954942757,
      "e_log_p_nodes": -13579.346450534294,
      "e_log_p_bonds": -998.5672600624183,
      "e_log_p_tau": -1.23410504292655,
      "h_nodes": -13876.581786531387,
      "h_bonds": 252.6989990088593,
      "h_tau": -1.6601098679575443,
      "tau_mean": 1.23410504292655,
      "bond_mean_avg": 8.848739506671835,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.094602525063668,
      "train_quality": 0.44221078193107843,
      "val_loss": 2.7462426593664198,
      "val_quality": 0.24021988752091938,
      "test_quality": 0.19587696764306273,
      "patience_counter": 1,
      "elbo_raw": -14615.84985073813,
      "elbo_relative": 3016511.068566262,
      "e_log_p_nodes": -13352.124011490112,
      "e_log_p_bonds": -1775.8563828794513,
      "e_log_p_tau": -0.44054177129083977,
      "h_nodes": 2900.5822913778743,
      "h_bonds": 241.91372066891276,
      "h_tau": -2.690205924853217,
      "tau_mean": 0.44054177129083977,
      "bond_mean_avg": 12.19891285038656,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.1945034736632945,
      "train_quality": -0.9158844787732741,
      "val_loss": 8.305318424343644,
      "val_quality": -1.2977633622799423,
      "test_quality": -1.1245331221417594,
      "patience_counter": 2,
      "elbo_raw": 27.5982874190413,
      "elbo_relative": 3031154.5167044187,
      "e_log_p_nodes": -13345.996740546865,
      "e_log_p_bonds": -2341.474679746884,
      "e_log_p_tau": -0.12807483734784864,
      "h_nodes": 19026.02877457376,
      "h_bonds": 207.65259528507286,
      "h_tau": -3.9255964328795017,
      "tau_mean": 0.12807483734784864,
      "bond_mean_avg": 13.476463125260063,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.666285286194051,
      "train_quality": -1.0415192019065667,
      "val_loss": 8.809737967882556,
      "val_quality": -1.4373169214745474,
      "test_quality": -1.2570211180326027,
      "patience_counter": 3,
      "elbo_raw": 14855.82961633566,
      "elbo_relative": 3045982.7480333354,
      "e_log_p_nodes": -13385.126302153461,
      "e_log_p_bonds": -2784.6882783461756,
      "e_log_p_tau": -0.1013691561911568,
      "h_nodes": 34546.02019734685,
      "h_bonds": 166.37075264621114,
      "h_tau": -4.15944232741731,
      "tau_mean": 0.1013691561911568,
      "bond_mean_avg": 13.82248990514183,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.287627952340299,
      "train_quality": -0.40808665399924426,
      "val_loss": 6.138097928758174,
      "val_quality": -0.6981764953703793,
      "test_quality": -0.6158115980823484,
      "patience_counter": 4,
      "elbo_raw": 29490.028483367852,
      "elbo_relative": 3060616.9469003677,
      "e_log_p_nodes": -13430.303092285163,
      "e_log_p_bonds": -3189.9838124351163,
      "e_log_p_tau": -0.12417326328505955,
      "h_nodes": 49527.37570559711,
      "h_bonds": 123.79456179548535,
      "h_tau": -3.956533317859794,
      "tau_mean": 0.12417326328505955,
      "bond_mean_avg": 13.921772831556316,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.814919964545712,
      "train_quality": -0.2822052919117708,
      "val_loss": 5.670641449550192,
      "val_quality": -0.568849199714119,
      "test_quality": -0.5138409303831135,
      "patience_counter": 5,
      "elbo_raw": 43860.89450026599,
      "elbo_relative": 3074987.8129172656,
      "e_log_p_nodes": -13475.48885573032,
      "e_log_p_bonds": -3581.2428578793315,
      "e_log_p_tau": -0.14174167920802191,
      "h_nodes": 64282.351293842126,
      "h_bonds": 80.98599636305903,
      "h_tau": -3.8242049523150854,
      "tau_mean": 0.14174167920802191,
      "bond_mean_avg": 13.94218084701908,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.760715529852774,
      "train_quality": -0.2677707398278031,
      "val_loss": 5.62195896347643,
      "val_quality": -0.5553806212479258,
      "test_quality": -0.5092517094646647,
      "patience_counter": 6,
      "elbo_raw": 58170.91820044121,
      "elbo_relative": 3089297.836617441,
      "e_log_p_nodes": -13519.97227416871,
      "e_log_p_bonds": -3967.089315494418,
      "e_log_p_tau": -0.14879798457611054,
      "h_nodes": 79030.53684904339,
      "h_bonds": 38.22274362341206,
      "h_tau": -3.775621614935517,
      "tau_mean": 0.14879798457611054,
      "bond_mean_avg": 13.939344878463407,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.727368156274795,
      "train_quality": -0.258890388921061,
      "val_loss": 5.626980740089425,
      "val_quality": -0.5567699544107665,
      "test_quality": -0.5339040933750774,
      "patience_counter": 7,
      "elbo_raw": 72485.85482625962,
      "elbo_relative": 3103612.773243259,
      "e_log_p_nodes": -13563.876438585385,
      "e_log_p_bonds": -4350.661673643553,
      "e_log_p_tau": -0.15166319866211422,
      "h_nodes": 93801.91974210397,
      "h_bonds": -4.460775887646037,
      "h_tau": -3.7565489286707816,
      "tau_mean": 0.15166319866211422,
      "bond_mean_avg": 13.930244388059325,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.781342332893226,
      "train_quality": -0.2732636236573236,
      "val_loss": 5.636817503990328,
      "val_quality": -0.5594914100540136,
      "test_quality": -0.5200519939556003,
      "patience_counter": 8,
      "elbo_raw": 86796.36407364551,
      "elbo_relative": 3117923.282490645,
      "e_log_p_nodes": -13607.387418184862,
      "e_log_p_bonds": -4733.224361004417,
      "e_log_p_tau": -0.15110814805579367,
      "h_nodes": 108583.76349471182,
      "h_bonds": -47.0851351779575,
      "h_tau": -3.7602153999805523,
      "tau_mean": 0.15110814805579367,
      "bond_mean_avg": 13.919986789815107,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.0322081315700276,
      "train_quality": -0.34006877451997486,
      "val_loss": 5.953265685926047,
      "val_quality": -0.6470404962372389,
      "test_quality": -0.6128221532320917,
      "patience_counter": 9,
      "elbo_raw": 101094.63684938452,
      "elbo_relative": 3132221.555266384,
      "e_log_p_nodes": -13650.632011303502,
      "e_log_p_bonds": -5115.451245575438,
      "e_log_p_tau": -0.14538370223489075,
      "h_nodes": 123377.86213028742,
      "h_bonds": -89.67250444709013,
      "h_tau": -3.7988347230793806,
      "tau_mean": 0.14538370223489075,
      "bond_mean_avg": 13.91071523624765,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.907978508528449,
      "train_quality": -0.30698662959357503,
      "val_loss": 5.7512463523345865,
      "val_quality": -0.5911494876712005,
      "test_quality": -0.530688057579098,
      "patience_counter": 10,
      "elbo_raw": 115415.4195400267,
      "elbo_relative": 3146542.3379570264,
      "e_log_p_nodes": -13693.695075296093,
      "e_log_p_bonds": -5497.512441157835,
      "e_log_p_tau": -0.14655771780942484,
      "h_nodes": 138160.53662860554,
      "h_bonds": -132.2223873996785,
      "h_tau": -3.790791863638333,
      "tau_mean": 0.14655771780942484,
      "bond_mean_avg": 13.903112124748485,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.803462097346104,
      "train_quality": -0.27915408066308167,
      "val_loss": 5.691831565941813,
      "val_quality": -0.5747116929503084,
      "test_quality": -0.5553019680834217,
      "patience_counter": 11,
      "elbo_raw": 129751.16675429665,
      "elbo_relative": 3160878.0851712963,
      "e_log_p_nodes": -13736.62172473233,
      "e_log_p_bonds": -5879.564791282266,
      "e_log_p_tau": -0.14923713148621834,
      "h_nodes": 152950.7690834,
      "h_bonds": -174.75480220240198,
      "h_tau": -3.7726746653697774,
      "tau_mean": 0.14923713148621834,
      "bond_mean_avg": 13.896893464052633,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.438741656901536,
      "train_quality": -0.18202962537620326,
      "val_loss": 5.225348664734536,
      "val_quality": -0.4456537490209831,
      "test_quality": -0.4075979461658792,
      "patience_counter": 12,
      "elbo_raw": 144089.21929485782,
      "elbo_relative": 3175216.1377118574,
      "e_log_p_nodes": -13779.451014439928,
      "e_log_p_bonds": -6261.614614063156,
      "e_log_p_tau": -0.1589876963836054,
      "h_nodes": 167710.70660208003,
      "h_bonds": -217.26658507654744,
      "h_tau": -3.7093843747370556,
      "tau_mean": 0.1589876963836054,
      "bond_mean_avg": 13.892109389353308,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.108619759563867,
      "train_quality": -0.09411870539017397,
      "val_loss": 4.928740883160086,
      "val_quality": -0.36359374136718103,
      "test_quality": -0.35233096457066715,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13822.18364222823,
      "e_log_p_bonds": -6643.564316740468,
      "e_log_p_tau": -0.17108606069043295,
      "h_nodes": 0.0,
      "h_bonds": -259.7960853437554,
      "h_tau": -3.6360444839356205,
      "tau_mean": 0.17108606069043295,
      "bond_mean_avg": 13.886380846166949,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}