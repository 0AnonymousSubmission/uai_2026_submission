{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed47659-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 3,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 7006.553910410403,
      "train_quality": -1843.466880571885,
      "val_loss": 9060.39140565074,
      "val_quality": -2496.9178948551003,
      "patience_counter": 0,
      "elbo_raw": -5210773.528123638,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145612.13447672906,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.2287330355134853,
      "train_quality": 0.6765375078750473,
      "val_loss": 1.8003417324680646,
      "val_quality": 0.5036521460229986,
      "test_quality": 0.528278694518977,
      "patience_counter": 0,
      "elbo_raw": -36932.11865854011,
      "elbo_relative": 5173841.409465098,
      "e_log_p_nodes": -20152.47002307124,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7980790362179868,
      "h_nodes": -14256.257056546734,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.096003557302538,
      "tau_mean": 0.7980790362179868,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0173576649255196,
      "train_quality": 0.7321818196727246,
      "val_loss": 1.5585978435141448,
      "val_quality": 0.5703000819844903,
      "test_quality": 0.5656101827275619,
      "patience_counter": 0,
      "elbo_raw": -36145.69093667989,
      "elbo_relative": 5174627.837186958,
      "e_log_p_nodes": -19820.08535509845,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8929922347476595,
      "h_nodes": -13883.008387374346,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9836333075800212,
      "tau_mean": 0.8929922347476595,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.8896128475286819,
      "train_quality": 0.7658104890394274,
      "val_loss": 1.4201475783572723,
      "val_quality": 0.6084703308621597,
      "test_quality": 0.5834241227261506,
      "patience_counter": 0,
      "elbo_raw": -35976.158837895215,
      "elbo_relative": 5174797.369285743,
      "e_log_p_nodes": -19757.600858697548,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9899974056696497,
      "h_nodes": -13850.107043163678,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8805088701383283,
      "tau_mean": 0.9899974056696497,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8259884682434977,
      "train_quality": 0.7825595302783882,
      "val_loss": 1.3553886567979452,
      "val_quality": 0.6263241367047718,
      "test_quality": 0.593411739861953,
      "patience_counter": 0,
      "elbo_raw": -35903.89564077378,
      "elbo_relative": 5174869.632482864,
      "e_log_p_nodes": -19738.523475833445,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0552457573440768,
      "h_nodes": -13842.812527280983,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8166822285957096,
      "tau_mean": 1.0552457573440768,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.7904818334350016,
      "train_quality": 0.7919066091394422,
      "val_loss": 1.3176353764771287,
      "val_quality": 0.6367325826847141,
      "test_quality": 0.5999055270204999,
      "patience_counter": 0,
      "elbo_raw": -35864.00517065532,
      "elbo_relative": 5174909.522952982,
      "e_log_p_nodes": -19730.116927711046,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0975711835031354,
      "h_nodes": -13839.604137378017,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.777356190197679,
      "tau_mean": 1.0975711835031354,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.766725671459887,
      "train_quality": 0.798160390175437,
      "val_loss": 1.2879978609418572,
      "val_quality": 0.644903540991044,
      "test_quality": 0.6051676811852054,
      "patience_counter": 0,
      "elbo_raw": -30116.64387796497,
      "elbo_relative": 5180656.884245672,
      "e_log_p_nodes": -13578.360246865564,
      "e_log_p_bonds": -999.2009971378022,
      "e_log_p_tau": -1.1283556153024417,
      "h_nodes": -13837.648233881184,
      "h_bonds": 252.70352387759232,
      "h_tau": -1.7496945485618198,
      "tau_mean": 1.1283556153024417,
      "bond_mean_avg": 8.852370214819825,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.5777514685410003,
      "train_quality": 0.3214100296859175,
      "val_loss": 3.2635810991752066,
      "val_quality": 0.10024222310568942,
      "test_quality": 0.1445849749147503,
      "patience_counter": 1,
      "elbo_raw": -14664.151235060897,
      "elbo_relative": 5196109.376888577,
      "e_log_p_nodes": -13351.252021252109,
      "e_log_p_bonds": -1776.6728870713323,
      "e_log_p_tau": -0.3610369857162236,
      "h_nodes": 2995.082156399742,
      "h_bonds": 242.15609558865947,
      "h_tau": -2.8892307861351583,
      "tau_mean": 0.3610369857162236,
      "bond_mean_avg": 12.215685558684998,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 8.236858976679162,
      "train_quality": -1.168343207900337,
      "val_loss": 9.004591341467203,
      "val_quality": -1.4825340143340902,
      "test_quality": -1.2039714352172313,
      "patience_counter": 2,
      "elbo_raw": 23.849559693204355,
      "elbo_relative": 5210797.377683331,
      "e_log_p_nodes": -13345.639483387888,
      "e_log_p_bonds": -2340.0967501723944,
      "e_log_p_tau": -0.11124991991814398,
      "h_nodes": 19121.738050208638,
      "h_bonds": 207.71974758546514,
      "h_tau": -4.066431991518584,
      "tau_mean": 0.11124991991814398,
      "bond_mean_avg": 13.473533548762912,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.491827137071043,
      "train_quality": -0.9722144731899767,
      "val_loss": 8.39629036560016,
      "val_quality": -1.3148275847720687,
      "test_quality": -1.0183639320999438,
      "patience_counter": 3,
      "elbo_raw": 14898.084034820422,
      "elbo_relative": 5225671.612158458,
      "e_log_p_nodes": -13384.959257438015,
      "e_log_p_bonds": -2783.7981630438685,
      "e_log_p_tau": -0.0998042374552388,
      "h_nodes": 34598.34168747331,
      "h_bonds": 166.4329776476796,
      "h_tau": -4.1750005508401955,
      "tau_mean": 0.0998042374552388,
      "bond_mean_avg": 13.821564925176185,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.269964436455624,
      "train_quality": -0.3873117925192302,
      "val_loss": 6.033054477912023,
      "val_quality": -0.6632918012364573,
      "test_quality": -0.4841115433994958,
      "patience_counter": 4,
      "elbo_raw": 29481.34045120237,
      "elbo_relative": 5240254.86857484,
      "e_log_p_nodes": -13430.137660335527,
      "e_log_p_bonds": -3189.6803533841153,
      "e_log_p_tau": -0.12378550744007108,
      "h_nodes": 49520.41497585662,
      "h_bonds": 123.84746763529799,
      "h_tau": -3.9596609036261725,
      "tau_mean": 0.12378550744007108,
      "bond_mean_avg": 13.92324710420632,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 5.035417406367719,
      "train_quality": -0.32556756925836905,
      "val_loss": 5.762322849881004,
      "val_quality": -0.5886520480421122,
      "test_quality": -0.4292705902743643,
      "patience_counter": 5,
      "elbo_raw": 43820.00082430943,
      "elbo_relative": 5254593.528947948,
      "e_log_p_nodes": -13475.356104142831,
      "e_log_p_bonds": -3581.0531017889234,
      "e_log_p_tau": -0.1371996294325172,
      "h_nodes": 64264.50904262098,
      "h_bonds": 81.02903258986268,
      "h_tau": -3.856774178369051,
      "tau_mean": 0.1371996294325172,
      "bond_mean_avg": 13.943650258453,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.314909010490613,
      "train_quality": -0.3991433975177694,
      "val_loss": 6.169471257948471,
      "val_quality": -0.7009014254519226,
      "test_quality": -0.5030903430448483,
      "patience_counter": 6,
      "elbo_raw": 58097.84143243414,
      "elbo_relative": 5268871.369556072,
      "e_log_p_nodes": -13519.86662008115,
      "e_log_p_bonds": -3966.9915664346317,
      "e_log_p_tau": -0.13621189955755908,
      "h_nodes": 79020.77547326335,
      "h_bonds": 38.24777040461102,
      "h_tau": -3.863999434564903,
      "tau_mean": 0.13621189955755908,
      "bond_mean_avg": 13.9403508740288,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 5.553275241158787,
      "train_quality": -0.46189302073282223,
      "val_loss": 6.322447863095291,
      "val_quality": -0.7430765349347319,
      "test_quality": -0.5636279033613498,
      "patience_counter": 7,
      "elbo_raw": 72373.47339981774,
      "elbo_relative": 5283147.001523456,
      "e_log_p_nodes": -13563.793907476225,
      "e_log_p_bonds": -4350.557325974179,
      "e_log_p_tau": -0.13152010863475327,
      "h_nodes": 93791.78577608397,
      "h_bonds": -4.435595979735751,
      "h_tau": -3.8990514354263723,
      "tau_mean": 0.13152010863475327,
      "bond_mean_avg": 13.931144038274192,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.379892151425077,
      "train_quality": -0.41625013112486653,
      "val_loss": 6.378611571172747,
      "val_quality": -0.7585606707923285,
      "test_quality": -0.530153181821392,
      "patience_counter": 8,
      "elbo_raw": 86718.15630255628,
      "elbo_relative": 5297491.684426194,
      "e_log_p_nodes": -13607.315554446639,
      "e_log_p_bonds": -4733.104576354901,
      "e_log_p_tau": -0.1333137674560721,
      "h_nodes": 108595.42500105345,
      "h_bonds": -47.06264082459036,
      "h_tau": -3.8855056891352433,
      "tau_mean": 0.1333137674560721,
      "bond_mean_avg": 13.920621382766504,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.202646890260237,
      "train_quality": -0.3695905295379698,
      "val_loss": 6.032265917369041,
      "val_quality": -0.6630743978812048,
      "test_quality": -0.4940827405752113,
      "patience_counter": 9,
      "elbo_raw": 101035.99754813325,
      "elbo_relative": 5311809.525671771,
      "e_log_p_nodes": -13650.562342555673,
      "e_log_p_bonds": -5115.182491841782,
      "e_log_p_tau": -0.1370898003002214,
      "h_nodes": 123361.0744567702,
      "h_bonds": -89.62803313071852,
      "h_tau": -3.8575750049867565,
      "tau_mean": 0.1370898003002214,
      "bond_mean_avg": 13.911555048591595,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.242933725797138,
      "train_quality": -0.380195990485106,
      "val_loss": 6.18301715218966,
      "val_quality": -0.7046359806286207,
      "test_quality": -0.4994793774116395,
      "patience_counter": 10,
      "elbo_raw": 115339.93620125478,
      "elbo_relative": 5326113.4643248925,
      "e_log_p_nodes": -13693.614494741241,
      "e_log_p_bonds": -5497.062114376982,
      "e_log_p_tau": -0.1375136265891974,
      "h_nodes": 138130.26085391708,
      "h_bonds": -132.16351992628165,
      "h_tau": -3.8544881780644573,
      "tau_mean": 0.1375136265891974,
      "bond_mean_avg": 13.903650019625768,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 5.1559471711397675,
      "train_quality": -0.3572968847089857,
      "val_loss": 6.1683255612678565,
      "val_quality": -0.7005855609254963,
      "test_quality": -0.49165753665552603,
      "patience_counter": 11,
      "elbo_raw": 129639.34810132334,
      "elbo_relative": 5340412.876224961,
      "e_log_p_nodes": -13736.525576900385,
      "e_log_p_bonds": -5878.8804671314,
      "e_log_p_tau": -0.13918626025242226,
      "h_nodes": 152888.2138713782,
      "h_bonds": -174.66771235044018,
      "h_tau": -3.8423981547821313,
      "tau_mean": 0.13918626025242226,
      "bond_mean_avg": 13.897507416814216,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 5.238644587829743,
      "train_quality": -0.3790668800795882,
      "val_loss": 6.258019181734846,
      "val_quality": -0.725313775148019,
      "test_quality": -0.5005002346274428,
      "patience_counter": 12,
      "elbo_raw": 143936.24450963028,
      "elbo_relative": 5354709.772633268,
      "e_log_p_nodes": -13779.332266605477,
      "e_log_p_bonds": -6260.709425208504,
      "e_log_p_tau": -0.13816521541371066,
      "h_nodes": 167657.53344938584,
      "h_bonds": -217.1617386007032,
      "h_tau": -3.8497610105159765,
      "tau_mean": 0.13816521541371066,
      "bond_mean_avg": 13.892388502801182,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.964930905190842,
      "train_quality": -0.3070120826938585,
      "val_loss": 5.93596759120297,
      "val_quality": -0.6365252896357487,
      "test_quality": -0.4525896066149997,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13822.063072756204,
      "e_log_p_bonds": -6642.48273931079,
      "e_log_p_tau": -0.1432757790766409,
      "h_nodes": 0.0,
      "h_bonds": -259.6636063924688,
      "h_tau": -3.813439894673138,
      "tau_mean": 0.1432757790766409,
      "bond_mean_avg": 13.887015195852445,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}