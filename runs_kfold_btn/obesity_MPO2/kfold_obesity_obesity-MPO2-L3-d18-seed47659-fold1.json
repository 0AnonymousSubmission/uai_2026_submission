{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed47659-fold1",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 1,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 1,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 6895.940004559781,
      "train_quality": -1838.8597652321127,
      "val_loss": 6039.925693310828,
      "val_quality": -1607.0324913616464,
      "patience_counter": 0,
      "elbo_raw": -5131335.120631831,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145612.13447672906,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.3155363738520625,
      "train_quality": 0.6490105130918591,
      "val_loss": 1.979800392485217,
      "val_quality": 0.4729101781744496,
      "test_quality": 0.5773283845802704,
      "patience_counter": 0,
      "elbo_raw": -36995.73373760852,
      "elbo_relative": 5094339.386894222,
      "e_log_p_nodes": -20147.317541738677,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7462342499214707,
      "h_nodes": -14276.730993182657,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.163171633876118,
      "tau_mean": 0.7462342499214707,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1021479977837552,
      "train_quality": 0.7059432426742941,
      "val_loss": 1.6622113254691455,
      "val_quality": 0.5574631287560541,
      "test_quality": 0.6127052543756975,
      "patience_counter": 0,
      "elbo_raw": -36162.05750717534,
      "elbo_relative": 5095173.063124656,
      "e_log_p_nodes": -19790.858132146488,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8246377654876399,
      "h_nodes": -13871.345537571879,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.063266974949329,
      "tau_mean": 0.8246377654876399,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9445131427574172,
      "train_quality": 0.7480007471144985,
      "val_loss": 1.5433577614193872,
      "val_quality": 0.5891059671634551,
      "test_quality": 0.6479207329678218,
      "patience_counter": 0,
      "elbo_raw": -35972.20378925648,
      "elbo_relative": 5095362.916842574,
      "e_log_p_nodes": -19726.649037782663,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.92922053334465,
      "h_nodes": -13831.550906717903,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9438650942011009,
      "tau_mean": 0.92922053334465,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8739789017407126,
      "train_quality": 0.7668195175840806,
      "val_loss": 1.4947896181917075,
      "val_quality": 0.6020364494774526,
      "test_quality": 0.6640777520693111,
      "patience_counter": 0,
      "elbo_raw": -35897.47952710961,
      "elbo_relative": 5095437.641104721,
      "e_log_p_nodes": -19707.877170846234,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9946994626494351,
      "h_nodes": -13824.558280094629,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8757705487832936,
      "tau_mean": 0.9946994626494351,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8449701000757504,
      "train_quality": 0.7745591625035073,
      "val_loss": 1.4777845301605563,
      "val_quality": 0.6065637790276888,
      "test_quality": 0.6715015512271223,
      "patience_counter": 0,
      "elbo_raw": -35860.62814741058,
      "elbo_relative": 5095474.492484421,
      "e_log_p_nodes": -19700.061282547675,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.025120949117671,
      "h_nodes": -13817.182766228878,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8456453089775096,
      "tau_mean": 1.025120949117671,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8313626823551751,
      "train_quality": 0.7781896668809001,
      "val_loss": 1.4659021395913778,
      "val_quality": 0.6097272732626342,
      "test_quality": 0.6763890589394576,
      "patience_counter": 0,
      "elbo_raw": -30142.629131385995,
      "elbo_relative": 5101192.491500445,
      "e_log_p_nodes": -13570.60656213897,
      "e_log_p_bonds": -1004.2912105742569,
      "e_log_p_tau": -1.0388156160779318,
      "h_nodes": -13807.639596927433,
      "h_bonds": 253.49324130065747,
      "h_tau": -1.832374680247085,
      "tau_mean": 1.0388156160779318,
      "bond_mean_avg": 8.916816393888922,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.690943281396371,
      "train_quality": 0.2820473683516459,
      "val_loss": 3.4239823779252156,
      "val_quality": 0.08842009105324367,
      "test_quality": 0.22609828316684188,
      "patience_counter": 1,
      "elbo_raw": -14710.41300414458,
      "elbo_relative": 5116624.707627686,
      "e_log_p_nodes": -13348.03700521143,
      "e_log_p_bonds": -1778.3738366387884,
      "e_log_p_tau": -0.3444130094111495,
      "h_nodes": 2980.4029826339074,
      "h_bonds": 242.95215371289436,
      "h_tau": -2.936369646755338,
      "tau_mean": 0.3444130094111495,
      "bond_mean_avg": 12.26359395733332,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.500298388067132,
      "train_quality": -1.0011045952133268,
      "val_loss": 8.343084774419857,
      "val_quality": -1.2212113321708324,
      "test_quality": -0.9945853694008304,
      "patience_counter": 2,
      "elbo_raw": -60.58855890970881,
      "elbo_relative": 5131274.532072921,
      "e_log_p_nodes": -13343.910458976396,
      "e_log_p_bonds": -2339.4049415826207,
      "e_log_p_tau": -0.1202812367825569,
      "h_nodes": 18977.800355455423,
      "h_bonds": 208.67795682636157,
      "h_tau": -3.9883785521315076,
      "tau_mean": 0.1202812367825569,
      "bond_mean_avg": 13.51657559195578,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 6.901941636350359,
      "train_quality": -0.8414610205867012,
      "val_loss": 7.9750201233587426,
      "val_quality": -1.123220074019521,
      "test_quality": -0.8711829387641221,
      "patience_counter": 3,
      "elbo_raw": 14606.251229299436,
      "elbo_relative": 5145941.37186113,
      "e_log_p_nodes": -13382.769307482167,
      "e_log_p_bonds": -2783.0596500171064,
      "e_log_p_tau": -0.10714382594011773,
      "h_nodes": 34251.11011473472,
      "h_bonds": 167.88163683127448,
      "h_tau": -4.104039093185747,
      "tau_mean": 0.10714382594011773,
      "bond_mean_avg": 13.887153846541818,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.256333803862547,
      "train_quality": -0.40240736896804385,
      "val_loss": 6.046103568355311,
      "val_quality": -0.6096772506357717,
      "test_quality": -0.39943397991144947,
      "patience_counter": 4,
      "elbo_raw": 28982.70639006481,
      "elbo_relative": 5160317.827021896,
      "e_log_p_nodes": -13427.314535292058,
      "e_log_p_bonds": -3186.7052085641403,
      "e_log_p_tau": -0.12533502279486192,
      "h_nodes": 49005.163392356946,
      "h_bonds": 125.72251739339339,
      "h_tau": -3.9472208583501924,
      "tau_mean": 0.12533502279486192,
      "bond_mean_avg": 13.997078363421986,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.971188677857423,
      "train_quality": -0.3263296994636731,
      "val_loss": 5.931323529693418,
      "val_quality": -0.5791189224542712,
      "test_quality": -0.361302696895873,
      "patience_counter": 5,
      "elbo_raw": 43162.99348668997,
      "elbo_relative": 5174498.114118521,
      "e_log_p_nodes": -13472.081226673949,
      "e_log_p_bonds": -3574.747392963766,
      "e_log_p_tau": -0.13718150639428883,
      "h_nodes": 63595.7392487998,
      "h_bonds": 83.30624944248929,
      "h_tau": -3.8569062795659192,
      "tau_mean": 0.13718150639428883,
      "bond_mean_avg": 14.018900497352263,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.304351727087221,
      "train_quality": -0.4152187108435048,
      "val_loss": 6.052377000438394,
      "val_quality": -0.6113474504253356,
      "test_quality": -0.418007387011714,
      "patience_counter": 6,
      "elbo_raw": 57264.44150270797,
      "elbo_relative": 5188599.562134539,
      "e_log_p_nodes": -13516.18655661146,
      "e_log_p_bonds": -3957.0835439662615,
      "e_log_p_tau": -0.13479788365517742,
      "h_nodes": 78178.60545551746,
      "h_bonds": 40.93251731626262,
      "h_tau": -3.8744346942603443,
      "tau_mean": 0.13479788365517742,
      "bond_mean_avg": 14.015811495804417,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 5.363634741079051,
      "train_quality": -0.4310356164623381,
      "val_loss": 6.276792979890431,
      "val_quality": -0.6710945739601966,
      "test_quality": -0.4560949172348079,
      "patience_counter": 7,
      "elbo_raw": 71371.44898431149,
      "elbo_relative": 5202706.569616143,
      "e_log_p_nodes": -13559.719579794733,
      "e_log_p_bonds": -4336.887395983669,
      "e_log_p_tau": -0.1329051513075351,
      "h_nodes": 92761.37958883165,
      "h_bonds": -1.3304084600640778,
      "h_tau": -3.8885754669809103,
      "tau_mean": 0.1329051513075351,
      "bond_mean_avg": 14.006551696313647,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.491144748159728,
      "train_quality": -0.4650557111176101,
      "val_loss": 6.274167646716395,
      "val_quality": -0.6703956214798417,
      "test_quality": -0.4955042716892999,
      "patience_counter": 8,
      "elbo_raw": 85483.74407840244,
      "elbo_relative": 5216818.864710233,
      "e_log_p_nodes": -13602.839931520159,
      "e_log_p_bonds": -4715.532276652722,
      "e_log_p_tau": -0.13022015023906341,
      "h_nodes": 107352.30075999201,
      "h_bonds": -43.516791156404025,
      "h_tau": -3.9089847111872587,
      "tau_mean": 0.13022015023906341,
      "bond_mean_avg": 13.996168569408633,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.391916891726899,
      "train_quality": -0.43858138846975137,
      "val_loss": 6.36920696313706,
      "val_quality": -0.6956983017645484,
      "test_quality": -0.4658535423914629,
      "patience_counter": 9,
      "elbo_raw": 99591.44317813484,
      "elbo_relative": 5230926.563809966,
      "e_log_p_nodes": -13645.677012214222,
      "e_log_p_bonds": -5093.552430030576,
      "e_log_p_tau": -0.13104595457662888,
      "h_nodes": 121918.42801551195,
      "h_bonds": -85.63321902077256,
      "h_tau": -3.902663132746966,
      "tau_mean": 0.13104595457662888,
      "bond_mean_avg": 13.986818650468786,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.30836028150201,
      "train_quality": -0.4162882065148181,
      "val_loss": 6.121816292471494,
      "val_quality": -0.6298345384188249,
      "test_quality": -0.4445413162216789,
      "patience_counter": 10,
      "elbo_raw": 113720.64890553651,
      "elbo_relative": 5245055.769537367,
      "e_log_p_nodes": -13688.306473276105,
      "e_log_p_bonds": -5471.3171392845325,
      "e_log_p_tau": -0.13276399605564235,
      "h_nodes": 136500.74056466,
      "h_bonds": -127.71033590726708,
      "h_tau": -3.88963810648238,
      "tau_mean": 0.13276399605564235,
      "bond_mean_avg": 13.97877196180129,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 5.17647859376303,
      "train_quality": -0.3811017328968038,
      "val_loss": 6.098843029622452,
      "val_quality": -0.6237182788868965,
      "test_quality": -0.4165072514154107,
      "patience_counter": 11,
      "elbo_raw": 127821.33055747024,
      "elbo_relative": 5259156.451189301,
      "e_log_p_nodes": -13730.793794280951,
      "e_log_p_bonds": -5848.947962031972,
      "e_log_p_tau": -0.13577449862891053,
      "h_nodes": 151047.46784731507,
      "h_bonds": -169.75985457634619,
      "h_tau": -3.867215781475352,
      "tau_mean": 0.13577449862891053,
      "bond_mean_avg": 13.97195050660846,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.853809406018594,
      "train_quality": -0.29501251871881373,
      "val_loss": 5.639527451346961,
      "val_quality": -0.5014329377818658,
      "test_quality": -0.31373409408169484,
      "patience_counter": 12,
      "elbo_raw": 141966.77762530098,
      "elbo_relative": 5273301.898257132,
      "e_log_p_nodes": -13773.16912185968,
      "e_log_p_bonds": -6226.60701792265,
      "e_log_p_tau": -0.14295068051067594,
      "h_nodes": 165617.949600554,
      "h_bonds": -211.79164125188424,
      "h_tau": -3.815711513489987,
      "tau_mean": 0.14295068051067594,
      "bond_mean_avg": 13.966605058805822,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.895895170050307,
      "train_quality": -0.30624114076015996,
      "val_loss": 5.835666399188963,
      "val_quality": -0.5536517591658321,
      "test_quality": -0.3489690889435886,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.469298460164,
      "e_log_p_bonds": -6604.218967616951,
      "e_log_p_tau": -0.14455837247011996,
      "h_nodes": 0.0,
      "h_bonds": -253.83459049953692,
      "h_tau": -3.8045278050149136,
      "tau_mean": 0.14455837247011996,
      "bond_mean_avg": 13.960910453666319,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}