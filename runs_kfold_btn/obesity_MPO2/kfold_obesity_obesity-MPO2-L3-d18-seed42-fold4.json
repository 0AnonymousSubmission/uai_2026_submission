{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed42-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 4,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 3909.8656392819644,
      "train_quality": -1012.9008535234789,
      "val_loss": 2898.504790143892,
      "val_quality": -750.1473591164244,
      "patience_counter": 0,
      "elbo_raw": -2987168.479969726,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145697.51316341065,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.2642733981507537,
      "train_quality": 0.6721504021535927,
      "val_loss": 2.086219574539572,
      "val_quality": 0.4593563104394264,
      "test_quality": 0.6247341837310358,
      "patience_counter": 0,
      "elbo_raw": -37067.28457950551,
      "elbo_relative": 2950101.1953902203,
      "e_log_p_nodes": -20191.322693762428,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7782572881465044,
      "h_nodes": -14334.487249255093,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1211540186614,
      "tau_mean": 0.7782572881465044,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1407801428885989,
      "train_quality": 0.704174499262384,
      "val_loss": 1.8792770718814746,
      "val_quality": 0.5129854487762502,
      "test_quality": 0.6675752758805946,
      "patience_counter": 0,
      "elbo_raw": -36196.475381078984,
      "elbo_relative": 2950972.004588647,
      "e_log_p_nodes": -19786.057333373483,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8022165254150382,
      "h_nodes": -13890.744286185552,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0908326394855976,
      "tau_mean": 0.8022165254150382,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 1.0218714694922888,
      "train_quality": 0.7350097290556011,
      "val_loss": 1.6852819158931835,
      "val_quality": 0.5632592829260119,
      "test_quality": 0.6925930549356079,
      "patience_counter": 0,
      "elbo_raw": -36003.2639039841,
      "elbo_relative": 2951165.216065742,
      "e_log_p_nodes": -19714.849925213763,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8632952473540119,
      "h_nodes": -13821.499409350981,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.017454442709095,
      "tau_mean": 0.8632952473540119,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.9582355485596927,
      "train_quality": 0.751511706489322,
      "val_loss": 1.5534430309156455,
      "val_quality": 0.597425322815432,
      "test_quality": 0.705175034379582,
      "patience_counter": 0,
      "elbo_raw": -35922.990240516905,
      "elbo_relative": 2951245.489729209,
      "e_log_p_nodes": -19693.337733392196,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9083519258167118,
      "h_nodes": -13799.316850867242,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9665793057192786,
      "tau_mean": 0.9083519258167118,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.9256356232068748,
      "train_quality": 0.7599654732397554,
      "val_loss": 1.4862704781629454,
      "val_quality": 0.6148330862170563,
      "test_quality": 0.7114098484009953,
      "patience_counter": 0,
      "elbo_raw": -35880.53620766672,
      "elbo_relative": 2951287.9437620593,
      "e_log_p_nodes": -19682.89849239901,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9348564233428991,
      "h_nodes": -13787.981500624799,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9378182331520293,
      "tau_mean": 0.9348564233428991,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.9071427393752345,
      "train_quality": 0.7647610218418945,
      "val_loss": 1.4505412067074572,
      "val_quality": 0.6240923249763655,
      "test_quality": 0.7156201175676169,
      "patience_counter": 0,
      "elbo_raw": -30176.992522722096,
      "elbo_relative": 2956991.487447004,
      "e_log_p_nodes": -13573.192254475794,
      "e_log_p_bonds": -1000.2828889277957,
      "e_log_p_tau": -0.9504287314469102,
      "h_nodes": -13779.46455156643,
      "h_bonds": 253.46814071108872,
      "h_tau": -1.9212980136771876,
      "tau_mean": 0.9504287314469102,
      "bond_mean_avg": 8.895214382327177,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.5510410896189004,
      "train_quality": 0.3384676158301254,
      "val_loss": 3.3735822774225093,
      "val_quality": 0.12573633582917387,
      "test_quality": 0.2469439264921155,
      "patience_counter": 1,
      "elbo_raw": -14701.890431436941,
      "elbo_relative": 2972466.5895382892,
      "e_log_p_nodes": -13348.652509416248,
      "e_log_p_bonds": -1775.517623001161,
      "e_log_p_tau": -0.3594908344600542,
      "h_nodes": 2956.1803280897093,
      "h_bonds": 242.64954216974039,
      "h_tau": -2.893522511134506,
      "tau_mean": 0.3594908344600542,
      "bond_mean_avg": 12.23364032609424,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 6.981550114034767,
      "train_quality": -0.810445747398306,
      "val_loss": 8.172041505195528,
      "val_quality": -1.1177841127227182,
      "test_quality": -0.9977346024746283,
      "patience_counter": 2,
      "elbo_raw": -39.765288057878934,
      "elbo_relative": 2987128.714681668,
      "e_log_p_nodes": -13345.0021093725,
      "e_log_p_bonds": -2336.7447255027196,
      "e_log_p_tau": -0.1293024656204593,
      "h_nodes": 18945.527036668616,
      "h_bonds": 208.20726746565032,
      "h_tau": -3.9160568381412304,
      "tau_mean": 0.1293024656204593,
      "bond_mean_avg": 13.479603160157529,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.504586403880765,
      "train_quality": -0.9460787817846232,
      "val_loss": 8.586658533106352,
      "val_quality": -1.2252320930120506,
      "test_quality": -1.1680635156767911,
      "patience_counter": 3,
      "elbo_raw": 14694.075932124179,
      "elbo_relative": 3001862.55590185,
      "e_log_p_nodes": -13384.356033936334,
      "e_log_p_bonds": -2779.9352882809135,
      "e_log_p_tau": -0.10332834486901768,
      "h_nodes": 34364.41794009959,
      "h_bonds": 166.932173556159,
      "h_tau": -4.140299460543247,
      "tau_mean": 0.10332834486901768,
      "bond_mean_avg": 13.82535251632064,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.338742341536511,
      "train_quality": -0.38443514847223215,
      "val_loss": 6.426362823394645,
      "val_quality": -0.6653915770403886,
      "test_quality": -0.4970567230676819,
      "patience_counter": 4,
      "elbo_raw": 29304.068831792516,
      "elbo_relative": 3016472.5488015185,
      "e_log_p_nodes": -13429.590341721349,
      "e_log_p_bonds": -3185.2518499575817,
      "e_log_p_tau": -0.1243295424857819,
      "h_nodes": 49334.52929734713,
      "h_bonds": 124.33214942033358,
      "h_tau": -3.9552755516069737,
      "tau_mean": 0.1243295424857819,
      "bond_mean_avg": 13.923322724717712,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.711028382023409,
      "train_quality": -0.22165724814627175,
      "val_loss": 5.776612351822756,
      "val_quality": -0.497008777582725,
      "test_quality": -0.31727041302376335,
      "patience_counter": 5,
      "elbo_raw": 43689.272661853196,
      "elbo_relative": 3030857.752631579,
      "e_log_p_nodes": -13474.817093991005,
      "e_log_p_bonds": -3576.519828685173,
      "e_log_p_tau": -0.14400904588786803,
      "h_nodes": 64093.38342394844,
      "h_bonds": 81.52659164399198,
      "h_tau": -3.808335076459116,
      "tau_mean": 0.14400904588786803,
      "bond_mean_avg": 13.943692415814107,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.764491069611273,
      "train_quality": -0.23552111703025425,
      "val_loss": 5.99984863797968,
      "val_quality": -0.5548604490293012,
      "test_quality": -0.36477603509264145,
      "patience_counter": 6,
      "elbo_raw": 57990.510419141174,
      "elbo_relative": 3045158.990388867,
      "e_log_p_nodes": -13519.328989590424,
      "e_log_p_bonds": -3962.36970746724,
      "e_log_p_tau": -0.14968043749080537,
      "h_nodes": 78839.97909830298,
      "h_bonds": 38.75781368130353,
      "h_tau": -3.769708587925379,
      "tau_mean": 0.14968043749080537,
      "bond_mean_avg": 13.940449905826014,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.579499296016454,
      "train_quality": -0.18754931072105996,
      "val_loss": 5.7016670728005705,
      "val_quality": -0.4775867125900488,
      "test_quality": -0.26868005974048215,
      "patience_counter": 7,
      "elbo_raw": 72320.01885557675,
      "elbo_relative": 3059488.498825303,
      "e_log_p_nodes": -13563.260812325503,
      "e_log_p_bonds": -4345.987780691298,
      "e_log_p_tau": -0.15563529817680605,
      "h_nodes": 93611.68059043742,
      "h_bonds": -3.9355893604095513,
      "h_tau": -3.7306957546743433,
      "tau_mean": 0.15563529817680605,
      "bond_mean_avg": 13.930996526360369,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.706355025261997,
      "train_quality": -0.2204453598497509,
      "val_loss": 5.89521940111154,
      "val_quality": -0.5277457879712568,
      "test_quality": -0.31979561251643696,
      "patience_counter": 8,
      "elbo_raw": 86609.66550483176,
      "elbo_relative": 3073778.1454745578,
      "e_log_p_nodes": -13606.794870179894,
      "e_log_p_bonds": -4728.582301234551,
      "e_log_p_tau": -0.15427526936439342,
      "h_nodes": 108376.39309956098,
      "h_bonds": -46.56172569942147,
      "h_tau": -3.7394727225209863,
      "tau_mean": 0.15427526936439342,
      "bond_mean_avg": 13.920719116998333,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 4.650109551540648,
      "train_quality": -0.20585986278305834,
      "val_loss": 5.834865601836562,
      "val_quality": -0.5121051041634537,
      "test_quality": -0.2756274396420677,
      "patience_counter": 9,
      "elbo_raw": 100924.58222350494,
      "elbo_relative": 3088093.0621932307,
      "e_log_p_nodes": -13650.051382588505,
      "e_log_p_bonds": -5110.730505234528,
      "e_log_p_tau": -0.1552137262917007,
      "h_nodes": 123154.92830371016,
      "h_bonds": -89.13580738991253,
      "h_tau": -3.733408146288639,
      "tau_mean": 0.1552137262917007,
      "bond_mean_avg": 13.911579906058938,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.4922333894272475,
      "train_quality": -0.16491963867162718,
      "val_loss": 5.625614770166741,
      "val_quality": -0.4578777624884731,
      "test_quality": -0.21897903567293353,
      "patience_counter": 10,
      "elbo_raw": 115241.9020882812,
      "elbo_relative": 3102410.382058007,
      "e_log_p_nodes": -13693.113774981479,
      "e_log_p_bonds": -5492.649866793858,
      "e_log_p_tau": -0.15934980228523898,
      "h_nodes": 137920.85598952434,
      "h_bonds": -131.67122986983316,
      "h_tau": -3.7071093926233516,
      "tau_mean": 0.15934980228523898,
      "bond_mean_avg": 13.903855690810246,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.492544421488521,
      "train_quality": -0.16500029506790592,
      "val_loss": 5.638802659498906,
      "val_quality": -0.46129540329343577,
      "test_quality": -0.25810195486678933,
      "patience_counter": 11,
      "elbo_raw": 129565.53875882794,
      "elbo_relative": 3116734.018728554,
      "e_log_p_nodes": -13736.036074648851,
      "e_log_p_bonds": -5874.592186334742,
      "e_log_p_tau": -0.16059214078281037,
      "h_nodes": 152706.29796847265,
      "h_bonds": -174.19549079083424,
      "h_tau": -3.6993433290081157,
      "tau_mean": 0.16059214078281037,
      "bond_mean_avg": 13.897399921100519,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.366550052513139,
      "train_quality": -0.13232761267190618,
      "val_loss": 5.280071856915836,
      "val_quality": -0.36833033526585734,
      "test_quality": -0.18193942565285393,
      "patience_counter": 12,
      "elbo_raw": 143869.39179227946,
      "elbo_relative": 3131037.8717620056,
      "e_log_p_nodes": -13778.861376313609,
      "e_log_p_bonds": -6256.520492958468,
      "e_log_p_tau": -0.16423089491117512,
      "h_nodes": 167461.29805454795,
      "h_bonds": -216.69862086928407,
      "h_tau": -3.6769378592598514,
      "tau_mean": 0.16423089491117512,
      "bond_mean_avg": 13.892352228737053,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.419968741391277,
      "train_quality": -0.14618007187242132,
      "val_loss": 5.601851827090325,
      "val_quality": -0.45171959707940434,
      "test_quality": -0.26359382652971264,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13821.609913852739,
      "e_log_p_bonds": -6638.428035526049,
      "e_log_p_tau": -0.16412130754865017,
      "h_nodes": 0.0,
      "h_bonds": -259.2147100169683,
      "h_tau": -3.6776053581570523,
      "tau_mean": 0.16412130754865017,
      "bond_mean_avg": 13.886996775098444,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}