{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed42-fold1",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 1,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 1,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 3945.657033589031,
      "train_quality": -1030.6025498861688,
      "val_loss": 3550.2699949115495,
      "val_quality": -962.9497773227911,
      "patience_counter": 0,
      "elbo_raw": -3012954.3357726894,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145697.51316341065,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.290530244498023,
      "train_quality": 0.6625874272406294,
      "val_loss": 1.8352589706459155,
      "val_quality": 0.5017005809081121,
      "test_quality": 0.534362700009401,
      "patience_counter": 0,
      "elbo_raw": -37057.92700341691,
      "elbo_relative": 2975896.4087692727,
      "e_log_p_nodes": -20187.659157538983,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7620567532668988,
      "h_nodes": -14313.668215118252,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1421901604617233,
      "tau_mean": 0.7620567532668988,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1506735038349793,
      "train_quality": 0.6991533449213985,
      "val_loss": 1.6354291549737316,
      "val_quality": 0.5559572731021531,
      "test_quality": 0.5791027312644104,
      "patience_counter": 0,
      "elbo_raw": -36187.03555222193,
      "elbo_relative": 2976767.3002204676,
      "e_log_p_nodes": -19786.371481972943,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7952803024165593,
      "h_nodes": -13874.746746269937,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.099516558560026,
      "tau_mean": 0.7952803024165593,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9996220928323133,
      "train_quality": 0.7386461390055598,
      "val_loss": 1.4953670921619178,
      "val_quality": 0.5939861538499067,
      "test_quality": 0.614654295170574,
      "patience_counter": 0,
      "elbo_raw": -35985.24254942513,
      "elbo_relative": 2976969.0932232644,
      "e_log_p_nodes": -19717.129024000245,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8809312368277907,
      "h_nodes": -13815.739053399868,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9972316211114958,
      "tau_mean": 0.8809312368277907,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.9105862285468153,
      "train_quality": 0.7619248030775586,
      "val_loss": 1.4159172134825357,
      "val_quality": 0.6155579478179937,
      "test_quality": 0.6411831616303396,
      "patience_counter": 0,
      "elbo_raw": -35899.345101262734,
      "elbo_relative": 2977054.9906714265,
      "e_log_p_nodes": -19698.76358814441,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9540450356505199,
      "h_nodes": -13805.533960967321,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9175003152131467,
      "tau_mean": 0.9540450356505199,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8646018982944547,
      "train_quality": 0.7739475288084854,
      "val_loss": 1.3834142486856613,
      "val_quality": 0.624382974005631,
      "test_quality": 0.6538971411173129,
      "patience_counter": 0,
      "elbo_raw": -35856.95217736345,
      "elbo_relative": 2977097.383595326,
      "e_log_p_nodes": -19692.243978305003,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0003155948726157,
      "h_nodes": -13803.712447161615,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.87014036866276,
      "tau_mean": 1.0003155948726157,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8378037445615022,
      "train_quality": 0.7809539775413112,
      "val_loss": 1.3701538864514216,
      "val_quality": 0.6279833546080178,
      "test_quality": 0.6602732759776773,
      "patience_counter": 0,
      "elbo_raw": -30141.48324622917,
      "elbo_relative": 2982812.8525264603,
      "e_log_p_nodes": -13573.754229663991,
      "e_log_p_bonds": -999.6307063058168,
      "e_log_p_tau": -1.0295203554847472,
      "h_nodes": -13801.21397964088,
      "h_bonds": 253.163317791784,
      "h_tau": -1.8413628942507785,
      "tau_mean": 1.0295203554847472,
      "bond_mean_avg": 8.87760890268111,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.420466948011061,
      "train_quality": 0.3671624638870019,
      "val_loss": 3.2282353336676524,
      "val_quality": 0.12348730223487481,
      "test_quality": 0.16976015669506506,
      "patience_counter": 1,
      "elbo_raw": -14672.433215163714,
      "elbo_relative": 2998281.902557526,
      "e_log_p_nodes": -13349.40558962903,
      "e_log_p_bonds": -1775.1493965943896,
      "e_log_p_tau": -0.37952691671634203,
      "h_nodes": 2947.1668860490563,
      "h_bonds": 242.50873981339845,
      "h_tau": -2.8392856716181996,
      "tau_mean": 0.37952691671634203,
      "bond_mean_avg": 12.225257251168646,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.058732098630156,
      "train_quality": -0.8455243245727755,
      "val_loss": 8.317607544703332,
      "val_quality": -1.2583510414888592,
      "test_quality": -1.092433287819385,
      "patience_counter": 2,
      "elbo_raw": -39.21724583892865,
      "elbo_relative": 3012915.1185268504,
      "e_log_p_nodes": -13344.656405947071,
      "e_log_p_bonds": -2339.6526929259326,
      "e_log_p_tau": -0.12825109043711952,
      "h_nodes": 18954.191570506417,
      "h_bonds": 208.52326475959313,
      "h_tau": -3.9242212062790713,
      "tau_mean": 0.12825109043711952,
      "bond_mean_avg": 13.509794470020386,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.141946594299836,
      "train_quality": -0.8672809763013845,
      "val_loss": 8.220716240038236,
      "val_quality": -1.2320436474905723,
      "test_quality": -1.0797749071811142,
      "patience_counter": 3,
      "elbo_raw": 14590.949289772601,
      "elbo_relative": 3027545.285062462,
      "e_log_p_nodes": -13383.029187115475,
      "e_log_p_bonds": -2783.67161441869,
      "e_log_p_tau": -0.10607976390810629,
      "h_nodes": 34243.95934451952,
      "h_bonds": 167.77867418917882,
      "h_tau": -4.1140198918947135,
      "tau_mean": 0.10607976390810629,
      "bond_mean_avg": 13.884882202566,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 4.970818497496312,
      "train_quality": -0.2996337475318034,
      "val_loss": 5.95984855788512,
      "val_quality": -0.6181852925228153,
      "test_quality": -0.529690872955328,
      "patience_counter": 4,
      "elbo_raw": 29028.39608350405,
      "elbo_relative": 3041982.7318561934,
      "e_log_p_nodes": -13427.49110659383,
      "e_log_p_bonds": -3187.202459732441,
      "e_log_p_tau": -0.12945004190905554,
      "h_nodes": 49028.36762652318,
      "h_bonds": 125.6546702221503,
      "h_tau": -3.9149161627829017,
      "tau_mean": 0.12945004190905554,
      "bond_mean_avg": 13.996001051094288,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.484062536753914,
      "train_quality": -0.17237010398663766,
      "val_loss": 5.338654080676039,
      "val_quality": -0.449521985552338,
      "test_quality": -0.36455110621257947,
      "patience_counter": 5,
      "elbo_raw": 43220.77073783681,
      "elbo_relative": 3056175.106510526,
      "e_log_p_nodes": -13472.20685714928,
      "e_log_p_bonds": -3575.097921170858,
      "e_log_p_tau": -0.14868194623995837,
      "h_nodes": 63596.15521856384,
      "h_bonds": 83.2610609619577,
      "h_tau": -3.7764017572580997,
      "tau_mean": 0.14868194623995837,
      "bond_mean_avg": 14.018231493543396,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.608229614537347,
      "train_quality": -0.204833917481545,
      "val_loss": 5.597538949055726,
      "val_quality": -0.5198129807680572,
      "test_quality": -0.4073827869419935,
      "patience_counter": 6,
      "elbo_raw": 57347.07755803209,
      "elbo_relative": 3070301.4133307217,
      "e_log_p_nodes": -13516.28349155821,
      "e_log_p_bonds": -3957.3262608849773,
      "e_log_p_tau": -0.15264361593589054,
      "h_nodes": 78172.22780735839,
      "h_bonds": 40.89298857917477,
      "h_tau": -3.7501052960005836,
      "tau_mean": 0.15264361593589054,
      "bond_mean_avg": 14.014932337621152,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.6634314147155775,
      "train_quality": -0.21926657529680638,
      "val_loss": 5.626477615887778,
      "val_quality": -0.5276702483811557,
      "test_quality": -0.41971796511495807,
      "patience_counter": 7,
      "elbo_raw": 71462.64212721572,
      "elbo_relative": 3084416.9778999053,
      "e_log_p_nodes": -13559.801650168398,
      "e_log_p_bonds": -4337.192522562997,
      "e_log_p_tau": -0.15241487873512427,
      "h_nodes": 92754.5272827446,
      "h_bonds": -1.3795816908178864,
      "h_tau": -3.751604924745152,
      "tau_mean": 0.15241487873512427,
      "bond_mean_avg": 14.005608632452006,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.884175792092829,
      "train_quality": -0.27698078122926395,
      "val_loss": 5.938500383623883,
      "val_quality": -0.6123889536936946,
      "test_quality": -0.48266125216777933,
      "patience_counter": 8,
      "elbo_raw": 85573.93368634033,
      "elbo_relative": 3098528.2694590297,
      "e_log_p_nodes": -13602.92354058739,
      "e_log_p_bonds": -4715.965371891966,
      "e_log_p_tau": -0.1472252703076858,
      "h_nodes": 107354.82096001682,
      "h_bonds": -43.57927081235323,
      "h_tau": -3.7862473278810285,
      "tau_mean": 0.1472252703076858,
      "bond_mean_avg": 13.995316522251068,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.046993381960803,
      "train_quality": -0.31954987414440295,
      "val_loss": 6.096152027423829,
      "val_quality": -0.6551936607028346,
      "test_quality": -0.5466607757232034,
      "patience_counter": 9,
      "elbo_raw": 99672.79903829003,
      "elbo_relative": 3112627.1348109795,
      "e_log_p_nodes": -13645.770694855626,
      "e_log_p_bonds": -5094.222329558532,
      "e_log_p_tau": -0.14241796156776734,
      "h_nodes": 121940.80285578621,
      "h_bonds": -85.7220791767591,
      "h_tau": -3.819445067098968,
      "tau_mean": 0.14241796156776734,
      "bond_mean_avg": 13.98600116545875,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.986043367388778,
      "train_quality": -0.3036143303521166,
      "val_loss": 6.055344302768117,
      "val_quality": -0.6441137718066936,
      "test_quality": -0.5025787080629309,
      "patience_counter": 10,
      "elbo_raw": 113798.3445641506,
      "elbo_relative": 3126752.68033684,
      "e_log_p_nodes": -13688.420875303294,
      "e_log_p_bonds": -5472.199529824438,
      "e_log_p_tau": -0.14221052526154743,
      "h_nodes": 136530.12125967882,
      "h_bonds": -127.81985425311842,
      "h_tau": -3.8209026607873966,
      "tau_mean": 0.14221052526154743,
      "bond_mean_avg": 13.978121570803117,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 5.222388443244234,
      "train_quality": -0.36540738049052446,
      "val_loss": 6.25518684875205,
      "val_quality": -0.6983739204649455,
      "test_quality": -0.6250262604277024,
      "patience_counter": 11,
      "elbo_raw": 127892.21900071076,
      "elbo_relative": 3140846.5547734,
      "e_log_p_nodes": -13730.925758427933,
      "e_log_p_bonds": -5850.108638707598,
      "e_log_p_tau": -0.1376159821258238,
      "h_nodes": 151110.09873209838,
      "h_bonds": -169.89573437509117,
      "h_tau": -3.853744124802688,
      "tau_mean": 0.1376159821258238,
      "bond_mean_avg": 13.971535452689892,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.971296405245002,
      "train_quality": -0.2997586977867195,
      "val_loss": 6.006057398209094,
      "val_quality": -0.6307316626311397,
      "test_quality": -0.5039246873275132,
      "patience_counter": 12,
      "elbo_raw": 142008.82196637595,
      "elbo_relative": 3154963.1577390656,
      "e_log_p_nodes": -13773.323019521165,
      "e_log_p_bonds": -6227.922384646541,
      "e_log_p_tau": -0.14114363149829864,
      "h_nodes": 165670.7577914614,
      "h_bonds": -211.9389835703023,
      "h_tau": -3.8284331577260673,
      "tau_mean": 0.14114363149829864,
      "bond_mean_avg": 13.966475022277482,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 5.156857643053514,
      "train_quality": -0.34827417808663075,
      "val_loss": 6.189279517177875,
      "val_quality": -0.6804791243829793,
      "test_quality": -0.6059626013909405,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.626649784874,
      "e_log_p_bonds": -6605.687807685363,
      "e_log_p_tau": -0.13859286111787664,
      "h_nodes": 0.0,
      "h_bonds": -253.97612966306824,
      "h_tau": -3.846670614384493,
      "tau_mean": 0.13859286111787664,
      "bond_mean_avg": 13.961854136647327,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}