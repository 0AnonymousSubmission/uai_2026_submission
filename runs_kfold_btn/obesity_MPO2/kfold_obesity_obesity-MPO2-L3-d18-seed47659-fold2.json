{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed47659-fold2",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 2,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 2,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 7575.979132494229,
      "train_quality": -2009.0283052978025,
      "val_loss": 5314.877731956322,
      "val_quality": -1461.3704359806395,
      "patience_counter": 0,
      "elbo_raw": -5619481.609619373,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145612.13447672906,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.297058969844841,
      "train_quality": 0.6558695321841259,
      "val_loss": 2.145762692856026,
      "val_quality": 0.40960073158487387,
      "test_quality": 0.611148098587072,
      "patience_counter": 0,
      "elbo_raw": -36979.102880465274,
      "elbo_relative": 5582502.506738909,
      "e_log_p_nodes": -20137.25847122912,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7567721215607147,
      "h_nodes": -14280.241283369132,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1491490129301383,
      "tau_mean": 0.7567721215607147,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0787532685590253,
      "train_quality": 0.7137895226062629,
      "val_loss": 1.8494903320524985,
      "val_quality": 0.4911190586824553,
      "test_quality": 0.6691387187812584,
      "patience_counter": 0,
      "elbo_raw": -36150.2222298817,
      "elbo_relative": 5583331.387389491,
      "e_log_p_nodes": -19786.01301412071,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8422077176213992,
      "h_nodes": -13879.513629649846,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0421845133969327,
      "tau_mean": 0.8422077176213992,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9399387315794452,
      "train_quality": 0.7506192371073248,
      "val_loss": 1.711489949746537,
      "val_quality": 0.529089392040243,
      "test_quality": 0.7067416458712166,
      "patience_counter": 0,
      "elbo_raw": -35975.69641807997,
      "elbo_relative": 5583505.913201294,
      "e_log_p_nodes": -19728.339955687297,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9354932934319363,
      "h_nodes": -13838.189831812566,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9371372160057945,
      "tau_mean": 0.9354932934319363,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8793893602997355,
      "train_quality": 0.7666839527053644,
      "val_loss": 1.6257878505945236,
      "val_quality": 0.5526700315999897,
      "test_quality": 0.7247832286021982,
      "patience_counter": 0,
      "elbo_raw": -35909.50641272148,
      "elbo_relative": 5583572.103206652,
      "e_log_p_nodes": -19712.53773702528,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9903470913780569,
      "h_nodes": -13828.771788306636,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8801557136921474,
      "tau_mean": 0.9903470913780569,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.851476935093495,
      "train_quality": 0.7740895650695024,
      "val_loss": 1.5841986705593414,
      "val_quality": 0.5641131522901321,
      "test_quality": 0.7318391927790793,
      "patience_counter": 0,
      "elbo_raw": -35875.6001788954,
      "elbo_relative": 5583606.009440478,
      "e_log_p_nodes": -19705.82803965359,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0183278017083268,
      "h_nodes": -13821.607738844534,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8522940418424696,
      "tau_mean": 1.0183278017083268,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8339816415012189,
      "train_quality": 0.7787313459819047,
      "val_loss": 1.5599561149074652,
      "val_quality": 0.5707834085906227,
      "test_quality": 0.7353287057606529,
      "patience_counter": 0,
      "elbo_raw": -30152.329581983417,
      "elbo_relative": 5589329.28003739,
      "e_log_p_nodes": -13574.8849347333,
      "e_log_p_bonds": -1000.7654301983566,
      "e_log_p_tau": -1.036107766619965,
      "h_nodes": -13814.290249898035,
      "h_bonds": 253.07277430718221,
      "h_tau": -1.8349847534846049,
      "tau_mean": 1.036107766619965,
      "bond_mean_avg": 8.878346709140734,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.729386961760474,
      "train_quality": 0.2758500316191965,
      "val_loss": 3.6910295653510437,
      "val_quality": -0.015574164998344298,
      "test_quality": 0.2457935617098469,
      "patience_counter": 1,
      "elbo_raw": -14728.292524141889,
      "elbo_relative": 5604753.317095231,
      "e_log_p_nodes": -13349.254773312874,
      "e_log_p_bonds": -1777.5680323455326,
      "e_log_p_tau": -0.33989693692892875,
      "h_nodes": 2972.7263463508525,
      "h_bonds": 242.65154472423,
      "h_tau": -2.949568747749254,
      "tau_mean": 0.33989693692892875,
      "bond_mean_avg": 12.24428655150374,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.668698446532999,
      "train_quality": -1.0346282206891169,
      "val_loss": 8.927345777406636,
      "val_quality": -1.4563286673860496,
      "test_quality": -0.9775806895870196,
      "patience_counter": 2,
      "elbo_raw": -75.91629552200175,
      "elbo_relative": 5619405.693323852,
      "e_log_p_nodes": -13344.450920930154,
      "e_log_p_bonds": -2340.1057537423367,
      "e_log_p_tau": -0.11773753039028127,
      "h_nodes": 18979.194143746467,
      "h_bonds": 208.56685916914293,
      "h_tau": -4.009753364460266,
      "tau_mean": 0.11773753039028127,
      "bond_mean_avg": 13.514221866202107,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.2279342890070994,
      "train_quality": -0.917686447606894,
      "val_loss": 8.45780065748784,
      "val_quality": -1.327134933050512,
      "test_quality": -0.8621193258646582,
      "patience_counter": 3,
      "elbo_raw": 14588.412279279888,
      "elbo_relative": 5634070.021898653,
      "e_log_p_nodes": -13382.956359952066,
      "e_log_p_bonds": -2783.3426782121646,
      "e_log_p_tau": -0.1029208351806853,
      "h_nodes": 34262.69397416495,
      "h_bonds": 167.8418007078266,
      "h_tau": -4.144251090494436,
      "tau_mean": 0.1029208351806853,
      "bond_mean_avg": 13.886168509280662,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.126185702855591,
      "train_quality": -0.3600589680558359,
      "val_loss": 6.319669387432554,
      "val_quality": -0.7388354245266,
      "test_quality": -0.3704310232835051,
      "patience_counter": 4,
      "elbo_raw": 28995.531667929492,
      "elbo_relative": 5648477.141287303,
      "e_log_p_nodes": -13427.430459104506,
      "e_log_p_bonds": -3186.608136414097,
      "e_log_p_tau": -0.12557581467690637,
      "h_nodes": 49016.63391058175,
      "h_bonds": 125.71579138409922,
      "h_tau": -3.94530151554045,
      "tau_mean": 0.12557581467690637,
      "bond_mean_avg": 13.995803679756644,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.7787545877101945,
      "train_quality": -0.26787994229952905,
      "val_loss": 5.91180961766065,
      "val_quality": -0.6266142033771227,
      "test_quality": -0.2881905248653964,
      "patience_counter": 5,
      "elbo_raw": 43175.121515898936,
      "elbo_relative": 5662656.731135272,
      "e_log_p_nodes": -13472.144337804271,
      "e_log_p_bonds": -3574.4273079424033,
      "e_log_p_tau": -0.14099933031159528,
      "h_nodes": 63587.84918814288,
      "h_bonds": 83.33044253344708,
      "h_tau": -3.8294560519243532,
      "tau_mean": 0.14099933031159528,
      "bond_mean_avg": 14.018009136497176,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.861467691700547,
      "train_quality": -0.2898250502957431,
      "val_loss": 6.060158445623647,
      "val_quality": -0.6674318761753288,
      "test_quality": -0.320403029786009,
      "patience_counter": 6,
      "elbo_raw": 57294.612069862094,
      "elbo_relative": 5676776.221689235,
      "e_log_p_nodes": -13516.213056594697,
      "e_log_p_bonds": -3956.5911706491565,
      "e_log_p_tau": -0.14471636435882462,
      "h_nodes": 78157.22068138873,
      "h_bonds": 40.97369112296441,
      "h_tau": -3.8034354738547336,
      "tau_mean": 0.14471636435882462,
      "bond_mean_avg": 14.014893719683565,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.796588552227104,
      "train_quality": -0.27261157801918334,
      "val_loss": 6.003039700295492,
      "val_quality": -0.651715848691578,
      "test_quality": -0.3032657300842072,
      "patience_counter": 7,
      "elbo_raw": 71418.75217719976,
      "elbo_relative": 5690900.361796573,
      "e_log_p_nodes": -13559.724837221138,
      "e_log_p_bonds": -4336.391695651715,
      "e_log_p_tau": -0.1470583302319832,
      "h_nodes": 92735.39575491505,
      "h_bonds": -1.2920005692424326,
      "h_tau": -3.787381880355497,
      "tau_mean": 0.1470583302319832,
      "bond_mean_avg": 14.005545402740498,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.015291039593246,
      "train_quality": -0.330636842127884,
      "val_loss": 6.313991194854949,
      "val_quality": -0.7372730892530399,
      "test_quality": -0.3601512842921195,
      "patience_counter": 8,
      "elbo_raw": 85531.36523624026,
      "elbo_relative": 5705012.974855614,
      "e_log_p_nodes": -13602.845151216778,
      "e_log_p_bonds": -4715.165351313002,
      "e_log_p_tau": -0.1433377746798099,
      "h_nodes": 107330.53212640125,
      "h_bonds": -43.49679217004848,
      "h_tau": -3.8130072870499134,
      "tau_mean": 0.1433377746798099,
      "bond_mean_avg": 13.99501676752223,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 4.868791065358877,
      "train_quality": -0.2917680583328668,
      "val_loss": 6.069611590186155,
      "val_quality": -0.6700328765806902,
      "test_quality": -0.3198588462079026,
      "patience_counter": 9,
      "elbo_raw": 99670.0328252255,
      "elbo_relative": 5719151.642444599,
      "e_log_p_nodes": -13645.696395098845,
      "e_log_p_bonds": -5093.464660840174,
      "e_log_p_tau": -0.1450425475504633,
      "h_nodes": 121923.99713909911,
      "h_bonds": -85.64413315946379,
      "h_tau": -3.801184061967433,
      "tau_mean": 0.1450425475504633,
      "bond_mean_avg": 13.985706655703046,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.080150657880038,
      "train_quality": -0.3478451351217351,
      "val_loss": 6.422327994347302,
      "val_quality": -0.7670815892216865,
      "test_quality": -0.37399083075743667,
      "patience_counter": 10,
      "elbo_raw": 113783.78656215352,
      "elbo_relative": 5733265.396181527,
      "e_log_p_nodes": -13688.359552349526,
      "e_log_p_bonds": -5471.622357201738,
      "e_log_p_tau": -0.14135862877711358,
      "h_nodes": 136519.19483602594,
      "h_bonds": -127.76934457429026,
      "h_tau": -3.8269110649816866,
      "tau_mean": 0.14135862877711358,
      "bond_mean_avg": 13.977483217680094,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.867088300043852,
      "train_quality": -0.2913162874897026,
      "val_loss": 6.136459415959895,
      "val_quality": -0.6884258272845849,
      "test_quality": -0.3351533063116521,
      "patience_counter": 11,
      "elbo_raw": 127935.3918360773,
      "elbo_relative": 5747417.00145545,
      "e_log_p_nodes": -13730.88688409895,
      "e_log_p_bonds": -5849.749556814908,
      "e_log_p_tau": -0.14444371113951496,
      "h_nodes": 151118.02754536373,
      "h_bonds": -169.8656694420216,
      "h_tau": -3.805321303353594,
      "tau_mean": 0.14444371113951496,
      "bond_mean_avg": 13.971071170096902,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.726291515222897,
      "train_quality": -0.25396065096594267,
      "val_loss": 6.064721193345884,
      "val_quality": -0.6686873006107243,
      "test_quality": -0.2952529081198261,
      "patience_counter": 12,
      "elbo_raw": 142080.02444074673,
      "elbo_relative": 5761561.63406012,
      "e_log_p_nodes": -13773.313357932422,
      "e_log_p_bonds": -6227.911959074797,
      "e_log_p_tau": -0.14854913261931724,
      "h_nodes": 165705.18722415433,
      "h_bonds": -211.95420779649993,
      "h_tau": -3.7772954298179684,
      "tau_mean": 0.14854913261931724,
      "bond_mean_avg": 13.96570705795979,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.53823775266376,
      "train_quality": -0.2040669832233324,
      "val_loss": 5.857545528903756,
      "val_quality": -0.6116836248886686,
      "test_quality": -0.2412515821097354,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.660758320104,
      "e_log_p_bonds": -6606.019526219489,
      "e_log_p_tau": -0.15412465303673759,
      "h_nodes": 0.0,
      "h_bonds": -254.051897985761,
      "h_tau": -3.7404494824268113,
      "tau_mean": 0.15412465303673759,
      "bond_mean_avg": 13.960042668288645,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}