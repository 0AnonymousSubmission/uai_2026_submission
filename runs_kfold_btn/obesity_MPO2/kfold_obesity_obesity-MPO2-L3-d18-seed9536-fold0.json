{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed9536-fold0",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 0,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 0,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1435,
    "n_val": 253,
    "n_test": 423,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4464.030661783564,
      "train_quality": -1181.8601056842303,
      "val_loss": 3689.5119966899847,
      "val_quality": -1018.2047602028774,
      "patience_counter": 0,
      "elbo_raw": -3383001.9783892096,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145672.90423734512,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.3527793096617209,
      "train_quality": 0.6415462172129037,
      "val_loss": 1.5641915600901115,
      "val_quality": 0.5679018023675602,
      "test_quality": 0.5897485125633362,
      "patience_counter": 0,
      "elbo_raw": -37003.900605895695,
      "elbo_relative": 3345998.077783314,
      "e_log_p_nodes": -20121.96178602543,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7263120113665248,
      "h_nodes": -14292.37664779427,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.189883999249105,
      "tau_mean": 0.7263120113665248,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1535768190491327,
      "train_quality": 0.6943300569646729,
      "val_loss": 1.3907738595338104,
      "val_quality": 0.6158073644226469,
      "test_quality": 0.650018537466766,
      "patience_counter": 0,
      "elbo_raw": -36163.10825042001,
      "elbo_relative": 3346838.8701387895,
      "e_log_p_nodes": -19755.451449073753,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7902212552788325,
      "h_nodes": -13878.68784317149,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1055507132505227,
      "tau_mean": 0.7902212552788325,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 1.0183053555348989,
      "train_quality": 0.730173721525117,
      "val_loss": 1.3317480243955837,
      "val_quality": 0.6321128845569635,
      "test_quality": 0.6768154807371309,
      "patience_counter": 0,
      "elbo_raw": -35986.64443660098,
      "elbo_relative": 3347015.3339526085,
      "e_log_p_nodes": -19689.037129917262,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8664820343503472,
      "h_nodes": -13834.832855753306,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.013422314114905,
      "tau_mean": 0.8664820343503472,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.9484036545215556,
      "train_quality": 0.7486959808267848,
      "val_loss": 1.2886013956632545,
      "val_quality": 0.6440318726047455,
      "test_quality": 0.6947421341947504,
      "patience_counter": 0,
      "elbo_raw": -35908.78694386549,
      "elbo_relative": 3347093.191445344,
      "e_log_p_nodes": -19670.069455485198,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9191856111109626,
      "h_nodes": -13818.36812342334,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9543756167686297,
      "tau_mean": 0.9191856111109626,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.9096701280051608,
      "train_quality": 0.7589594280877855,
      "val_loss": 1.2542337613440788,
      "val_quality": 0.6535257180039311,
      "test_quality": 0.7055887808670804,
      "patience_counter": 0,
      "elbo_raw": -35867.0865949297,
      "elbo_relative": 3347134.8917942797,
      "e_log_p_nodes": -19663.966829364756,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9529328507892507,
      "h_nodes": -13808.676669530525,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9183192491727823,
      "tau_mean": 0.9529328507892507,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8825194027919013,
      "train_quality": 0.7661537132816798,
      "val_loss": 1.22668683995556,
      "val_quality": 0.6611353838441022,
      "test_quality": 0.7126091100702905,
      "patience_counter": 0,
      "elbo_raw": -30180.318114005466,
      "elbo_relative": 3352821.660275204,
      "e_log_p_nodes": -13575.21802171942,
      "e_log_p_bonds": -1000.954391336329,
      "e_log_p_tau": -0.9785782427058894,
      "h_nodes": -13802.574125047702,
      "h_bonds": 253.5333305335339,
      "h_tau": -1.89176294394656,
      "tau_mean": 0.9785782427058894,
      "bond_mean_avg": 8.901105484490518,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.782887258418887,
      "train_quality": 0.2626022162478906,
      "val_loss": 3.0009197576056676,
      "val_quality": 0.17101456651109537,
      "test_quality": 0.2344745232938522,
      "patience_counter": 1,
      "elbo_raw": -14741.680784156755,
      "elbo_relative": 3368260.297605053,
      "e_log_p_nodes": -13350.128808879126,
      "e_log_p_bonds": -1776.0914118334176,
      "e_log_p_tau": -0.332349516472653,
      "h_nodes": 2973.0509976939084,
      "h_bonds": 242.51130017288364,
      "h_tau": -2.971676513860075,
      "tau_mean": 0.332349516472653,
      "bond_mean_avg": 12.229405706934617,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.377156149660808,
      "train_quality": -0.9547678687651306,
      "val_loss": 7.454147082273201,
      "val_quality": -1.059161806851717,
      "test_quality": -0.8235103755655382,
      "patience_counter": 2,
      "elbo_raw": -4.786171880296024,
      "elbo_relative": 3382997.1922173295,
      "e_log_p_nodes": -13345.022018359312,
      "e_log_p_bonds": -2340.258893732435,
      "e_log_p_tau": -0.12159905379357544,
      "h_nodes": 19025.48405180686,
      "h_bonds": 208.45502332800518,
      "h_tau": -3.9771345012732127,
      "tau_mean": 0.12159905379357544,
      "bond_mean_avg": 13.509199865074589,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.238510610041669,
      "train_quality": -0.9180301556820807,
      "val_loss": 7.36055809814767,
      "val_quality": -1.033308431606192,
      "test_quality": -0.8014710280838679,
      "patience_counter": 3,
      "elbo_raw": 14633.060444730014,
      "elbo_relative": 3397635.0388339395,
      "e_log_p_nodes": -13383.135790889995,
      "e_log_p_bonds": -2784.5304486555838,
      "e_log_p_tau": -0.10368765141070688,
      "h_nodes": 34300.951730582536,
      "h_bonds": 167.70981153427743,
      "h_tau": -4.1364806612627945,
      "tau_mean": 0.10368765141070688,
      "bond_mean_avg": 13.885692379503604,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.443325711127569,
      "train_quality": -0.4423495969818274,
      "val_loss": 5.384079137070594,
      "val_quality": -0.48731840165702023,
      "test_quality": -0.37286318732388857,
      "patience_counter": 4,
      "elbo_raw": 29019.765241014058,
      "elbo_relative": 3412021.7436302234,
      "e_log_p_nodes": -13427.615731863216,
      "e_log_p_bonds": -3188.011314594015,
      "e_log_p_tau": -0.12110539472519884,
      "h_nodes": 49066.20167308064,
      "h_bonds": 125.55808468781738,
      "h_tau": -3.9812024922157434,
      "tau_mean": 0.12110539472519884,
      "bond_mean_avg": 13.995365851478601,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 5.156180147433923,
      "train_quality": -0.366262970891827,
      "val_loss": 5.228413059138536,
      "val_quality": -0.4443166150324469,
      "test_quality": -0.3044487062381247,
      "patience_counter": 5,
      "elbo_raw": 43203.71904572272,
      "elbo_relative": 3426205.6974349325,
      "e_log_p_nodes": -13472.34647477896,
      "e_log_p_bonds": -3576.019555377375,
      "e_log_p_tau": -0.13232208850624977,
      "h_nodes": 63661.660979265944,
      "h_bonds": 83.14805745201092,
      "h_tau": -3.8926246745677417,
      "tau_mean": 0.13232208850624977,
      "bond_mean_avg": 14.017487667742042,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.183234673153892,
      "train_quality": -0.37343176554781476,
      "val_loss": 5.244898086200398,
      "val_quality": -0.44887050131025186,
      "test_quality": -0.3195323793148037,
      "patience_counter": 6,
      "elbo_raw": 57333.486345304715,
      "elbo_relative": 3440335.4647345142,
      "e_log_p_nodes": -13516.424242661413,
      "e_log_p_bonds": -3958.292677750856,
      "e_log_p_tau": -0.13558870693195338,
      "h_nodes": 78242.62010777368,
      "h_bonds": 40.784806902588414,
      "h_tau": -3.868237599646818,
      "tau_mean": 0.13558870693195338,
      "bond_mean_avg": 14.014698218108885,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 5.217739207665365,
      "train_quality": -0.3825746322597827,
      "val_loss": 5.251196962151705,
      "val_quality": -0.4506105266467353,
      "test_quality": -0.30632988767744807,
      "patience_counter": 7,
      "elbo_raw": 71447.01722932042,
      "elbo_relative": 3454448.99561853,
      "e_log_p_nodes": -13559.935139712663,
      "e_log_p_bonds": -4338.141135180948,
      "e_log_p_tau": -0.13584501161218512,
      "h_nodes": 92820.42270555889,
      "h_bonds": -1.484299309534535,
      "h_tau": -3.8663490740964335,
      "tau_mean": 0.13584501161218512,
      "bond_mean_avg": 14.005487691065895,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.278730498012075,
      "train_quality": -0.39873584834706266,
      "val_loss": 5.226608655913619,
      "val_quality": -0.44381815985522843,
      "test_quality": -0.3368995228990517,
      "patience_counter": 8,
      "elbo_raw": 85579.81771565325,
      "elbo_relative": 3468581.796104863,
      "e_log_p_nodes": -13603.056206780213,
      "e_log_p_bonds": -4716.967293303518,
      "e_log_p_tau": -0.134856667346529,
      "h_nodes": 107422.63166941065,
      "h_bonds": -43.6987475609272,
      "h_tau": -3.8736511984207027,
      "tau_mean": 0.134856667346529,
      "bond_mean_avg": 13.99481774104268,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.1072467647349615,
      "train_quality": -0.3532968085564512,
      "val_loss": 5.055880420970935,
      "val_quality": -0.3966555459619201,
      "test_quality": -0.2888523242426855,
      "patience_counter": 9,
      "elbo_raw": 99726.0695555722,
      "elbo_relative": 3482728.047944782,
      "e_log_p_nodes": -13645.912353153675,
      "e_log_p_bonds": -5095.389670950723,
      "e_log_p_tau": -0.13762809748053698,
      "h_nodes": 122017.70813957775,
      "h_bonds": -85.86126573471948,
      "h_tau": -3.8533085880126237,
      "tau_mean": 0.13762809748053698,
      "bond_mean_avg": 13.985463843160804,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.902796540335154,
      "train_quality": -0.2991224463346429,
      "val_loss": 4.723402213095904,
      "val_quality": -0.30481050725925085,
      "test_quality": -0.2420851126957333,
      "patience_counter": 10,
      "elbo_raw": 113889.48126382245,
      "elbo_relative": 3496891.459653032,
      "e_log_p_nodes": -13688.587589055667,
      "e_log_p_bonds": -5473.677804896915,
      "e_log_p_tau": -0.14270592713522554,
      "h_nodes": 136618.1933846369,
      "h_bonds": -128.00339119229488,
      "h_tau": -3.8170776302167724,
      "tau_mean": 0.14270592713522554,
      "bond_mean_avg": 13.977147324290817,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.860237327577703,
      "train_quality": -0.2878452847929249,
      "val_loss": 4.690672491644775,
      "val_quality": -0.2957691251108714,
      "test_quality": -0.24146875999189144,
      "patience_counter": 11,
      "elbo_raw": 128014.50732312111,
      "elbo_relative": 3511016.485712331,
      "e_log_p_nodes": -13731.127988601538,
      "e_log_p_bonds": -5851.978420469397,
      "e_log_p_tau": -0.14507160411943051,
      "h_nodes": 151194.36087834233,
      "h_bonds": -170.11688272288927,
      "h_tau": -3.800636247427974,
      "tau_mean": 0.14507160411943051,
      "bond_mean_avg": 13.97084684037743,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.754958846479946,
      "train_quality": -0.2599490348088771,
      "val_loss": 4.5912632213195215,
      "val_quality": -0.2683079319734891,
      "test_quality": -0.19961156979487127,
      "patience_counter": 12,
      "elbo_raw": 142144.77760858327,
      "elbo_relative": 3525146.755997793,
      "e_log_p_nodes": -13773.568383759099,
      "e_log_p_bonds": -6230.2490745903115,
      "e_log_p_tau": -0.148195449287255,
      "h_nodes": 165772.13439474124,
      "h_bonds": -212.21613554649517,
      "h_tau": -3.779331683645978,
      "tau_mean": 0.148195449287255,
      "bond_mean_avg": 13.965555077748622,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.763884337006575,
      "train_quality": -0.2623140738212648,
      "val_loss": 4.557714908065048,
      "val_quality": -0.2590404189266655,
      "test_quality": -0.20212110096537894,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.929466152284,
      "e_log_p_bonds": -6608.488984393695,
      "e_log_p_tau": -0.1488444445538954,
      "h_nodes": 0.0,
      "h_bonds": -254.32224819915865,
      "h_tau": -3.774961925153548,
      "tau_mean": 0.1488444445538954,
      "bond_mean_avg": 13.960190841044499,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}