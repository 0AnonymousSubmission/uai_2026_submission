{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed9536-fold1",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 1,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 1,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4327.842526833469,
      "train_quality": -1130.8642161718194,
      "val_loss": 4841.873264693307,
      "val_quality": -1264.5722852885965,
      "patience_counter": 0,
      "elbo_raw": -3287609.2576468065,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145672.90423734512,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.3011460307633074,
      "train_quality": 0.6597102082379778,
      "val_loss": 1.8388837490589918,
      "val_quality": 0.5193512548858377,
      "test_quality": 0.5545258319188271,
      "patience_counter": 0,
      "elbo_raw": -36974.77270248063,
      "elbo_relative": 3250634.484944326,
      "e_log_p_nodes": -20106.19373257501,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.755011990469591,
      "h_nodes": -14305.301732042071,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.15147756218812,
      "tau_mean": 0.755011990469591,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.1235853489188643,
      "train_quality": 0.7061477994240509,
      "val_loss": 1.5898689042910086,
      "val_quality": 0.5844389325129726,
      "test_quality": 0.5911731808952483,
      "patience_counter": 0,
      "elbo_raw": -36159.960902168415,
      "elbo_relative": 3251449.296744638,
      "e_log_p_nodes": -19758.551729355462,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8113945284232938,
      "h_nodes": -13889.914694861976,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0794567853554327,
      "tau_mean": 0.8113945284232938,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9779732741119509,
      "train_quality": 0.7442298451303366,
      "val_loss": 1.499090654479567,
      "val_quality": 0.6081666161568449,
      "test_quality": 0.610193687416785,
      "patience_counter": 0,
      "elbo_raw": -35974.08085139675,
      "elbo_relative": 3251635.17679541,
      "e_log_p_nodes": -19694.1560266896,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8996587623352124,
      "h_nodes": -13842.675339149477,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.976195654260664,
      "tau_mean": 0.8996587623352124,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.9014717289188853,
      "train_quality": 0.7642373571756598,
      "val_loss": 1.4160380516500723,
      "val_quality": 0.6298749646856137,
      "test_quality": 0.6235080818080905,
      "patience_counter": 0,
      "elbo_raw": -35894.61399151632,
      "elbo_relative": 3251714.6436552904,
      "e_log_p_nodes": -19677.574826011543,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9644035266953439,
      "h_nodes": -13829.756045778593,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9067013895473792,
      "tau_mean": 0.9644035266953439,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8633025241281889,
      "train_quality": 0.7742197807029624,
      "val_loss": 1.3672968693484595,
      "val_quality": 0.6426149696590869,
      "test_quality": 0.6284994633555009,
      "patience_counter": 0,
      "elbo_raw": -35855.414730256285,
      "elbo_relative": 3251753.84291655,
      "e_log_p_nodes": -19672.455432831706,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.002465087281657,
      "h_nodes": -13823.506695263839,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8679938598079389,
      "tau_mean": 1.002465087281657,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8409753288223644,
      "train_quality": 0.7800590304578818,
      "val_loss": 1.336520893691652,
      "val_quality": 0.6506592161138605,
      "test_quality": 0.6299061993823392,
      "patience_counter": 0,
      "elbo_raw": -30162.903821133274,
      "elbo_relative": 3257446.3538256735,
      "e_log_p_nodes": -13574.047355788316,
      "e_log_p_bonds": -1001.8023041928875,
      "e_log_p_tau": -1.0260532219075242,
      "h_nodes": -13818.038555144303,
      "h_bonds": 253.45733467240683,
      "h_tau": -1.8447362951383184,
      "tau_mean": 1.0260532219075242,
      "bond_mean_avg": 8.902475336477647,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.711962692833796,
      "train_quality": 0.29073816605396663,
      "val_loss": 3.474775998261773,
      "val_quality": 0.09176057269961058,
      "test_quality": 0.14459711877685755,
      "patience_counter": 1,
      "elbo_raw": -14765.104331077813,
      "elbo_relative": 3272844.1533157285,
      "e_log_p_nodes": -13349.405628980476,
      "e_log_p_bonds": -1775.6140152676876,
      "e_log_p_tau": -0.34194824869408263,
      "h_nodes": 2929.845318652825,
      "h_bonds": 242.59121357990793,
      "h_tau": -2.9435517867232193,
      "tau_mean": 0.34194824869408263,
      "bond_mean_avg": 12.231364313790188,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.554824353597299,
      "train_quality": -0.9758194278747647,
      "val_loss": 8.818658662559395,
      "val_quality": -1.3050272872977207,
      "test_quality": -1.0974502100533963,
      "patience_counter": 2,
      "elbo_raw": -40.67662111725076,
      "elbo_relative": 3287568.5810256894,
      "e_log_p_nodes": -13345.075590106035,
      "e_log_p_bonds": -2337.367899277216,
      "e_log_p_tau": -0.11978176091844453,
      "h_nodes": 19000.37641593071,
      "h_bonds": 208.13436543036582,
      "h_tau": -3.9925397647266436,
      "tau_mean": 0.11978176091844453,
      "bond_mean_avg": 13.479408003989658,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.056313617251626,
      "train_quality": -0.8454435049180735,
      "val_loss": 8.12348855427373,
      "val_quality": -1.1233232288658774,
      "test_quality": -0.8854191230298651,
      "patience_counter": 3,
      "elbo_raw": 14783.287119060384,
      "elbo_relative": 3302392.544765867,
      "e_log_p_nodes": -13384.392850172055,
      "e_log_p_bonds": -2780.6723282366206,
      "e_log_p_tau": -0.1063684423819986,
      "h_nodes": 34433.626378433946,
      "h_bonds": 166.85971278348634,
      "h_tau": -4.111302253966642,
      "tau_mean": 0.1063684423819986,
      "bond_mean_avg": 13.82577911317197,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.064835127461524,
      "train_quality": -0.32461049727198765,
      "val_loss": 5.962959390436021,
      "val_quality": -0.5586025759629676,
      "test_quality": -0.3523791299486938,
      "patience_counter": 4,
      "elbo_raw": 29372.71117154802,
      "elbo_relative": 3316981.9688183544,
      "e_log_p_nodes": -13429.663114325627,
      "e_log_p_bonds": -3186.1242419470923,
      "e_log_p_tau": -0.13014206561644168,
      "h_nodes": 49371.36058473759,
      "h_bonds": 124.23688922127491,
      "h_tau": -3.909584526522849,
      "tau_mean": 0.13014206561644168,
      "bond_mean_avg": 13.923394198550834,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.591475586364041,
      "train_quality": -0.20081238709819482,
      "val_loss": 5.336285066649611,
      "val_quality": -0.39480199450840736,
      "test_quality": -0.2577007565876255,
      "patience_counter": 5,
      "elbo_raw": 43751.037322034805,
      "elbo_relative": 3331360.294968841,
      "e_log_p_nodes": -13474.918051300854,
      "e_log_p_bonds": -3577.576832528994,
      "e_log_p_tau": -0.1487480987524738,
      "h_nodes": 64133.14808884374,
      "h_bonds": 81.40461134363693,
      "h_tau": -3.7759569298796123,
      "tau_mean": 0.1487480987524738,
      "bond_mean_avg": 13.943478221257214,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.60598185140613,
      "train_quality": -0.20460622252765948,
      "val_loss": 5.426996940312783,
      "val_quality": -0.4185123287073309,
      "test_quality": -0.2490673507443104,
      "patience_counter": 6,
      "elbo_raw": 58054.17039027009,
      "elbo_relative": 3345663.4280370767,
      "e_log_p_nodes": -13519.44909212391,
      "e_log_p_bonds": -3963.5939338421076,
      "e_log_p_tau": -0.15466996955769724,
      "h_nodes": 78881.53974569726,
      "h_bonds": 38.62472999838198,
      "h_tau": -3.736917574498875,
      "tau_mean": 0.15466996955769724,
      "bond_mean_avg": 13.94058538542231,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.626967225087041,
      "train_quality": -0.21009454456921883,
      "val_loss": 5.534357173798266,
      "val_quality": -0.44657422306382166,
      "test_quality": -0.2517413000460287,
      "patience_counter": 7,
      "elbo_raw": 72356.10031067158,
      "elbo_relative": 3359965.357957478,
      "e_log_p_nodes": -13563.3925090175,
      "e_log_p_bonds": -4347.254378647051,
      "e_log_p_tau": -0.15584307466304906,
      "h_nodes": 93648.33647280678,
      "h_bonds": -4.070941860645107,
      "h_tau": -3.729361623414661,
      "tau_mean": 0.15584307466304906,
      "bond_mean_avg": 13.93124831362881,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.675124521758683,
      "train_quality": -0.22268916198245514,
      "val_loss": 5.572163601723698,
      "val_quality": -0.4564560941439846,
      "test_quality": -0.26536835289715555,
      "patience_counter": 8,
      "elbo_raw": 86659.31695957233,
      "elbo_relative": 3374268.574606379,
      "e_log_p_nodes": -13606.926967806832,
      "e_log_p_bonds": -4729.825069647732,
      "e_log_p_tau": -0.15495317557802543,
      "h_nodes": 108424.3965286084,
      "h_bonds": -46.69165597416939,
      "h_tau": -3.735088214492862,
      "tau_mean": 0.15495317557802543,
      "bond_mean_avg": 13.92110210079546,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 4.587597439116403,
      "train_quality": -0.19979813205831531,
      "val_loss": 5.5853707341360055,
      "val_quality": -0.45990818382816423,
      "test_quality": -0.23451883785275296,
      "patience_counter": 9,
      "elbo_raw": 100970.4960168397,
      "elbo_relative": 3388579.753663646,
      "e_log_p_nodes": -13650.180658457652,
      "e_log_p_bonds": -5111.932117035888,
      "e_log_p_tau": -0.1568790295024855,
      "h_nodes": 123194.6281349321,
      "h_bonds": -89.26459342298153,
      "h_tau": -3.722736197099948,
      "tau_mean": 0.1568790295024855,
      "bond_mean_avg": 13.911805172176184,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.4365432192042,
      "train_quality": -0.16029279766587679,
      "val_loss": 5.505713730540401,
      "val_quality": -0.439087379447586,
      "test_quality": -0.20845248408220418,
      "patience_counter": 10,
      "elbo_raw": 115304.8761259976,
      "elbo_relative": 3402914.133772804,
      "e_log_p_nodes": -13693.2415877571,
      "e_log_p_bonds": -5493.8500694510585,
      "e_log_p_tau": -0.16121513430106738,
      "h_nodes": 137976.92209172834,
      "h_bonds": -131.80275179634725,
      "h_tau": -3.6954714818202774,
      "tau_mean": 0.16121513430106738,
      "bond_mean_avg": 13.903947026097688,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.327334015008066,
      "train_quality": -0.13173122465581488,
      "val_loss": 5.2824501562831765,
      "val_quality": -0.3807305872624618,
      "test_quality": -0.17747839356055128,
      "patience_counter": 11,
      "elbo_raw": 129613.87360891144,
      "elbo_relative": 3417223.131255718,
      "e_log_p_nodes": -13736.165168473148,
      "e_log_p_bonds": -5875.760800721785,
      "e_log_p_tau": -0.16557171309880395,
      "h_nodes": 152734.1040275842,
      "h_bonds": -174.32482112529607,
      "h_tau": -3.66880677998779,
      "tau_mean": 0.16557171309880395,
      "bond_mean_avg": 13.897429466078709,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.294075849999185,
      "train_quality": -0.12303318940252383,
      "val_loss": 5.374789164311211,
      "val_quality": -0.40486622300151986,
      "test_quality": -0.14491658795171491,
      "patience_counter": 12,
      "elbo_raw": 143919.97715060684,
      "elbo_relative": 3431529.2347974135,
      "e_log_p_nodes": -13778.986735103032,
      "e_log_p_bonds": -6257.690001644448,
      "e_log_p_tau": -0.16768557408216322,
      "h_nodes": 167498.33620899275,
      "h_bonds": -216.82377795361862,
      "h_tau": -3.656120549768275,
      "tau_mean": 0.16768557408216322,
      "bond_mean_avg": 13.892578786191464,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.544865525744221,
      "train_quality": -0.18862241960236426,
      "val_loss": 5.472991784995928,
      "val_quality": -0.4305344939964566,
      "test_quality": -0.22838765541404693,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13821.728712579414,
      "e_log_p_bonds": -6639.599521096507,
      "e_log_p_tau": -0.16168075345828825,
      "h_nodes": 0.0,
      "h_bonds": -259.335143688675,
      "h_tau": -3.6925874594608104,
      "tau_mean": 0.16168075345828825,
      "bond_mean_avg": 13.887451494022017,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}