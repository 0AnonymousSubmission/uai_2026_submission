{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed47659-fold0",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 0,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 0,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1435,
    "n_val": 253,
    "n_test": 423,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 7230.066249573633,
      "train_quality": -1836.9355799697978,
      "val_loss": 4737.314515603686,
      "val_quality": -1253.6060921217581,
      "patience_counter": 0,
      "elbo_raw": -5367291.0206237305,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145612.13447672906,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.2399521667147706,
      "train_quality": 0.6847951144569232,
      "val_loss": 1.49594786876348,
      "val_quality": 0.6038208348917162,
      "test_quality": 0.45597216131244944,
      "patience_counter": 0,
      "elbo_raw": -36958.39045046288,
      "elbo_relative": 5330332.630173268,
      "e_log_p_nodes": -20170.066155152577,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.791092526907331,
      "h_nodes": -14260.147103767695,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1044487539475085,
      "tau_mean": 0.791092526907331,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0785752059101463,
      "train_quality": 0.7258183150489927,
      "val_loss": 1.2861364616631592,
      "val_quality": 0.6593862124231585,
      "test_quality": 0.5410346976731464,
      "patience_counter": 0,
      "elbo_raw": -36173.94467726667,
      "elbo_relative": 5331117.075946464,
      "e_log_p_nodes": -19810.630522241067,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8463935553155767,
      "h_nodes": -13883.685810460138,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.036879242627947,
      "tau_mean": 0.8463935553155767,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9568667936065661,
      "train_quality": 0.7567574812520099,
      "val_loss": 1.2037899367381288,
      "val_quality": 0.681194443963562,
      "test_quality": 0.5699752443154587,
      "patience_counter": 0,
      "elbo_raw": -35991.07869436848,
      "elbo_relative": 5331299.941929362,
      "e_log_p_nodes": -19739.280075965908,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9223813403477741,
      "h_nodes": -13833.942752493569,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.950904950180302,
      "tau_mean": 0.9223813403477741,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8938183300186697,
      "train_quality": 0.7727848605996692,
      "val_loss": 1.1659569819778088,
      "val_quality": 0.6912139297648369,
      "test_quality": 0.5838911264907771,
      "patience_counter": 0,
      "elbo_raw": -35912.241814329835,
      "elbo_relative": 5331378.7788094,
      "e_log_p_nodes": -19717.032310284267,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9754805082593129,
      "h_nodes": -13817.569248934371,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8949335108909509,
      "tau_mean": 0.9754805082593129,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8636984178387792,
      "train_quality": 0.7804415619838717,
      "val_loss": 1.1445370964201484,
      "val_quality": 0.6968866624543545,
      "test_quality": 0.5861617422526937,
      "patience_counter": 0,
      "elbo_raw": -35870.87004721602,
      "elbo_relative": 5331420.150576514,
      "e_log_p_nodes": -19706.25119365648,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0044439281838355,
      "h_nodes": -13808.001336406856,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.865674327398665,
      "tau_mean": 1.0044439281838355,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8457885787261975,
      "train_quality": 0.7849943737286451,
      "val_loss": 1.1276595025490832,
      "val_quality": 0.7013564378980686,
      "test_quality": 0.5863431782483709,
      "patience_counter": 0,
      "elbo_raw": -30145.27077189808,
      "elbo_relative": 5337145.749851832,
      "e_log_p_nodes": -13574.40144461873,
      "e_log_p_bonds": -1000.232277378343,
      "e_log_p_tau": -1.0221682584370473,
      "h_nodes": -13799.878104588319,
      "h_bonds": 253.03334895008328,
      "h_tau": -1.8481822958246994,
      "tau_mean": 1.0221682584370473,
      "bond_mean_avg": 8.874233825893215,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.773430454439435,
      "train_quality": 0.29497374784267816,
      "val_loss": 3.1194637392180327,
      "val_quality": 0.1738572141484399,
      "test_quality": 0.060075449480289866,
      "patience_counter": 1,
      "elbo_raw": -14706.183104655434,
      "elbo_relative": 5352584.837519075,
      "e_log_p_nodes": -13349.980954556077,
      "e_log_p_bonds": -1774.8299354285161,
      "e_log_p_tau": -0.33480204297775357,
      "h_nodes": 3002.1691198132985,
      "h_bonds": 242.19884497195187,
      "h_tau": -2.964324248791854,
      "tau_mean": 0.33480204297775357,
      "bond_mean_avg": 12.208793605869817,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.824034091199052,
      "train_quality": -0.9889265379773542,
      "val_loss": 8.403055558126164,
      "val_quality": -1.2254221586803866,
      "test_quality": -1.2440814319256357,
      "patience_counter": 2,
      "elbo_raw": 44.41942899922287,
      "elbo_relative": 5367335.44005273,
      "e_log_p_nodes": -13345.636360408802,
      "e_log_p_bonds": -2338.3118432017027,
      "e_log_p_tau": -0.1157959113625874,
      "h_nodes": 19109.141037794376,
      "h_bonds": 207.80527888895242,
      "h_tau": -4.026034432706183,
      "tau_mean": 0.1157959113625874,
      "bond_mean_avg": 13.468683103005171,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 6.867405761197584,
      "train_quality": -0.7457446384172399,
      "val_loss": 7.550865500287242,
      "val_quality": -0.9997325122174561,
      "test_quality": -0.9785020415547736,
      "patience_counter": 3,
      "elbo_raw": 14879.473137417546,
      "elbo_relative": 5382170.493761148,
      "e_log_p_nodes": -13384.788437799565,
      "e_log_p_bonds": -2782.678350453947,
      "e_log_p_tau": -0.10761445715350006,
      "h_nodes": 34521.58053359283,
      "h_bonds": 166.58593537066938,
      "h_tau": -4.099308690607359,
      "tau_mean": 0.10761445715350006,
      "bond_mean_avg": 13.823149787935861,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.170079620913488,
      "train_quality": -0.31427195250306683,
      "val_loss": 5.489347609245126,
      "val_quality": -0.4537706816063747,
      "test_quality": -0.43552992639158283,
      "patience_counter": 4,
      "elbo_raw": 29442.471959321952,
      "elbo_relative": 5396733.492583052,
      "e_log_p_nodes": -13429.963798372366,
      "e_log_p_bonds": -3188.4274842244095,
      "e_log_p_tau": -0.12876020634840254,
      "h_nodes": 49449.205416421064,
      "h_bonds": 123.98793096432674,
      "h_tau": -3.9199118804617683,
      "tau_mean": 0.12876020634840254,
      "bond_mean_avg": 13.923504529438286,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.695050483529158,
      "train_quality": -0.19351608070555626,
      "val_loss": 4.9757269641755215,
      "val_quality": -0.3177460228632518,
      "test_quality": -0.30305948195170407,
      "patience_counter": 5,
      "elbo_raw": 43827.097004632466,
      "elbo_relative": 5411118.117628363,
      "e_log_p_nodes": -13475.202625016418,
      "e_log_p_bonds": -3579.901335117482,
      "e_log_p_tau": -0.14596339984779969,
      "h_nodes": 64223.281392240126,
      "h_bonds": 81.14661276479796,
      "h_tau": -3.794507785164569,
      "tau_mean": 0.14596339984779969,
      "bond_mean_avg": 13.943320396969767,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.9363476810501865,
      "train_quality": -0.2548555884447905,
      "val_loss": 5.392382621295683,
      "val_quality": -0.42809097125503803,
      "test_quality": -0.38503886930486675,
      "patience_counter": 6,
      "elbo_raw": 58123.24072055789,
      "elbo_relative": 5425414.2613442885,
      "e_log_p_nodes": -13519.737772155799,
      "e_log_p_bonds": -3966.042750379648,
      "e_log_p_tau": -0.14639838889841628,
      "h_nodes": 78990.76625880835,
      "h_bonds": 38.34416113586845,
      "h_tau": -3.791532092797752,
      "tau_mean": 0.14639838889841628,
      "bond_mean_avg": 13.940049850505886,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.990192104490641,
      "train_quality": -0.268543233648596,
      "val_loss": 5.425404175044394,
      "val_quality": -0.43683623027636775,
      "test_quality": -0.4252642125355799,
      "patience_counter": 7,
      "elbo_raw": 72421.58495457357,
      "elbo_relative": 5439712.605578304,
      "e_log_p_nodes": -13563.688041371717,
      "e_log_p_bonds": -4349.7924943243825,
      "e_log_p_tau": -0.14519790871762372,
      "h_nodes": 93765.42408797688,
      "h_bonds": -4.35335004512244,
      "h_tau": -3.7997659899565406,
      "tau_mean": 0.14519790871762372,
      "bond_mean_avg": 13.931111185179784,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.292995030929526,
      "train_quality": -0.3455179463289706,
      "val_loss": 5.851369262168345,
      "val_quality": -0.5496466403888114,
      "test_quality": -0.5330159446237215,
      "patience_counter": 8,
      "elbo_raw": 86708.79765693191,
      "elbo_relative": 5453999.818280662,
      "e_log_p_nodes": -13607.227674860975,
      "e_log_p_bonds": -4732.448964286526,
      "e_log_p_tau": -0.1386997161621244,
      "h_nodes": 108554.36454892156,
      "h_bonds": -46.98777833174954,
      "h_tau": -3.845552408569347,
      "tau_mean": 0.1386997161621244,
      "bond_mean_avg": 13.92079202569364,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.362022608979452,
      "train_quality": -0.36306526018720575,
      "val_loss": 6.026728271368861,
      "val_quality": -0.596087821468672,
      "test_quality": -0.5284504788295152,
      "patience_counter": 9,
      "elbo_raw": 101008.03826162513,
      "elbo_relative": 5468299.0588853555,
      "e_log_p_nodes": -13650.48830744382,
      "e_log_p_bonds": -5114.617742541696,
      "e_log_p_tau": -0.13568031060132626,
      "h_nodes": 123337.42603087588,
      "h_bonds": -89.56512067737567,
      "h_tau": -3.867562228211682,
      "tau_mean": 0.13568031060132626,
      "bond_mean_avg": 13.911626279861272,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.008414407313552,
      "train_quality": -0.2731754759477847,
      "val_loss": 5.454622605826032,
      "val_quality": -0.4445742897064813,
      "test_quality": -0.387315169953107,
      "patience_counter": 10,
      "elbo_raw": 115357.13859410628,
      "elbo_relative": 5482648.159217836,
      "e_log_p_nodes": -13693.548231394845,
      "e_log_p_bonds": -5496.575887155007,
      "e_log_p_tau": -0.14163835319157358,
      "h_nodes": 138123.2031776944,
      "h_bonds": -132.10180292710822,
      "h_tau": -3.8245866890147227,
      "tau_mean": 0.14163835319157358,
      "bond_mean_avg": 13.904058429746915,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.67233987524224,
      "train_quality": -0.18774287841771486,
      "val_loss": 5.2161674389096095,
      "val_quality": -0.3814230456575878,
      "test_quality": -0.3117478808851757,
      "patience_counter": 11,
      "elbo_raw": 129690.6134088012,
      "elbo_relative": 5496981.634032532,
      "e_log_p_nodes": -13736.466948435753,
      "e_log_p_bonds": -5878.411538909544,
      "e_log_p_tau": -0.15082107860187927,
      "h_nodes": 152878.80741733607,
      "h_bonds": -174.61120950541113,
      "h_tau": -3.761769465139878,
      "tau_mean": 0.15082107860187927,
      "bond_mean_avg": 13.897754190828229,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.627400872221191,
      "train_quality": -0.17631905604463127,
      "val_loss": 4.8951946984308,
      "val_quality": -0.2964182704239944,
      "test_quality": -0.2856974146701461,
      "patience_counter": 12,
      "elbo_raw": 143997.19008101485,
      "elbo_relative": 5511288.210704746,
      "e_log_p_nodes": -13779.281108484693,
      "e_log_p_bonds": -6260.277124148963,
      "e_log_p_tau": -0.15478989783480357,
      "h_nodes": 167633.90267481087,
      "h_bonds": -217.11262063311258,
      "h_tau": -3.735794989911483,
      "tau_mean": 0.15478989783480357,
      "bond_mean_avg": 13.892473710584323,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.424822519678709,
      "train_quality": -0.12482216113146927,
      "val_loss": 4.982379425115408,
      "val_quality": -0.31950782651705034,
      "test_quality": -0.24129333619399862,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13822.022606258803,
      "e_log_p_bonds": -6642.136453725165,
      "e_log_p_tau": -0.16113745202347712,
      "h_nodes": 0.0,
      "h_bonds": -259.6133371378239,
      "h_tau": -3.695605949439596,
      "tau_mean": 0.16113745202347712,
      "bond_mean_avg": 13.887589328600933,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}