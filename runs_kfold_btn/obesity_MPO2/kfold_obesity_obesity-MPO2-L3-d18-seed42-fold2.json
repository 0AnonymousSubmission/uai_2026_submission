{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed42-fold2",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 2,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 2,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4002.843382618732,
      "train_quality": -1053.3131699011108,
      "val_loss": 4583.464198991565,
      "val_quality": -1241.2112132088976,
      "patience_counter": 0,
      "elbo_raw": -3054156.4747006698,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145697.51316341065,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.2319062138326449,
      "train_quality": 0.6755269139515863,
      "val_loss": 1.8915879684345642,
      "val_quality": 0.48734152092266025,
      "test_quality": 0.5759688952292515,
      "patience_counter": 0,
      "elbo_raw": -37052.51739142038,
      "elbo_relative": 3017103.9573092493,
      "e_log_p_nodes": -20204.81531280416,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7976894409127935,
      "h_nodes": -14323.959425471066,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0964918428135206,
      "tau_mean": 0.7976894409127935,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0746041552838217,
      "train_quality": 0.7169588702206524,
      "val_loss": 1.6690966034063017,
      "val_quality": 0.5476411668850023,
      "test_quality": 0.6335067346066685,
      "patience_counter": 0,
      "elbo_raw": -36196.0299748975,
      "elbo_relative": 3017960.4447257724,
      "e_log_p_nodes": -19820.02450863953,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8504230540136953,
      "h_nodes": -13898.289535218712,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.032477256456332,
      "tau_mean": 0.8504230540136953,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9355032488508964,
      "train_quality": 0.7535968057027721,
      "val_loss": 1.5877642968674304,
      "val_quality": 0.5696838618406994,
      "test_quality": 0.6507187503583862,
      "patience_counter": 0,
      "elbo_raw": -36002.70867584608,
      "elbo_relative": 3018153.7660248238,
      "e_log_p_nodes": -19747.361297690044,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.943187147494004,
      "h_nodes": -13852.069809140929,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9289464700877943,
      "tau_mean": 0.943187147494004,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8625776914160994,
      "train_quality": 0.772804745728541,
      "val_loss": 1.5160039543478112,
      "val_quality": 0.5891323615499793,
      "test_quality": 0.65528154945657,
      "patience_counter": 0,
      "elbo_raw": -35922.60397933868,
      "elbo_relative": 3018233.870721331,
      "e_log_p_nodes": -19726.712215680927,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0113427621057967,
      "h_nodes": -13842.778382640015,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8591769984204802,
      "tau_mean": 1.0113427621057967,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.824342215841045,
      "train_quality": 0.7828756282495152,
      "val_loss": 1.4602645723791476,
      "val_quality": 0.6042388579231901,
      "test_quality": 0.6557612499054097,
      "patience_counter": 0,
      "elbo_raw": -35880.48479987443,
      "elbo_relative": 3018275.9899007953,
      "e_log_p_nodes": -19718.323130726265,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0533797765873867,
      "h_nodes": -13838.329730932637,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8184520840895857,
      "tau_mean": 1.0533797765873867,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8005084092932764,
      "train_quality": 0.7891532398696202,
      "val_loss": 1.414687107991247,
      "val_quality": 0.6165912697397231,
      "test_quality": 0.6570509491094153,
      "patience_counter": 0,
      "elbo_raw": -30142.5993286668,
      "elbo_relative": 3024013.875372003,
      "e_log_p_nodes": -13579.681083767719,
      "e_log_p_bonds": -997.2155308109488,
      "e_log_p_tau": -1.0814407181879755,
      "h_nodes": -13833.712037510299,
      "h_bonds": 252.68110100845792,
      "h_tau": -1.7921617632728157,
      "tau_mean": 1.0814407181879755,
      "bond_mean_avg": 8.8411062443993,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.2801397539486596,
      "train_quality": 0.3994315685090776,
      "val_loss": 2.9168290416342724,
      "val_quality": 0.20948051839727644,
      "test_quality": 0.3378132654663346,
      "patience_counter": 1,
      "elbo_raw": -14612.38499551567,
      "elbo_relative": 3039544.0897051543,
      "e_log_p_nodes": -13352.374648220786,
      "e_log_p_bonds": -1775.1067504974321,
      "e_log_p_tau": -0.4028848718421605,
      "h_nodes": 2967.8591044989403,
      "h_bonds": 241.84867671930147,
      "h_tau": -2.7795603494059833,
      "tau_mean": 0.4028848718421605,
      "bond_mean_avg": 12.191862662062082,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.532314195380618,
      "train_quality": -0.9839442358665191,
      "val_loss": 8.464896709961518,
      "val_quality": -1.2941576840684843,
      "test_quality": -0.841575246411655,
      "patience_counter": 2,
      "elbo_raw": 2.9103854319328093,
      "elbo_relative": 3054159.3850861015,
      "e_log_p_nodes": -13345.77914183025,
      "e_log_p_bonds": -2343.859319739998,
      "e_log_p_tau": -0.12155010154066903,
      "h_nodes": 19040.688228562798,
      "h_bonds": 208.06741548881715,
      "h_tau": -3.9778846565841377,
      "tau_mean": 0.12155010154066903,
      "bond_mean_avg": 13.508377777265727,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.360266966720873,
      "train_quality": -0.9386285335813385,
      "val_loss": 8.316753284135341,
      "val_quality": -1.254007828689458,
      "test_quality": -0.7469788347642186,
      "patience_counter": 3,
      "elbo_raw": 14690.08605555454,
      "elbo_relative": 3068846.560756224,
      "e_log_p_nodes": -13383.765974181872,
      "e_log_p_bonds": -2787.4383730112827,
      "e_log_p_tau": -0.1023009401400034,
      "h_nodes": 34374.10940451375,
      "h_bonds": 167.34853303469814,
      "h_tau": -4.150292329783042,
      "tau_mean": 0.1023009401400034,
      "bond_mean_avg": 13.882925066308246,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.275505050464929,
      "train_quality": -0.38952087826784165,
      "val_loss": 6.041473756774488,
      "val_quality": -0.6373612008628153,
      "test_quality": -0.29278319818064924,
      "patience_counter": 4,
      "elbo_raw": 29152.655426148078,
      "elbo_relative": 3083309.1301268176,
      "e_log_p_nodes": -13428.096057053785,
      "e_log_p_bonds": -3190.8177010736536,
      "e_log_p_tau": -0.12296933613969122,
      "h_nodes": 49194.19508835723,
      "h_bonds": 125.23395733080247,
      "h_tau": -3.966276168112927,
      "tau_mean": 0.12296933613969122,
      "bond_mean_avg": 13.994031928028246,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 4.8253386566779355,
      "train_quality": -0.27095107369407034,
      "val_loss": 5.5586534708213815,
      "val_quality": -0.5065071683806519,
      "test_quality": -0.1817829058700926,
      "patience_counter": 5,
      "elbo_raw": 43326.22435002536,
      "elbo_relative": 3097482.699050695,
      "e_log_p_nodes": -13472.76219996498,
      "e_log_p_bonds": -3578.6335445513955,
      "e_log_p_tau": -0.13906476844551005,
      "h_nodes": 63754.19037969406,
      "h_bonds": 82.84979903923337,
      "h_tau": -3.843271408082728,
      "tau_mean": 0.13906476844551005,
      "bond_mean_avg": 14.016525608251746,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.0965199028022665,
      "train_quality": -0.3423777901278342,
      "val_loss": 5.94636567341555,
      "val_quality": -0.6115849926312178,
      "test_quality": -0.28258770179211856,
      "patience_counter": 6,
      "elbo_raw": 57437.888111648484,
      "elbo_relative": 3111594.3628123184,
      "e_log_p_nodes": -13516.798554866047,
      "e_log_p_bonds": -3960.814660719975,
      "e_log_p_tau": -0.13938076319268525,
      "h_nodes": 78332.79727399696,
      "h_bonds": 40.4921069799492,
      "h_tau": -3.8410017011065065,
      "tau_mean": 0.13938076319268525,
      "bond_mean_avg": 14.013641684670867,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 5.125623647836404,
      "train_quality": -0.3500434564429775,
      "val_loss": 5.850198685313759,
      "val_quality": -0.5855217998638662,
      "test_quality": -0.2679828230624277,
      "patience_counter": 7,
      "elbo_raw": 71545.11478376682,
      "elbo_relative": 3125701.5894844364,
      "e_log_p_nodes": -13560.282178906746,
      "e_log_p_bonds": -4340.58190180123,
      "e_log_p_tau": -0.13863104501281714,
      "h_nodes": 92909.40803617398,
      "h_bonds": -1.763410063688383,
      "h_tau": -3.846395141062203,
      "tau_mean": 0.13863104501281714,
      "bond_mean_avg": 14.004737443811942,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.592912244309211,
      "train_quality": -0.47312309616737136,
      "val_loss": 6.513077728149616,
      "val_quality": -0.7651753859425034,
      "test_quality": -0.39703287443024204,
      "patience_counter": 8,
      "elbo_raw": 85644.86237013577,
      "elbo_relative": 3139801.3370708055,
      "e_log_p_nodes": -13603.379543811618,
      "e_log_p_bonds": -4719.339437014077,
      "e_log_p_tau": -0.1302450612561397,
      "h_nodes": 107518.08130033326,
      "h_bonds": -43.97015370495308,
      "h_tau": -3.9087934302324356,
      "tau_mean": 0.1302450612561397,
      "bond_mean_avg": 13.994146092757713,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.44998186206322,
      "train_quality": -0.4354765109836256,
      "val_loss": 6.133695884203447,
      "val_quality": -0.662355256848556,
      "test_quality": -0.33641012201876497,
      "patience_counter": 9,
      "elbo_raw": 99772.24245071012,
      "elbo_relative": 3153928.7171513797,
      "e_log_p_nodes": -13646.21152694801,
      "e_log_p_bonds": -5097.6461510731,
      "e_log_p_tau": -0.13007299609132414,
      "h_nodes": 122109.69218284426,
      "h_bonds": -86.11110738338941,
      "h_tau": -3.9101153914643874,
      "tau_mean": 0.13007299609132414,
      "bond_mean_avg": 13.985256335384042,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.559210198510248,
      "train_quality": -0.46424627853000167,
      "val_loss": 6.481201392514291,
      "val_quality": -0.7565362562704698,
      "test_quality": -0.39390327702698924,
      "patience_counter": 10,
      "elbo_raw": 113886.67614374193,
      "elbo_relative": 3168043.150844412,
      "e_log_p_nodes": -13688.852130154088,
      "e_log_p_bonds": -5475.6277054469865,
      "e_log_p_tau": -0.12844473969473993,
      "h_nodes": 136695.90283309016,
      "h_bonds": -128.2093646743249,
      "h_tau": -3.9227124221724807,
      "tau_mean": 0.12844473969473993,
      "bond_mean_avg": 13.977443445974023,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 5.279867914302233,
      "train_quality": -0.39067001760767406,
      "val_loss": 6.05434994811257,
      "val_quality": -0.6408509083349732,
      "test_quality": -0.30025949838965826,
      "patience_counter": 11,
      "elbo_raw": 128011.65091298899,
      "elbo_relative": 3182168.1256136587,
      "e_log_p_nodes": -13731.343353005033,
      "e_log_p_bonds": -5853.484965303819,
      "e_log_p_tau": -0.13247548805420944,
      "h_nodes": 151261.07291502252,
      "h_bonds": -170.27190796691838,
      "h_tau": -3.891813560232549,
      "tau_mean": 0.13247548805420944,
      "bond_mean_avg": 13.971262066875113,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 5.5020498860660165,
      "train_quality": -0.4491907631263017,
      "val_loss": 6.3232528483858195,
      "val_quality": -0.7137290161332879,
      "test_quality": -0.37572353082582977,
      "patience_counter": 12,
      "elbo_raw": 142104.1046545835,
      "elbo_relative": 3196260.5793552534,
      "e_log_p_nodes": -13773.729991364376,
      "e_log_p_bonds": -6231.306463056649,
      "e_log_p_tau": -0.1299508037238952,
      "h_nodes": 165829.62157466426,
      "h_bonds": -212.3241405982476,
      "h_tau": -3.9110552467891466,
      "tau_mean": 0.1299508037238952,
      "bond_mean_avg": 13.965869071358034,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 5.689048729595368,
      "train_quality": -0.4984445871318488,
      "val_loss": 6.549946517617531,
      "val_quality": -0.7751675712648103,
      "test_quality": -0.39585121387590205,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13816.040547828861,
      "e_log_p_bonds": -6609.175282970922,
      "e_log_p_tau": -0.12610607541191052,
      "h_nodes": 0.0,
      "h_bonds": -254.3877414347314,
      "h_tau": -3.941087771599996,
      "tau_mean": 0.12610607541191052,
      "bond_mean_avg": 13.9605899517253,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}