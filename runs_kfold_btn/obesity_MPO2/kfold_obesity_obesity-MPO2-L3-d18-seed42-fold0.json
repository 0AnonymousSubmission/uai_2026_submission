{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed42-fold0",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 0,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 0,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1435,
    "n_val": 253,
    "n_test": 423,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 3623.2769592731875,
      "train_quality": -940.102618773223,
      "val_loss": 3554.847596251122,
      "val_quality": -961.6283539294941,
      "patience_counter": 0,
      "elbo_raw": -2779668.2672256776,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145697.51316341065,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.264974596453192,
      "train_quality": 0.6714380604118921,
      "val_loss": 1.7507895127923903,
      "val_quality": 0.5258982048755876,
      "test_quality": 0.5572663353717056,
      "patience_counter": 0,
      "elbo_raw": -37068.33079846555,
      "elbo_relative": 2742599.936427212,
      "e_log_p_nodes": -20200.569655934403,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7772456067675676,
      "h_nodes": -14326.896507903753,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.122107292826513,
      "tau_mean": 0.7772456067675676,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.0974062660599042,
      "train_quality": 0.7149619191533486,
      "val_loss": 1.7218515714287173,
      "val_quality": 0.5337344009731073,
      "test_quality": 0.6040234295858742,
      "patience_counter": 0,
      "elbo_raw": -36187.649778290914,
      "elbo_relative": 2743480.6174473865,
      "e_log_p_nodes": -19798.59238133015,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.8307883329244261,
      "h_nodes": -13896.05811755772,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.0554886407508093,
      "tau_mean": 0.8307883329244261,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 0.9442885313872417,
      "train_quality": 0.7547324094307388,
      "val_loss": 1.6880291148221205,
      "val_quality": 0.5428932903059146,
      "test_quality": 0.6325056047805329,
      "patience_counter": 0,
      "elbo_raw": -35987.39069872248,
      "elbo_relative": 2743680.876526955,
      "e_log_p_nodes": -19731.143188779188,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9297731346912369,
      "h_nodes": -13844.12655080642,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.942923074276223,
      "tau_mean": 0.9297731346912369,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.8627549686381557,
      "train_quality": 0.7759097718801353,
      "val_loss": 1.6361104207934407,
      "val_quality": 0.5569525166490364,
      "test_quality": 0.6529850726159189,
      "patience_counter": 0,
      "elbo_raw": -35906.33209655128,
      "elbo_relative": 2743761.9351291265,
      "e_log_p_nodes": -19712.815490774105,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0056034207278775,
      "h_nodes": -13837.72785639036,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.864520630523657,
      "tau_mean": 1.0056034207278775,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.8173263978240659,
      "train_quality": 0.7877092968518176,
      "val_loss": 1.587649931767565,
      "val_quality": 0.5700752847898684,
      "test_quality": 0.6673758005659989,
      "patience_counter": 0,
      "elbo_raw": -35863.201453773305,
      "elbo_relative": 2743805.0657719043,
      "e_log_p_nodes": -19705.67021622136,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0565952782574972,
      "h_nodes": -13837.28253339612,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.8150566735603206,
      "tau_mean": 1.0565952782574972,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.7864558848231332,
      "train_quality": 0.7957275413731744,
      "val_loss": 1.547469670308221,
      "val_quality": 0.5809558240821449,
      "test_quality": 0.676950077624519,
      "patience_counter": 0,
      "elbo_raw": -30136.06394592736,
      "elbo_relative": 2749532.2032797504,
      "e_log_p_nodes": -13576.795684733457,
      "e_log_p_bonds": -1000.4222630670681,
      "e_log_p_tau": -1.0947253003167472,
      "h_nodes": -13837.57629172114,
      "h_bonds": 253.24980404055918,
      "h_tau": -1.779604945984829,
      "tau_mean": 1.0947253003167472,
      "bond_mean_avg": 8.885113587536567,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.4289825647142296,
      "train_quality": 0.3691009883314008,
      "val_loss": 3.2485348070544697,
      "val_quality": 0.12031904903734059,
      "test_quality": 0.30056944216231396,
      "patience_counter": 1,
      "elbo_raw": -14705.095945731991,
      "elbo_relative": 2764963.1712799454,
      "e_log_p_nodes": -13350.157787745622,
      "e_log_p_bonds": -1776.3589057596864,
      "e_log_p_tau": -0.37986754566225595,
      "h_nodes": 2914.018397403638,
      "h_bonds": 242.40809234166554,
      "h_tau": -2.8380410615609435,
      "tau_mean": 0.37986754566225595,
      "bond_mean_avg": 12.225720680529605,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.275535746497384,
      "train_quality": -0.889732918838301,
      "val_loss": 8.01412589368614,
      "val_quality": -1.1701703401739438,
      "test_quality": -0.8506977811924912,
      "patience_counter": 2,
      "elbo_raw": -49.275858632932795,
      "elbo_relative": 2779618.991367045,
      "e_log_p_nodes": -13344.923477338154,
      "e_log_p_bonds": -2341.3082987785656,
      "e_log_p_tau": -0.12474569696668089,
      "h_nodes": 18963.55978938312,
      "h_bonds": 208.4842264949417,
      "h_tau": -3.951586448688431,
      "tau_mean": 0.12474569696668089,
      "bond_mean_avg": 13.515747628509441,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 7.325588105022627,
      "train_quality": -0.9027334170650032,
      "val_loss": 8.312297776857838,
      "val_quality": -1.2509132416103728,
      "test_quality": -0.9188385148063174,
      "patience_counter": 3,
      "elbo_raw": 14610.18276973471,
      "elbo_relative": 2794278.4499954125,
      "e_log_p_nodes": -13383.151311759839,
      "e_log_p_bonds": -2784.4659098030884,
      "e_log_p_tau": -0.10329248532712122,
      "h_nodes": 34280.753442934554,
      "h_bonds": 167.7249706988879,
      "h_tau": -4.140299062099984,
      "tau_mean": 0.10329248532712122,
      "bond_mean_avg": 13.885928513002947,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.669612764397507,
      "train_quality": -0.4726137361232523,
      "val_loss": 6.428483602979889,
      "val_quality": -0.7407892803970784,
      "test_quality": -0.45414439773723525,
      "patience_counter": 4,
      "elbo_raw": 28996.519142489567,
      "elbo_relative": 2808664.786368167,
      "e_log_p_nodes": -13427.618497295776,
      "e_log_p_bonds": -3187.6825171272862,
      "e_log_p_tau": -0.1174615521717969,
      "h_nodes": 49064.546328231176,
      "h_bonds": 125.59140477546343,
      "h_tau": -4.0117526249941875,
      "tau_mean": 0.1174615521717969,
      "bond_mean_avg": 13.995114601021209,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 5.031601370901311,
      "train_quality": -0.30689794901244105,
      "val_loss": 5.827524082831806,
      "val_quality": -0.5780535630435455,
      "test_quality": -0.34183838523174104,
      "patience_counter": 5,
      "elbo_raw": 43190.00599528196,
      "elbo_relative": 2822858.2732209596,
      "e_log_p_nodes": -13472.322445682375,
      "e_log_p_bonds": -3575.498886066106,
      "e_log_p_tau": -0.13310875589727467,
      "h_nodes": 63643.084384070164,
      "h_bonds": 83.20829075962111,
      "h_tau": -3.8866971818833917,
      "tau_mean": 0.13310875589727467,
      "bond_mean_avg": 14.017517704284066,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 4.94871456032552,
      "train_quality": -0.28536909671342037,
      "val_loss": 5.65993897470421,
      "val_quality": -0.5326726648722451,
      "test_quality": -0.2721134397451055,
      "patience_counter": 6,
      "elbo_raw": 57330.51868457331,
      "elbo_relative": 2836998.785910251,
      "e_log_p_nodes": -13516.377925113613,
      "e_log_p_bonds": -3957.602256368837,
      "e_log_p_tau": -0.14028469201010266,
      "h_nodes": 78214.37926080449,
      "h_bonds": 40.858373420404845,
      "h_tau": -3.8341898172966467,
      "tau_mean": 0.14028469201010266,
      "bond_mean_avg": 14.014487021133917,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 4.844167323212693,
      "train_quality": -0.2582142090969566,
      "val_loss": 5.622411402365307,
      "val_quality": -0.522510455604634,
      "test_quality": -0.27317345084665434,
      "patience_counter": 7,
      "elbo_raw": 71448.583306196,
      "elbo_relative": 2851116.8505318738,
      "e_log_p_nodes": -13559.866655752761,
      "e_log_p_bonds": -4337.288362759784,
      "e_log_p_tau": -0.14481362587316227,
      "h_nodes": 92775.03477881457,
      "h_bonds": -1.3869449931457893,
      "h_tau": -3.8024161126140825,
      "tau_mean": 0.14481362587316227,
      "bond_mean_avg": 14.005555132230148,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 4.543603492791032,
      "train_quality": -0.18014636854880361,
      "val_loss": 5.348226171603429,
      "val_quality": -0.448262975167377,
      "test_quality": -0.19700181372154968,
      "patience_counter": 8,
      "elbo_raw": 85616.02732459108,
      "elbo_relative": 2865284.294550269,
      "e_log_p_nodes": -13602.962440640156,
      "e_log_p_bonds": -4715.8909916001085,
      "e_log_p_tau": -0.15292045388647765,
      "h_nodes": 107367.22673777772,
      "h_bonds": -43.5739499460925,
      "h_tau": -3.7479458125180827,
      "tau_mean": 0.15292045388647765,
      "bond_mean_avg": 13.995017193677663,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 4.530892745699057,
      "train_quality": -0.1768449048436329,
      "val_loss": 5.246165178837679,
      "val_quality": -0.420625558145586,
      "test_quality": -0.20463985093636206,
      "patience_counter": 9,
      "elbo_raw": 99728.32290821956,
      "elbo_relative": 2879396.590133897,
      "e_log_p_nodes": -13645.790289664685,
      "e_log_p_bonds": -5094.0380731312125,
      "e_log_p_tau": -0.15583945225618884,
      "h_nodes": 121929.04410625261,
      "h_bonds": -85.70648514595435,
      "h_tau": -3.7290373643672865,
      "tau_mean": 0.15583945225618884,
      "bond_mean_avg": 13.985644040264024,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 4.29188797492784,
      "train_quality": -0.11476628976663195,
      "val_loss": 4.982164639194466,
      "val_quality": -0.34913602222813944,
      "test_quality": -0.15049590720310824,
      "patience_counter": 10,
      "elbo_raw": 113875.82679295538,
      "elbo_relative": 2893544.094018633,
      "e_log_p_nodes": -13688.433127823098,
      "e_log_p_bonds": -5472.067142395443,
      "e_log_p_tau": -0.1626921297681048,
      "h_nodes": 136508.41254521342,
      "h_bonds": -127.81814182607953,
      "h_tau": -3.686004049078292,
      "tau_mean": 0.1626921297681048,
      "bond_mean_avg": 13.977412663439017,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 4.330809548306054,
      "train_quality": -0.12487570040367002,
      "val_loss": 5.075365402234796,
      "val_quality": -0.3743741497937485,
      "test_quality": -0.16399635727673845,
      "patience_counter": 11,
      "elbo_raw": 127987.09425232044,
      "elbo_relative": 2907655.361477998,
      "e_log_p_nodes": -13730.943577602724,
      "e_log_p_bonds": -5850.084114956739,
      "e_log_p_tau": -0.16401543847303754,
      "h_nodes": 151076.4711522656,
      "h_bonds": -169.90271223294863,
      "h_tau": -3.6779031290479907,
      "tau_mean": 0.16401543847303754,
      "bond_mean_avg": 13.970997783783663,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 4.089866352009872,
      "train_quality": -0.062293602606924736,
      "val_loss": 4.79585961209347,
      "val_quality": -0.29868589835893244,
      "test_quality": -0.10792655526458717,
      "patience_counter": 12,
      "elbo_raw": 142122.34445857684,
      "elbo_relative": 2921790.6116842544,
      "e_log_p_nodes": -13773.352559715826,
      "e_log_p_bonds": -6228.070138564305,
      "e_log_p_tau": -0.17102701503182793,
      "h_nodes": 165644.10838574465,
      "h_bonds": -211.97162888086743,
      "h_tau": -3.636042162805097,
      "tau_mean": 0.17102701503182793,
      "bond_mean_avg": 13.965650417809789,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 4.079412191497786,
      "train_quality": -0.059578260129497185,
      "val_loss": 4.764892351523689,
      "val_quality": -0.2903001765351807,
      "test_quality": -0.08569079842820959,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.680948172767,
      "e_log_p_bonds": -6606.027590984209,
      "e_log_p_tau": -0.17410354600787173,
      "h_nodes": 0.0,
      "h_bonds": -254.06365026677338,
      "h_tau": -3.6182134752552884,
      "tau_mean": 0.17410354600787173,
      "bond_mean_avg": 13.95948858307593,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}