{
  "experiment_name": "kfold_obesity",
  "run_name": "obesity-MPO2-L3-d18-seed9536-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 3,
    "dataset": "obesity",
    "n_features": 39,
    "n_train": 1436,
    "n_val": 253,
    "n_test": 422,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 4102.719862090358,
      "train_quality": -1057.1093534552424,
      "val_loss": 4933.5047346853335,
      "val_quality": -1354.6537874770256,
      "patience_counter": 0,
      "elbo_raw": -3125962.3109058947,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -145672.90423734512,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -1.0,
      "h_nodes": -9213.688347806241,
      "h_bonds": 329.49822296297384,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 1,
      "train_loss": 1.3397325758048977,
      "train_quality": 0.6544771231673663,
      "val_loss": 1.62345780495087,
      "val_quality": 0.5538979203531343,
      "test_quality": 0.5253609236631942,
      "patience_counter": 0,
      "elbo_raw": -37078.16145843002,
      "elbo_relative": 3088884.149447465,
      "e_log_p_nodes": -20186.00820546188,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.7337522148987945,
      "h_nodes": -14308.339533552265,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.1800398029881762,
      "tau_mean": 0.7337522148987945,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 2,
      "train_loss": 1.185144176386604,
      "train_quality": 0.6943461458787612,
      "val_loss": 1.484867440705927,
      "val_quality": 0.591980492946117,
      "test_quality": 0.5968124667767696,
      "patience_counter": 0,
      "elbo_raw": -36233.386729737205,
      "elbo_relative": 3089728.9241761575,
      "e_log_p_nodes": -19786.173051526734,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.772853846825866,
      "h_nodes": -13900.729709394154,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.128121234687569,
      "tau_mean": 0.772853846825866,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 3,
      "train_loss": 1.0376949585720763,
      "train_quality": 0.732373942504807,
      "val_loss": 1.3876203215039837,
      "val_quality": 0.6187025561764369,
      "test_quality": 0.630746816595442,
      "patience_counter": 0,
      "elbo_raw": -36028.234409214114,
      "elbo_relative": 3089934.0764966807,
      "e_log_p_nodes": -19708.252863450554,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.851523614509704,
      "h_nodes": -13843.19541296442,
      "h_bonds": 329.49822296297384,
      "h_tau": -2.031183960173621,
      "tau_mean": 0.851523614509704,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 4,
      "train_loss": 0.9552407539697056,
      "train_quality": 0.7536392416366441,
      "val_loss": 1.3085819211887142,
      "val_quality": 0.6404211340446619,
      "test_quality": 0.650983026002087,
      "patience_counter": 0,
      "elbo_raw": -35939.2938027952,
      "elbo_relative": 3090023.0171030997,
      "e_log_p_nodes": -19685.7960227075,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9128798714460005,
      "h_nodes": -13826.737324816184,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.9616068964242004,
      "tau_mean": 0.9128798714460005,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 5,
      "train_loss": 0.9082168520702733,
      "train_quality": 0.7657669111115958,
      "val_loss": 1.2570658708933358,
      "val_quality": 0.6545769791192164,
      "test_quality": 0.6648021065379439,
      "patience_counter": 0,
      "elbo_raw": -35892.11669226883,
      "elbo_relative": 3090070.194213626,
      "e_log_p_nodes": -19678.26949117686,
      "e_log_p_bonds": -649.7555750218762,
      "e_log_p_tau": -0.9546811207066594,
      "h_nodes": -13819.27860600102,
      "h_bonds": 329.49822296297384,
      "h_tau": -1.916833813024823,
      "tau_mean": 0.9546811207066594,
      "bond_mean_avg": 5.0,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 6,
      "train_loss": 0.8765341124072179,
      "train_quality": 0.7739380279090965,
      "val_loss": 1.2247768885608514,
      "val_quality": 0.6634495116385559,
      "test_quality": 0.675099162374678,
      "patience_counter": 0,
      "elbo_raw": -30190.098661262607,
      "elbo_relative": 3095772.212244632,
      "e_log_p_nodes": -13577.740348193183,
      "e_log_p_bonds": -999.4700844375478,
      "e_log_p_tau": -0.9857411578054205,
      "h_nodes": -13814.67396572451,
      "h_bonds": 253.07693422169797,
      "h_tau": -1.8848173900278198,
      "tau_mean": 0.9857411578054205,
      "bond_mean_avg": 8.871339545633237,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 7,
      "train_loss": 2.796669691118297,
      "train_quality": 0.278726684207648,
      "val_loss": 3.20629628519096,
      "val_quality": 0.1189574275193479,
      "test_quality": 0.16909425672041256,
      "patience_counter": 1,
      "elbo_raw": -14745.48045586611,
      "elbo_relative": 3111216.8304500286,
      "e_log_p_nodes": -13350.901638785403,
      "e_log_p_bonds": -1776.094465589748,
      "e_log_p_tau": -0.33111336474524095,
      "h_nodes": 2974.7498153833326,
      "h_bonds": 242.43808623489429,
      "h_tau": -2.9757503843102313,
      "tau_mean": 0.33111336474524095,
      "bond_mean_avg": 12.225722845307654,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 8,
      "train_loss": 7.826586729993184,
      "train_quality": -1.018510866694919,
      "val_loss": 8.710636619411032,
      "val_quality": -1.3935534998921635,
      "test_quality": -1.1321203295006264,
      "patience_counter": 2,
      "elbo_raw": -45.62863673323591,
      "elbo_relative": 3125916.6822691616,
      "e_log_p_nodes": -13345.06369093764,
      "e_log_p_bonds": -2340.4347025797547,
      "e_log_p_tau": -0.11527339039070568,
      "h_nodes": 19025.76620612505,
      "h_bonds": 208.43148286428055,
      "h_tau": -4.030904577944966,
      "tau_mean": 0.11527339039070568,
      "bond_mean_avg": 13.50880245948819,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 9,
      "train_loss": 6.778939450230939,
      "train_quality": -0.7483180621407293,
      "val_loss": 7.620511037937991,
      "val_quality": -1.094003189752696,
      "test_quality": -0.822297509573868,
      "patience_counter": 3,
      "elbo_raw": 14641.846647201874,
      "elbo_relative": 3140604.157553097,
      "e_log_p_nodes": -13383.190404366196,
      "e_log_p_bonds": -2784.063581542288,
      "e_log_p_tau": -0.10732238490980907,
      "h_nodes": 34287.06513292448,
      "h_bonds": 167.7498431643566,
      "h_tau": -4.102373945000181,
      "tau_mean": 0.10732238490980907,
      "bond_mean_avg": 13.885008998305304,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 10,
      "train_loss": 5.3974144547188905,
      "train_quality": -0.39201673791658065,
      "val_loss": 5.9764752797204315,
      "val_quality": -0.642246594343763,
      "test_quality": -0.4944698926837954,
      "patience_counter": 4,
      "elbo_raw": 28995.380595900162,
      "elbo_relative": 3154957.691501795,
      "e_log_p_nodes": -13427.581316510561,
      "e_log_p_bonds": -3187.243048135028,
      "e_log_p_tau": -0.12311989746682767,
      "h_nodes": 49031.53842360536,
      "h_bonds": 125.64675675204536,
      "h_tau": -3.965052535988434,
      "tau_mean": 0.12311989746682767,
      "bond_mean_avg": 13.995417264241237,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 11,
      "train_loss": 5.016552027273928,
      "train_quality": -0.2937906560963477,
      "val_loss": 5.586165017284933,
      "val_quality": -0.5349951343741834,
      "test_quality": -0.35993150355039094,
      "patience_counter": 5,
      "elbo_raw": 43174.02043448783,
      "elbo_relative": 3169136.3313403823,
      "e_log_p_nodes": -13472.269603060913,
      "e_log_p_bonds": -3574.933424293457,
      "e_log_p_tau": -0.13552954752765178,
      "h_nodes": 63615.89139510495,
      "h_bonds": 83.2665484949107,
      "h_tau": -3.8690215132455705,
      "tau_mean": 0.13552954752765178,
      "bond_mean_avg": 14.017303927649365,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 12,
      "train_loss": 5.065200647153733,
      "train_quality": -0.3063373474274207,
      "val_loss": 5.732616052100408,
      "val_quality": -0.5752377024276203,
      "test_quality": -0.4141308809121196,
      "patience_counter": 6,
      "elbo_raw": 57301.176013833574,
      "elbo_relative": 3183263.486919728,
      "e_log_p_nodes": -13516.318887194464,
      "e_log_p_bonds": -3957.0244912713706,
      "e_log_p_tau": -0.1388094596400402,
      "h_nodes": 78194.34216207654,
      "h_bonds": 40.91787758622661,
      "h_tau": -3.8451089939508165,
      "tau_mean": 0.1388094596400402,
      "bond_mean_avg": 14.014265141744215,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 13,
      "train_loss": 5.323005752551597,
      "train_quality": -0.37282640896695485,
      "val_loss": 6.046986047371903,
      "val_quality": -0.6616219054795955,
      "test_quality": -0.47331704049613443,
      "patience_counter": 7,
      "elbo_raw": 71424.06787223482,
      "elbo_relative": 3197386.3787781294,
      "e_log_p_nodes": -13559.819237348487,
      "e_log_p_bonds": -4336.922053415357,
      "e_log_p_tau": -0.13487714865785108,
      "h_nodes": 92803.57575518146,
      "h_bonds": -1.363295842025849,
      "h_tau": -3.8738468385417946,
      "tau_mean": 0.13487714865785108,
      "bond_mean_avg": 14.004756138493306,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 14,
      "train_loss": 5.195574312138487,
      "train_quality": -0.33996128447447105,
      "val_loss": 5.939971036017871,
      "val_quality": -0.6322157706401923,
      "test_quality": -0.44906937074627473,
      "patience_counter": 8,
      "elbo_raw": 85562.48104682626,
      "elbo_relative": 3211524.791952721,
      "e_log_p_nodes": -13602.939961625181,
      "e_log_p_bonds": -4715.760203408769,
      "e_log_p_tau": -0.1360090381033415,
      "h_nodes": 107400.14342184711,
      "h_bonds": -43.56763684305572,
      "h_tau": -3.8654898525574026,
      "tau_mean": 0.1360090381033415,
      "bond_mean_avg": 13.994624489900275,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 15,
      "train_loss": 5.345260880447213,
      "train_quality": -0.378566103554997,
      "val_loss": 6.125994000675918,
      "val_quality": -0.6833321169615809,
      "test_quality": -0.48975174748729633,
      "patience_counter": 9,
      "elbo_raw": 99688.68431618484,
      "elbo_relative": 3225650.9952220796,
      "e_log_p_nodes": -13645.794585585225,
      "e_log_p_bonds": -5094.208931726149,
      "e_log_p_tau": -0.13366189314600646,
      "h_nodes": 122002.3361388374,
      "h_bonds": -85.73705670493487,
      "h_tau": -3.8828977668517837,
      "tau_mean": 0.13366189314600646,
      "bond_mean_avg": 13.985095027038179,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 16,
      "train_loss": 5.296993775134662,
      "train_quality": -0.36611780649544645,
      "val_loss": 5.958474321256649,
      "val_quality": -0.6373001984584858,
      "test_quality": -0.4706935977385862,
      "patience_counter": 10,
      "elbo_raw": 113804.96918661453,
      "elbo_relative": 3239767.2800925095,
      "e_log_p_nodes": -13688.463245612571,
      "e_log_p_bonds": -5472.406972957709,
      "e_log_p_tau": -0.13381159309741833,
      "h_nodes": 136580.80092208952,
      "h_bonds": -127.8552206392988,
      "h_tau": -3.881778403813769,
      "tau_mean": 0.13381159309741833,
      "bond_mean_avg": 13.977432430024257,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 17,
      "train_loss": 5.503608505108962,
      "train_quality": -0.4194046468589625,
      "val_loss": 6.255109029798086,
      "val_quality": -0.7188110082696355,
      "test_quality": -0.5407099726613407,
      "patience_counter": 11,
      "elbo_raw": 127907.31506640775,
      "elbo_relative": 3253869.6259723026,
      "e_log_p_nodes": -13730.988592798387,
      "e_log_p_bonds": -5850.546164367823,
      "e_log_p_tau": -0.1303644658109695,
      "h_nodes": 151164.67697452073,
      "h_bonds": -169.95623061271303,
      "h_tau": -3.9078770818196062,
      "tau_mean": 0.1303644658109695,
      "bond_mean_avg": 13.97088744850494,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 18,
      "train_loss": 5.0831767497310425,
      "train_quality": -0.31097346271559223,
      "val_loss": 5.806937135732101,
      "val_quality": -0.5956600317721827,
      "test_quality": -0.4020384915926729,
      "patience_counter": 12,
      "elbo_raw": 142061.8835129305,
      "elbo_relative": 3268024.194418825,
      "e_log_p_nodes": -13773.40774829578,
      "e_log_p_bonds": -6228.617160497721,
      "e_log_p_tau": -0.13667499824910706,
      "h_nodes": 165747.81627916472,
      "h_bonds": -212.02537093711058,
      "h_tau": -3.8606053607572903,
      "tau_mean": 0.13667499824910706,
      "bond_mean_avg": 13.965968685405915,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    },
    {
      "step": 19,
      "train_loss": 5.170863469481492,
      "train_quality": -0.3335882503346732,
      "val_loss": 5.948701891971953,
      "val_quality": -0.6346148801127856,
      "test_quality": -0.43688297414159605,
      "patience_counter": 13,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -13815.743384227722,
      "e_log_p_bonds": -6606.690025088193,
      "e_log_p_tau": -0.13710194669293674,
      "h_nodes": 0.0,
      "h_bonds": -254.09680232164638,
      "h_tau": -3.857486407187025,
      "tau_mean": 0.13710194669293674,
      "bond_mean_avg": 13.961356979225751,
      "n_parameters": 14040,
      "dim_x0": 39,
      "dim_b0": 18,
      "dim_x1": 39,
      "dim_b1": 18,
      "dim_x2": 39
    }
  ],
  "summary": {}
}