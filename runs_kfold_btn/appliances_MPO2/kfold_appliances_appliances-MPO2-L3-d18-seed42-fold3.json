{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed42-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 3,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 66594.59787899871,
      "train_quality": -5.382635144253295,
      "val_loss": 68890.33837351981,
      "val_quality": -5.119881400408474,
      "patience_counter": 0,
      "elbo_raw": -450277108.2334874,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -106009.08764639017,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3673.0794712678326,
      "train_quality": 0.6479605423318779,
      "val_loss": 6757.43832464516,
      "val_quality": 0.39970216297704664,
      "test_quality": 0.38918157316721336,
      "patience_counter": 0,
      "elbo_raw": -2356017.5246985,
      "elbo_relative": 447921090.70878893,
      "e_log_p_nodes": -2261860.287458431,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0002722916829157935,
      "h_nodes": -19771.255169337262,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.195499466004549,
      "tau_mean": 0.0002722916829157935,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7604.702487444903,
      "train_quality": 0.271141460360657,
      "val_loss": 8875.68273078915,
      "val_quality": 0.21152766929996514,
      "test_quality": 0.21220616213032206,
      "patience_counter": 1,
      "elbo_raw": -107369.16119377503,
      "elbo_relative": 450169739.07229364,
      "e_log_p_nodes": -17481.872374233448,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013150833677278098,
      "h_nodes": -10617.012538951662,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.923303074268915,
      "tau_mean": 0.00013150833677278098,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8030.572871978466,
      "train_quality": 0.230324706903275,
      "val_loss": 9144.560001884256,
      "val_quality": 0.18764192495297527,
      "test_quality": 0.19491560648138884,
      "patience_counter": 2,
      "elbo_raw": -104998.85335004758,
      "elbo_relative": 450172109.3801374,
      "e_log_p_nodes": -15697.993102356764,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001242305183398728,
      "h_nodes": -9648.523129462406,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.980234462753288,
      "tau_mean": 0.0001242305183398728,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8019.391898468351,
      "train_quality": 0.23139632647521524,
      "val_loss": 9096.878254705496,
      "val_quality": 0.19187773863291557,
      "test_quality": 0.2008909419437862,
      "patience_counter": 3,
      "elbo_raw": -104756.88274907842,
      "elbo_relative": 450172351.35073835,
      "e_log_p_nodes": -15541.91867194527,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012432483567332385,
      "h_nodes": -9567.721467828967,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.979475538544648,
      "tau_mean": 0.00012432483567332385,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8003.502960715592,
      "train_quality": 0.23291917210737723,
      "val_loss": 9058.653557645124,
      "val_quality": 0.1952734341411544,
      "test_quality": 0.20450642007031006,
      "patience_counter": 4,
      "elbo_raw": -104684.67320122609,
      "elbo_relative": 450172423.5602862,
      "e_log_p_nodes": -15507.037499226888,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012455012419587477,
      "h_nodes": -9542.543340651016,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.977665082529711,
      "tau_mean": 0.00012455012419587477,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 7999.586241485825,
      "train_quality": 0.23329456276371097,
      "val_loss": 9041.895076753197,
      "val_quality": 0.19676217578375665,
      "test_quality": 0.20622562737945338,
      "patience_counter": 5,
      "elbo_raw": -99374.04901713523,
      "elbo_relative": 450177734.1844703,
      "e_log_p_nodes": -9812.885966689162,
      "e_log_p_bonds": -788.0505159175659,
      "e_log_p_tau": -0.00012460224056321236,
      "h_nodes": -9529.738485993203,
      "h_bonds": 137.73487630456975,
      "h_tau": -11.977246733149514,
      "tau_mean": 0.00012460224056321236,
      "bond_mean_avg": 5.137388307106923,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7869.907286260487,
      "train_quality": 0.2457234005891934,
      "val_loss": 9219.689211411098,
      "val_quality": 0.18096781269186546,
      "test_quality": 0.19142771188473795,
      "patience_counter": 6,
      "elbo_raw": -86776.269385952,
      "elbo_relative": 450190331.9641015,
      "e_log_p_nodes": -9809.097561816108,
      "e_log_p_bonds": -1195.7895544072223,
      "e_log_p_tau": -0.0001248542607226192,
      "h_nodes": 3473.917504717858,
      "h_bonds": 122.25244233871535,
      "h_tau": -11.975226178510638,
      "tau_mean": 0.0001248542607226192,
      "bond_mean_avg": 6.97646351128179,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8142.026598803247,
      "train_quality": 0.2196426321337509,
      "val_loss": 9594.641634650727,
      "val_quality": 0.14765886959188035,
      "test_quality": 0.14544278853151094,
      "patience_counter": 7,
      "elbo_raw": -77753.2714200682,
      "elbo_relative": 450199354.96206737,
      "e_log_p_nodes": -9777.652255429493,
      "e_log_p_bonds": -1640.4597821484203,
      "e_log_p_tau": -0.00012002962510625686,
      "h_nodes": 13194.111682309864,
      "h_bonds": 102.74634178975772,
      "h_tau": -12.014634733190178,
      "tau_mean": 0.00012002962510625686,
      "bond_mean_avg": 8.87406845085694,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6975.959570399862,
      "train_quality": 0.3314021536728028,
      "val_loss": 8506.461482984092,
      "val_quality": 0.2443274827487889,
      "test_quality": 0.2450429178328427,
      "patience_counter": 8,
      "elbo_raw": -68634.23706006269,
      "elbo_relative": 450208473.99642736,
      "e_log_p_nodes": -9777.699652783682,
      "e_log_p_bonds": -2059.7015718561133,
      "e_log_p_tau": -0.00013930272160539924,
      "h_nodes": 21759.11777596642,
      "h_bonds": 76.72738437044244,
      "h_tau": -11.865723903065373,
      "tau_mean": 0.00013930272160539924,
      "bond_mean_avg": 10.1855672779584,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 6071.139002342978,
      "train_quality": 0.4181229950151656,
      "val_loss": 7663.494988018012,
      "val_quality": 0.3192125115570289,
      "test_quality": 0.3131657960951043,
      "patience_counter": 9,
      "elbo_raw": -60120.591367151574,
      "elbo_relative": 450216987.6421203,
      "e_log_p_nodes": -9799.40296953604,
      "e_log_p_bonds": -2418.9292086063324,
      "e_log_p_tau": -0.0001604831680648969,
      "h_nodes": 29735.13207886945,
      "h_bonds": 45.409906984237395,
      "h_tau": -11.72418425619253,
      "tau_mean": 0.0001604831680648969,
      "bond_mean_avg": 10.733054445164457,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5610.999474869273,
      "train_quality": 0.4622242106220241,
      "val_loss": 7271.091416437633,
      "val_quality": 0.3540717294947898,
      "test_quality": 0.3513693296734801,
      "patience_counter": 10,
      "elbo_raw": -52362.98291372181,
      "elbo_relative": 450224745.2505737,
      "e_log_p_nodes": -9830.808530858876,
      "e_log_p_bonds": -2740.544592914833,
      "e_log_p_tau": -0.0001744987021623575,
      "h_nodes": 37317.11905173886,
      "h_bonds": 12.160011186990829,
      "h_tau": -11.640456017245015,
      "tau_mean": 0.0001744987021623575,
      "bond_mean_avg": 10.889669793754756,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5238.593547196132,
      "train_quality": 0.49791676283494823,
      "val_loss": 7116.775959730215,
      "val_quality": 0.3677803614393568,
      "test_quality": 0.3709559660319349,
      "patience_counter": 11,
      "elbo_raw": -44652.59197257735,
      "elbo_relative": 450232455.64151484,
      "e_log_p_nodes": -9864.821396373989,
      "e_log_p_bonds": -3049.567985678886,
      "e_log_p_tau": -0.0001876096741479787,
      "h_nodes": 44918.38186616396,
      "h_bonds": -21.865237613517834,
      "h_tau": -11.568009718197573,
      "tau_mean": 0.0001876096741479787,
      "bond_mean_avg": 10.907060227112751,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 5058.006988559853,
      "train_quality": 0.515224745050352,
      "val_loss": 6893.256351838984,
      "val_quality": 0.3876367523826467,
      "test_quality": 0.3748194471489882,
      "patience_counter": 12,
      "elbo_raw": -37354.73622616042,
      "elbo_relative": 450239753.4972613,
      "e_log_p_nodes": -9899.1124382977,
      "e_log_p_bonds": -3353.735599939857,
      "e_log_p_tau": -0.00019497600296621172,
      "h_nodes": 52330.14308141029,
      "h_bonds": -55.772438144330295,
      "h_tau": -11.529496832110453,
      "tau_mean": 0.00019497600296621172,
      "bond_mean_avg": 10.897653396138228,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 5019.476379786411,
      "train_quality": 0.5189176394519923,
      "val_loss": 6877.093653306786,
      "val_quality": 0.3890725676284843,
      "test_quality": 0.3722079952429347,
      "patience_counter": 13,
      "elbo_raw": -30141.951887991767,
      "elbo_relative": 450246966.28159946,
      "e_log_p_nodes": -9933.188366927134,
      "e_log_p_bonds": -3655.1259727660918,
      "e_log_p_tau": -0.0001967883277219849,
      "h_nodes": 59849.96409879912,
      "h_bonds": -89.43800559205808,
      "h_tau": -11.520244648891094,
      "tau_mean": 0.0001967883277219849,
      "bond_mean_avg": 10.884160138582326,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5062.789215516723,
      "train_quality": 0.5147664014186631,
      "val_loss": 6942.460848731821,
      "val_quality": 0.38326566505080284,
      "test_quality": 0.3759644595145516,
      "patience_counter": 14,
      "elbo_raw": -23026.986736103514,
      "elbo_relative": 450254081.2467513,
      "e_log_p_nodes": -9967.041177204808,
      "e_log_p_bonds": -3954.5956060893727,
      "e_log_p_tau": -0.00019520799267820572,
      "h_nodes": 67385.82455326743,
      "h_bonds": -122.88952026789508,
      "h_tau": -11.528307702152233,
      "tau_mean": 0.00019520799267820572,
      "bond_mean_avg": 10.870854590615256,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5264.90686569017,
      "train_quality": 0.49539481185497325,
      "val_loss": 7120.948355425463,
      "val_quality": 0.36740970617167545,
      "test_quality": 0.3670526759610817,
      "patience_counter": 15,
      "elbo_raw": -15880.174260121974,
      "elbo_relative": 450261228.0592273,
      "e_log_p_nodes": -10000.626411152058,
      "e_log_p_bonds": -4252.136104357581,
      "e_log_p_tau": -0.000187691605580524,
      "h_nodes": 75160.47533487086,
      "h_bonds": -156.09798452515315,
      "h_tau": -11.567573101332528,
      "tau_mean": 0.000187691605580524,
      "bond_mean_avg": 10.85958254511035,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5461.375156396179,
      "train_quality": 0.4765646746226708,
      "val_loss": 7317.847377551769,
      "val_quality": 0.3499181581299754,
      "test_quality": 0.3573960874559734,
      "patience_counter": 16,
      "elbo_raw": -8553.127203277298,
      "elbo_relative": 450268555.10628414,
      "e_log_p_nodes": -10034.08483507309,
      "e_log_p_bonds": -4548.713830004158,
      "e_log_p_tau": -0.00018088470923409143,
      "h_nodes": 83098.52726667796,
      "h_bonds": -189.16648831267906,
      "h_tau": -11.604513458631118,
      "tau_mean": 0.00018088470923409143,
      "bond_mean_avg": 10.85044101370439,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5515.230358788903,
      "train_quality": 0.4714030231007674,
      "val_loss": 7417.4460387003655,
      "val_quality": 0.34107029922465204,
      "test_quality": 0.3382952574411918,
      "patience_counter": 17,
      "elbo_raw": -936.3259443806601,
      "elbo_relative": 450276171.90754306,
      "e_log_p_nodes": -10067.425813268243,
      "e_log_p_bonds": -4844.5089630895345,
      "e_log_p_tau": -0.0001789444468113897,
      "h_nodes": 91149.8002538092,
      "h_bonds": -222.12803955864973,
      "h_tau": -11.615297916730924,
      "tau_mean": 0.0001789444468113897,
      "bond_mean_avg": 10.842654651965082,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5461.431775153232,
      "train_quality": 0.476559248103402,
      "val_loss": 7251.44412086393,
      "val_quality": 0.3558170993331248,
      "test_quality": 0.33610843789567557,
      "patience_counter": 18,
      "elbo_raw": 6836.618134551449,
      "elbo_relative": 450283944.851622,
      "e_log_p_nodes": -10100.768081364402,
      "e_log_p_bonds": -5140.825724584709,
      "e_log_p_tau": -0.00018058102625179105,
      "h_nodes": 99224.31675618129,
      "h_bonds": -255.13647507856842,
      "h_tau": -11.606193745443306,
      "tau_mean": 0.00018058102625179105,
      "bond_mean_avg": 10.835750102716755,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5411.901840789557,
      "train_quality": 0.4813063523705762,
      "val_loss": 7220.4394599945945,
      "val_quality": 0.3585714020678773,
      "test_quality": 0.34991805741874826,
      "patience_counter": 19,
      "elbo_raw": 14402.288203848235,
      "elbo_relative": 450291510.52169126,
      "e_log_p_nodes": -10134.100700949837,
      "e_log_p_bonds": -5437.576899767764,
      "e_log_p_tau": -0.0001823437774436496,
      "h_nodes": 107087.9076133606,
      "h_bonds": -288.1667761590836,
      "h_tau": -11.596479528969212,
      "tau_mean": 0.0001823437774436496,
      "bond_mean_avg": 10.830708371668335,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5268.207517972634,
      "train_quality": 0.49507846698725155,
      "val_loss": 7141.373256954123,
      "val_quality": 0.3655952576158753,
      "test_quality": 0.36301695510721155,
      "patience_counter": 20,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10167.477853784078,
      "e_log_p_bonds": -5734.808790652909,
      "e_log_p_tau": -0.00018733385003865525,
      "h_nodes": 0.0,
      "h_bonds": -321.2493006952054,
      "h_tau": -11.569481001955864,
      "tau_mean": 0.00018733385003865525,
      "bond_mean_avg": 10.825781854237375,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5288.971767539718,
      "train_quality": 0.4930883561786884,
      "val_loss": 7038.519379257498,
      "val_quality": 0.37473229407028474,
      "test_quality": 0.35843188049278607,
      "patience_counter": 21,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10200.90060852294,
      "e_log_p_bonds": -6032.491863081157,
      "e_log_p_tau": -0.00018680409134393537,
      "h_nodes": 0.0,
      "h_bonds": -354.39556175098613,
      "h_tau": -11.57231289356423,
      "tau_mean": 0.00018680409134393537,
      "bond_mean_avg": 10.820102230092271,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}