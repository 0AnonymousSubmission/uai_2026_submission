{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed42806-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 42806
  },
  "hparams": {
    "seed": 42806,
    "fold": 4,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 95939.69534474483,
      "train_quality": -8.110161845230568,
      "val_loss": 101465.90350782474,
      "val_quality": -8.233733774638631,
      "patience_counter": 0,
      "elbo_raw": -647155892.1746862,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -106033.53377876093,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3829.4994953522623,
      "train_quality": 0.6363615700099378,
      "val_loss": 6981.789841147041,
      "val_quality": 0.36463396633868483,
      "test_quality": 0.36102648706277074,
      "patience_counter": 0,
      "elbo_raw": -2341270.0906035453,
      "elbo_relative": 644814622.0840826,
      "e_log_p_nodes": -2247082.3035713546,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00026116963681185824,
      "h_nodes": -19521.927320249455,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.237203175725881,
      "tau_mean": 0.00026116963681185824,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7726.101129745352,
      "train_quality": 0.26635131087630304,
      "val_loss": 8534.02364012012,
      "val_quality": 0.22337554197933318,
      "test_quality": 0.246771363132257,
      "patience_counter": 1,
      "elbo_raw": -107182.01272460425,
      "elbo_relative": 647048710.1619616,
      "e_log_p_nodes": -17205.14096204182,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012944054774391173,
      "h_nodes": -10600.239789660329,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.939151636448514,
      "tau_mean": 0.00012944054774391173,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8127.29777471618,
      "train_quality": 0.22825481333882203,
      "val_loss": 8764.094220481966,
      "val_quality": 0.20243835603810645,
      "test_quality": 0.22056732784525657,
      "patience_counter": 2,
      "elbo_raw": -105033.39765459044,
      "elbo_relative": 647050858.7770317,
      "e_log_p_nodes": -15679.911920940654,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001227479904919669,
      "h_nodes": -9620.574109958567,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.992239925588365,
      "tau_mean": 0.0001227479904919669,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8140.0140525787965,
      "train_quality": 0.22704731159534575,
      "val_loss": 8744.00982442165,
      "val_quality": 0.20426610269815626,
      "test_quality": 0.22210428541258576,
      "patience_counter": 3,
      "elbo_raw": -104832.8127659151,
      "elbo_relative": 647051059.3619202,
      "e_log_p_nodes": -15536.761576053963,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012248081716439613,
      "h_nodes": -9548.520199697263,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.994418898240838,
      "tau_mean": 0.00012248081716439613,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8135.0534255853145,
      "train_quality": 0.22751835869010728,
      "val_loss": 8723.294122876643,
      "val_quality": 0.20615130025130968,
      "test_quality": 0.22344311879310397,
      "patience_counter": 4,
      "elbo_raw": -104776.89782133092,
      "elbo_relative": 647051115.2768649,
      "e_log_p_nodes": -15504.212329803082,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012253601908335837,
      "h_nodes": -9528.174483210874,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.993968301292625,
      "tau_mean": 0.00012253601908335837,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8137.068932126484,
      "train_quality": 0.22732697189526496,
      "val_loss": 8713.588715093983,
      "val_quality": 0.20703452455170224,
      "test_quality": 0.2237974065053615,
      "patience_counter": 5,
      "elbo_raw": -99469.77357692634,
      "elbo_relative": 647056422.4011092,
      "e_log_p_nodes": -9802.633539720322,
      "e_log_p_bonds": -791.0457682702586,
      "e_log_p_tau": -0.0001224978567432462,
      "h_nodes": -9518.750437223529,
      "h_bonds": 138.0711886820185,
      "h_tau": -11.994279787533742,
      "tau_mean": 0.0001224978567432462,
      "bond_mean_avg": 5.175498800106315,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 8022.762216505323,
      "train_quality": 0.2381812139851901,
      "val_loss": 8694.80188176783,
      "val_quality": 0.2087441886990169,
      "test_quality": 0.22875911476506827,
      "patience_counter": 6,
      "elbo_raw": -86786.86669236298,
      "elbo_relative": 647069105.3079939,
      "e_log_p_nodes": -9808.9995711631,
      "e_log_p_bonds": -1200.2772959467438,
      "e_log_p_tau": -0.00012248827801336325,
      "h_nodes": 3596.567903239089,
      "h_bonds": 121.78080760014296,
      "h_tau": -11.994357985669922,
      "tau_mean": 0.00012248827801336325,
      "bond_mean_avg": 6.97440506221421,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8170.02234368544,
      "train_quality": 0.22419780923140809,
      "val_loss": 9009.618094069021,
      "val_quality": 0.18009486915587447,
      "test_quality": 0.20092504601622485,
      "patience_counter": 7,
      "elbo_raw": -77621.5397300635,
      "elbo_relative": 647078270.6349561,
      "e_log_p_nodes": -9779.840671023287,
      "e_log_p_bonds": -1642.641918156332,
      "e_log_p_tau": -0.00011957571321202654,
      "h_nodes": 13356.265420069292,
      "h_bonds": 102.11660322082712,
      "h_tau": -12.018423567285936,
      "tau_mean": 0.00011957571321202654,
      "bond_mean_avg": 8.846689768870727,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 7167.62903347337,
      "train_quality": 0.31938223999068893,
      "val_loss": 8054.186204567706,
      "val_quality": 0.2670423402023897,
      "test_quality": 0.26921638483045995,
      "patience_counter": 8,
      "elbo_raw": -68657.59878969858,
      "elbo_relative": 647087234.5758965,
      "e_log_p_nodes": -9777.669077032864,
      "e_log_p_bonds": -2064.4202822723746,
      "e_log_p_tau": -0.00013561946499528296,
      "h_nodes": 21920.060126896264,
      "h_bonds": 76.93901622613362,
      "h_tau": -11.892520409026474,
      "tau_mean": 0.00013561946499528296,
      "bond_mean_avg": 10.23197270138258,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 6198.124792599627,
      "train_quality": 0.4114436178412181,
      "val_loss": 7337.499613675198,
      "val_quality": 0.33226319717376074,
      "test_quality": 0.3418010674855534,
      "patience_counter": 9,
      "elbo_raw": -60100.663676082215,
      "elbo_relative": 647095791.5110102,
      "e_log_p_nodes": -9798.999104090459,
      "e_log_p_bonds": -2419.9869100631668,
      "e_log_p_tau": -0.00015715378250050202,
      "h_nodes": 29896.20074756029,
      "h_bonds": 45.62341710689928,
      "h_tau": -11.745148489069834,
      "tau_mean": 0.00015715378250050202,
      "bond_mean_avg": 10.75415116590808,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5664.999463324827,
      "train_quality": 0.46206768972338186,
      "val_loss": 7074.32513310595,
      "val_quality": 0.3562129478372221,
      "test_quality": 0.35682654458378493,
      "patience_counter": 10,
      "elbo_raw": -52266.27575225822,
      "elbo_relative": 647103625.8989339,
      "e_log_p_nodes": -9830.807032887582,
      "e_log_p_bonds": -2740.7735854386506,
      "e_log_p_tau": -0.00017292667081471696,
      "h_nodes": 37474.79055968311,
      "h_bonds": 12.150958926473635,
      "h_tau": -11.649505684872565,
      "tau_mean": 0.00017292667081471696,
      "bond_mean_avg": 10.890729998308567,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5239.6652817959,
      "train_quality": 0.502456219394166,
      "val_loss": 6797.349960901425,
      "val_quality": 0.3814186072154392,
      "test_quality": 0.3812165810289736,
      "patience_counter": 0,
      "elbo_raw": -44630.500733394554,
      "elbo_relative": 647111261.6739528,
      "e_log_p_nodes": -9864.792597220838,
      "e_log_p_bonds": -3049.643232720599,
      "e_log_p_tau": -0.00018766749941269954,
      "h_nodes": 44938.42837327324,
      "h_bonds": -21.84858457508726,
      "h_tau": -11.567701544561714,
      "tau_mean": 0.00018766749941269954,
      "bond_mean_avg": 10.908814361744772,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 5012.944124223221,
      "train_quality": 0.5239850186237569,
      "val_loss": 6585.565934326907,
      "val_quality": 0.40069165610677737,
      "test_quality": 0.39491009935766763,
      "patience_counter": 0,
      "elbo_raw": -37349.63288653749,
      "elbo_relative": 647118542.5417997,
      "e_log_p_nodes": -9899.107817487347,
      "e_log_p_bonds": -3354.2066536885814,
      "e_log_p_tau": -0.00019685143258073228,
      "h_nodes": 52271.516365096984,
      "h_bonds": -55.819897075337025,
      "h_tau": -11.519924026499211,
      "tau_mean": 0.00019685143258073228,
      "bond_mean_avg": 10.898209851246355,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4977.216788444931,
      "train_quality": 0.5273775852779405,
      "val_loss": 6823.514554440114,
      "val_quality": 0.3790375424172606,
      "test_quality": 0.3815745919463569,
      "patience_counter": 1,
      "elbo_raw": -30363.886937284246,
      "elbo_relative": 647125528.2877489,
      "e_log_p_nodes": -9933.09352788018,
      "e_log_p_bonds": -3655.1192534709307,
      "e_log_p_tau": -0.00019862767647448038,
      "h_nodes": 59565.483307343355,
      "h_bonds": -89.43281269816858,
      "h_tau": -11.510941221611574,
      "tau_mean": 0.00019862767647448038,
      "bond_mean_avg": 10.88485282294142,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5041.197933680371,
      "train_quality": 0.5213021168699621,
      "val_loss": 6820.746048746204,
      "val_quality": 0.3792894856183494,
      "test_quality": 0.37524168330422536,
      "patience_counter": 2,
      "elbo_raw": -23392.51857518383,
      "elbo_relative": 647132499.656111,
      "e_log_p_nodes": -9966.693236439301,
      "e_log_p_bonds": -3953.2019713640234,
      "e_log_p_tau": -0.00019623269537290342,
      "h_nodes": 66983.2299444865,
      "h_bonds": -122.70637411523737,
      "h_tau": -11.523072145057085,
      "tau_mean": 0.00019623269537290342,
      "bond_mean_avg": 10.87341820690182,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5101.78948277997,
      "train_quality": 0.5155485149144102,
      "val_loss": 6849.014337819227,
      "val_quality": 0.3767169775487328,
      "test_quality": 0.3687133133149253,
      "patience_counter": 3,
      "elbo_raw": -16224.116762000383,
      "elbo_relative": 647139668.0579242,
      "e_log_p_nodes": -9999.949915653177,
      "e_log_p_bonds": -4249.034858608279,
      "e_log_p_tau": -0.00019383911987298227,
      "h_nodes": 74596.06461558437,
      "h_bonds": -155.6936429312059,
      "h_tau": -11.535344785377674,
      "tau_mean": 0.00019383911987298227,
      "bond_mean_avg": 10.86461506552083,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5197.784573349753,
      "train_quality": 0.5064330928954451,
      "val_loss": 6871.982467321087,
      "val_quality": 0.3746268015803569,
      "test_quality": 0.36679112347642484,
      "patience_counter": 4,
      "elbo_raw": -8913.959317931454,
      "elbo_relative": 647146978.2153683,
      "e_log_p_nodes": -10033.04148052502,
      "e_log_p_bonds": -4543.993228781114,
      "e_log_p_tau": -0.00019020202703425279,
      "h_nodes": 82394.24815232636,
      "h_bonds": -188.54929633102316,
      "h_tau": -11.554286513950501,
      "tau_mean": 0.00019020202703425279,
      "bond_mean_avg": 10.85817985144258,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5265.087293767369,
      "train_quality": 0.5000422171122193,
      "val_loss": 6833.662413968761,
      "val_quality": 0.3781140535404012,
      "test_quality": 0.36764931122137057,
      "patience_counter": 5,
      "elbo_raw": -1515.1903015240387,
      "elbo_relative": 647154376.9843847,
      "e_log_p_nodes": -10066.020925779254,
      "e_log_p_bonds": -4838.0574085947155,
      "e_log_p_tau": -0.00018772838530326465,
      "h_nodes": 90240.64877197206,
      "h_bonds": -221.29215260316727,
      "h_tau": -11.567377162260527,
      "tau_mean": 0.00018772838530326465,
      "bond_mean_avg": 10.852638986109039,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5306.392232177142,
      "train_quality": 0.49612001710347264,
      "val_loss": 7075.435407931929,
      "val_quality": 0.35611190914535285,
      "test_quality": 0.3647513604401431,
      "patience_counter": 6,
      "elbo_raw": 6057.887128858871,
      "elbo_relative": 647161950.061815,
      "e_log_p_nodes": -10098.951176063667,
      "e_log_p_bonds": -5131.538750529717,
      "e_log_p_tau": -0.00018617272575087012,
      "h_nodes": 98228.65314601267,
      "h_bonds": -253.95933900818358,
      "h_tau": -11.575698445521994,
      "tau_mean": 0.00018617272575087012,
      "bond_mean_avg": 10.84771127883236,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5395.835057124007,
      "train_quality": 0.487626779677269,
      "val_loss": 7107.348664369798,
      "val_quality": 0.3532076969554291,
      "test_quality": 0.3593912552799954,
      "patience_counter": 7,
      "elbo_raw": 13403.135579105641,
      "elbo_relative": 647169295.3102653,
      "e_log_p_nodes": -10131.969848896975,
      "e_log_p_bonds": -5425.317192732908,
      "e_log_p_tau": -0.00018312050099456728,
      "h_nodes": 106044.37002133329,
      "h_bonds": -286.6922435811905,
      "h_tau": -11.592228909867117,
      "tau_mean": 0.00018312050099456728,
      "bond_mean_avg": 10.840564090144394,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5419.43893262868,
      "train_quality": 0.4853854224866969,
      "val_loss": 7200.383660179922,
      "val_quality": 0.34474120374602246,
      "test_quality": 0.3611737353288439,
      "patience_counter": 8,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10165.103936538384,
      "e_log_p_bonds": -5719.892165190398,
      "e_log_p_tau": -0.00018226189873691805,
      "h_nodes": 0.0,
      "h_bonds": -319.51957096003605,
      "h_tau": -11.596928664635925,
      "tau_mean": 0.00018226189873691805,
      "bond_mean_avg": 10.832982617596029,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5427.8802639242385,
      "train_quality": 0.484583857565989,
      "val_loss": 7107.911034145881,
      "val_quality": 0.35315651944046367,
      "test_quality": 0.35414792573195664,
      "patience_counter": 9,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10198.260369561285,
      "e_log_p_bonds": -6014.867331139664,
      "e_log_p_tau": -0.00018198958242296798,
      "h_nodes": 0.0,
      "h_bonds": -352.3660986319668,
      "h_tau": -11.598423875388107,
      "tau_mean": 0.00018198958242296798,
      "bond_mean_avg": 10.827083596744796,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}