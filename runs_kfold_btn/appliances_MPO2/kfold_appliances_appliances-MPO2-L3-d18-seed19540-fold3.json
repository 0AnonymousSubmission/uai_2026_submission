{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed19540-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 19540
  },
  "hparams": {
    "seed": 19540,
    "fold": 3,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 53431.83687103437,
      "train_quality": -4.264781529607709,
      "val_loss": 56381.6515386106,
      "val_quality": -3.810170869308597,
      "patience_counter": 0,
      "elbo_raw": -361959032.0339003,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -105921.46341108611,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3668.56129152819,
      "train_quality": 0.638526862280834,
      "val_loss": 7218.612190467614,
      "val_quality": 0.3841479075573936,
      "test_quality": 0.3605530591097936,
      "patience_counter": 0,
      "elbo_raw": -2185677.6110795946,
      "elbo_relative": 359773354.42282075,
      "e_log_p_nodes": -2091861.0206832497,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0002726270358285298,
      "h_nodes": -19438.863462700367,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.194268629391445,
      "tau_mean": 0.0002726270358285298,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7290.653653880153,
      "train_quality": 0.2816324322077882,
      "val_loss": 9089.162866435243,
      "val_quality": 0.22456286303376305,
      "test_quality": 0.23938703904589576,
      "patience_counter": 1,
      "elbo_raw": -106851.03810664453,
      "elbo_relative": 361852180.9957937,
      "e_log_p_nodes": -17214.02847983361,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013717265619467097,
      "h_nodes": -10649.732547620417,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.881132924834674,
      "tau_mean": 0.00013717265619467097,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 7734.709044928108,
      "train_quality": 0.23787846906864407,
      "val_loss": 9381.912286287346,
      "val_quality": 0.19958710065448537,
      "test_quality": 0.21620528792547866,
      "patience_counter": 2,
      "elbo_raw": -104722.79530003323,
      "elbo_relative": 361854309.2386003,
      "e_log_p_nodes": -15694.197637770523,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012896844554896765,
      "h_nodes": -9627.43859794198,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.942805555096129,
      "tau_mean": 0.00012896844554896765,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 7754.315601249583,
      "train_quality": 0.23594658273223268,
      "val_loss": 9366.517014435949,
      "val_quality": 0.2009005401541062,
      "test_quality": 0.21769768494552555,
      "patience_counter": 3,
      "elbo_raw": -104543.18880547324,
      "elbo_relative": 361854488.84509486,
      "e_log_p_nodes": -15561.985908147242,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012856295297633677,
      "h_nodes": -9558.911777679765,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.945954630587948,
      "tau_mean": 0.00012856295297633677,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 7757.441136898786,
      "train_quality": 0.23563861536072406,
      "val_loss": 9350.600608602079,
      "val_quality": 0.20225843992463266,
      "test_quality": 0.21889712890017743,
      "patience_counter": 4,
      "elbo_raw": -104490.82344457987,
      "elbo_relative": 361854541.2104557,
      "e_log_p_nodes": -15524.776212523151,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012849320213346633,
      "h_nodes": -9540.122757220937,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.946497320139315,
      "tau_mean": 0.00012849320213346633,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 7763.277126726071,
      "train_quality": 0.23506357970316583,
      "val_loss": 9346.70441107761,
      "val_quality": 0.20259084196185284,
      "test_quality": 0.21925114407609192,
      "patience_counter": 5,
      "elbo_raw": -99176.0659844252,
      "elbo_relative": 361859855.9679159,
      "e_log_p_nodes": -9816.521754183941,
      "e_log_p_bonds": -786.9667375206959,
      "e_log_p_tau": -0.00012838876373286276,
      "h_nodes": -9530.525004975194,
      "h_bonds": 138.15540705517782,
      "h_tau": -11.947310443829338,
      "tau_mean": 0.00012838876373286276,
      "bond_mean_avg": 5.162161899767417,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7763.016111627418,
      "train_quality": 0.23508929821764735,
      "val_loss": 9727.731254231447,
      "val_quality": 0.17008373776487695,
      "test_quality": 0.196694433746752,
      "patience_counter": 6,
      "elbo_raw": -86790.90524461221,
      "elbo_relative": 361872241.12865573,
      "e_log_p_nodes": -9808.11706657884,
      "e_log_p_bonds": -1194.647961006455,
      "e_log_p_tau": -0.00012666673367827435,
      "h_nodes": 3361.262399765579,
      "h_bonds": 121.42034389250878,
      "h_tau": -11.96081382830016,
      "tau_mean": 0.00012666673367827435,
      "bond_mean_avg": 6.916970759088078,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 7848.273915494538,
      "train_quality": 0.2266886191966747,
      "val_loss": 9746.758532725296,
      "val_quality": 0.16846043553381929,
      "test_quality": 0.1612585957930095,
      "patience_counter": 7,
      "elbo_raw": -77555.80516499741,
      "elbo_relative": 361881476.2287353,
      "e_log_p_nodes": -9780.695237764425,
      "e_log_p_bonds": -1636.646809422219,
      "e_log_p_tau": -0.00012448685270476984,
      "h_nodes": 13147.153442281677,
      "h_bonds": 101.7120412260951,
      "h_tau": -11.978173211828107,
      "tau_mean": 0.00012448685270476984,
      "bond_mean_avg": 8.780431489001547,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6816.312381900846,
      "train_quality": 0.3283705440468945,
      "val_loss": 8983.888721351388,
      "val_quality": 0.23354427120743015,
      "test_quality": 0.24560277289777432,
      "patience_counter": 8,
      "elbo_raw": -68452.4720585857,
      "elbo_relative": 361890579.5618417,
      "e_log_p_nodes": -9779.175876838286,
      "e_log_p_bonds": -2059.186706896031,
      "e_log_p_tau": -0.00014260713592610463,
      "h_nodes": 21784.73189442739,
      "h_bonds": 76.49977610102344,
      "h_tau": -11.842279773103655,
      "tau_mean": 0.00014260713592610463,
      "bond_mean_avg": 10.167636376978646,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 5899.707129891539,
      "train_quality": 0.4186861065151589,
      "val_loss": 7993.953824993397,
      "val_quality": 0.3180000448683409,
      "test_quality": 0.3141241077052517,
      "patience_counter": 9,
      "elbo_raw": -59896.654644013266,
      "elbo_relative": 361899135.3792563,
      "e_log_p_nodes": -9799.88019618156,
      "e_log_p_bonds": -2418.965223643163,
      "e_log_p_tau": -0.00016529508066788186,
      "h_nodes": 29761.382957148973,
      "h_bonds": 45.3450753462228,
      "h_tau": -11.69464107703243,
      "tau_mean": 0.00016529508066788186,
      "bond_mean_avg": 10.72955086713072,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5357.637974964589,
      "train_quality": 0.47209762746881256,
      "val_loss": 7539.98966575109,
      "val_quality": 0.3567297577254064,
      "test_quality": 0.34557758583705545,
      "patience_counter": 10,
      "elbo_raw": -52087.46317020697,
      "elbo_relative": 361906944.5707301,
      "e_log_p_nodes": -9831.064561690295,
      "e_log_p_bonds": -2741.028801010512,
      "e_log_p_tau": -0.00018307943477583952,
      "h_nodes": 37271.4136611404,
      "h_bonds": 11.97191265307032,
      "h_tau": -11.592453192919493,
      "tau_mean": 0.00018307943477583952,
      "bond_mean_avg": 10.881239972344083,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5018.259242400311,
      "train_quality": 0.5055375200006506,
      "val_loss": 7347.900559460496,
      "val_quality": 0.3731177385343365,
      "test_quality": 0.3648700728271128,
      "patience_counter": 11,
      "elbo_raw": -44651.87385898364,
      "elbo_relative": 361914380.16004133,
      "e_log_p_nodes": -9864.871244467751,
      "e_log_p_bonds": -3049.4255104782424,
      "e_log_p_tau": -0.00019621414411215543,
      "h_nodes": 44618.06845052094,
      "h_bonds": -21.86961601530855,
      "h_tau": -11.523166686580225,
      "tau_mean": 0.00019621414411215543,
      "bond_mean_avg": 10.90588359861127,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 4830.0505763301435,
      "train_quality": 0.5240822223141787,
      "val_loss": 7365.576881438551,
      "val_quality": 0.3716096924460247,
      "test_quality": 0.372308342502799,
      "patience_counter": 12,
      "elbo_raw": -37424.160802673214,
      "elbo_relative": 361921607.87309766,
      "e_log_p_nodes": -9899.043766638415,
      "e_log_p_bonds": -3352.8208115501943,
      "e_log_p_tau": -0.00020445480810634198,
      "h_nodes": 51941.06001656826,
      "h_bonds": -55.66831783858265,
      "h_tau": -11.482026357582072,
      "tau_mean": 0.00020445480810634198,
      "bond_mean_avg": 10.897875738222906,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4794.73714879629,
      "train_quality": 0.5275617486025245,
      "val_loss": 7374.356980584326,
      "val_quality": 0.3708606229174082,
      "test_quality": 0.3765584765465281,
      "patience_counter": 13,
      "elbo_raw": -30258.119126448517,
      "elbo_relative": 361928773.9147739,
      "e_log_p_nodes": -9932.998124719987,
      "e_log_p_bonds": -3653.4363608564854,
      "e_log_p_tau": -0.00020617679762711903,
      "h_nodes": 59418.94854000161,
      "h_bonds": -89.23098848717831,
      "h_tau": -11.473639279771305,
      "tau_mean": 0.00020617679762711903,
      "bond_mean_avg": 10.885513801735158,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 4854.817219710958,
      "train_quality": 0.5216418988243385,
      "val_loss": 7387.553517224003,
      "val_quality": 0.3697347673529171,
      "test_quality": 0.3740736341395374,
      "patience_counter": 14,
      "elbo_raw": -23030.942406458693,
      "elbo_relative": 361936001.09149384,
      "e_log_p_nodes": -9966.709302372237,
      "e_log_p_bonds": -3952.0255791859213,
      "e_log_p_tau": -0.00020368430619735418,
      "h_nodes": 67093.37714271556,
      "h_bonds": -122.5687499645424,
      "h_tau": -11.485802044830052,
      "tau_mean": 0.00020368430619735418,
      "bond_mean_avg": 10.873333178684275,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 4965.97704507759,
      "train_quality": 0.5106890244764621,
      "val_loss": 7610.464693081855,
      "val_quality": 0.35071721793224286,
      "test_quality": 0.3624362502438283,
      "patience_counter": 15,
      "elbo_raw": -15728.855543035519,
      "elbo_relative": 361943303.1783573,
      "e_log_p_nodes": -10000.257722820714,
      "e_log_p_bonds": -4249.330856364226,
      "e_log_p_tau": -0.00019913431937864832,
      "h_nodes": 74911.11569475313,
      "h_bonds": -155.7464929943938,
      "h_tau": -11.508393752606935,
      "tau_mean": 0.00019913431937864832,
      "bond_mean_avg": 10.862350278788332,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5047.920415657338,
      "train_quality": 0.5026149254155721,
      "val_loss": 7511.747585200304,
      "val_quality": 0.35913921593471443,
      "test_quality": 0.35623036777719375,
      "patience_counter": 16,
      "elbo_raw": -8301.007162012931,
      "elbo_relative": 361950731.0267383,
      "e_log_p_nodes": -10033.747617137415,
      "e_log_p_bonds": -4546.314541032416,
      "e_log_p_tau": -0.0001957586061824734,
      "h_nodes": 82817.3019317528,
      "h_bonds": -188.87101646685602,
      "h_tau": -11.525491022315691,
      "tau_mean": 0.0001957586061824734,
      "bond_mean_avg": 10.852543378414868,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5019.091938662951,
      "train_quality": 0.50545547221491,
      "val_loss": 7264.828030286216,
      "val_quality": 0.3802050275542451,
      "test_quality": 0.37142235973118654,
      "patience_counter": 17,
      "elbo_raw": -645.2014141900145,
      "elbo_relative": 361958386.83248615,
      "e_log_p_nodes": -10067.16967965861,
      "e_log_p_bonds": -4842.77793631104,
      "e_log_p_tau": -0.00019675225692994866,
      "h_nodes": 90802.05195109476,
      "h_bonds": -221.91145574531856,
      "h_tau": -11.520427963107068,
      "tau_mean": 0.00019675225692994866,
      "bond_mean_avg": 10.844428552664459,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 4977.576737214868,
      "train_quality": 0.509546075843405,
      "val_loss": 7179.331129271683,
      "val_quality": 0.3874991505792622,
      "test_quality": 0.37374293876542897,
      "patience_counter": 0,
      "elbo_raw": 6926.055745112884,
      "elbo_relative": 361965958.08964545,
      "e_log_p_nodes": -10100.537670115024,
      "e_log_p_bonds": -5138.909661678109,
      "e_log_p_tau": -0.00019843090500060753,
      "h_nodes": 98678.78243135482,
      "h_bonds": -254.89746272459587,
      "h_tau": -11.51193236749532,
      "tau_mean": 0.00019843090500060753,
      "bond_mean_avg": 10.837472101240156,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 4957.525955788163,
      "train_quality": 0.5115217328653472,
      "val_loss": 7330.125141960459,
      "val_quality": 0.37463423890485015,
      "test_quality": 0.3744847001904297,
      "patience_counter": 1,
      "elbo_raw": 14419.526417675355,
      "elbo_relative": 361973451.560318,
      "e_log_p_nodes": -10133.910275651606,
      "e_log_p_bonds": -5435.107851345862,
      "e_log_p_tau": -0.00019935193170735575,
      "h_nodes": 106503.72347657131,
      "h_bonds": -287.87588973421174,
      "h_tau": -11.50730155758356,
      "tau_mean": 0.00019935193170735575,
      "bond_mean_avg": 10.831444959083552,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 4923.969758296562,
      "train_quality": 0.5148281145864932,
      "val_loss": 7461.573320413931,
      "val_quality": 0.36341980687659403,
      "test_quality": 0.3732787110052327,
      "patience_counter": 2,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10167.248644221503,
      "e_log_p_bonds": -5731.207155464927,
      "e_log_p_tau": -0.0002008127315824441,
      "h_nodes": 0.0,
      "h_bonds": -320.84035852959744,
      "h_tau": -11.500000531290425,
      "tau_mean": 0.0002008127315824441,
      "bond_mean_avg": 10.825704451705885,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 4906.615344527342,
      "train_quality": 0.5165380913048659,
      "val_loss": 7537.517598022678,
      "val_quality": 0.3569406608800616,
      "test_quality": 0.37962273221899556,
      "patience_counter": 3,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10200.51962082168,
      "e_log_p_bonds": -6026.917096044766,
      "e_log_p_tau": -0.00020158058497666214,
      "h_nodes": 0.0,
      "h_bonds": -353.75394507196347,
      "h_tau": -11.496184094510681,
      "tau_mean": 0.00020158058497666214,
      "bond_mean_avg": 10.820491478900305,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}