{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed42-fold1",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 1,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 1,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 66229.84369883488,
      "train_quality": -5.43740347322917,
      "val_loss": 67174.42955875318,
      "val_quality": -5.720526134156584,
      "patience_counter": 0,
      "elbo_raw": -447820458.3787274,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -106009.08764639017,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3550.0373658053636,
      "train_quality": 0.6549437294062221,
      "val_loss": 6677.786833426524,
      "val_quality": 0.33191481896965624,
      "test_quality": 0.3741345337343599,
      "patience_counter": 0,
      "elbo_raw": -2310744.5533773364,
      "elbo_relative": 445509713.82535005,
      "e_log_p_nodes": -2216914.429383865,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00028172914430193454,
      "h_nodes": -19672.804901262607,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.161427193212148,
      "tau_mean": 0.00028172914430193454,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7321.9317707722985,
      "train_quality": 0.2883234146490099,
      "val_loss": 7863.07883289014,
      "val_quality": 0.21333121637970376,
      "test_quality": 0.18840905567939104,
      "patience_counter": 1,
      "elbo_raw": -107175.07995776345,
      "elbo_relative": 447713283.2987696,
      "e_log_p_nodes": -17509.240552155625,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013658727015436044,
      "h_nodes": -10649.86664352291,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.885409569265903,
      "tau_mean": 0.00013658727015436044,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 7726.929601853354,
      "train_quality": 0.2489584652720066,
      "val_loss": 8152.254657908496,
      "val_quality": 0.18440036125867332,
      "test_quality": 0.15419933986929246,
      "patience_counter": 2,
      "elbo_raw": -104780.41817482012,
      "elbo_relative": 447715677.9605526,
      "e_log_p_nodes": -15724.76280827346,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012910779115113074,
      "h_nodes": -9661.743475855412,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.941725675620546,
      "tau_mean": 0.00012910779115113074,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 7727.473217288677,
      "train_quality": 0.24890562697893504,
      "val_loss": 8116.695346635611,
      "val_quality": 0.1879579244905727,
      "test_quality": 0.15798004001117905,
      "patience_counter": 3,
      "elbo_raw": -104540.39252486743,
      "elbo_relative": 447715917.98620254,
      "e_log_p_nodes": -15564.267692683687,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001290141669220195,
      "h_nodes": -9577.348934816157,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.942451101960614,
      "tau_mean": 0.0001290141669220195,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 7720.66431510276,
      "train_quality": 0.24956743815245697,
      "val_loss": 8090.267365643667,
      "val_quality": 0.19060193558372251,
      "test_quality": 0.16079723739318807,
      "patience_counter": 4,
      "elbo_raw": -104465.07058811994,
      "elbo_relative": 447715993.30813926,
      "e_log_p_nodes": -15520.46949083649,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001291058440799848,
      "h_nodes": -9550.599347761095,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.941740756708896,
      "tau_mean": 0.0001291058440799848,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 7722.045187989736,
      "train_quality": 0.24943322017122282,
      "val_loss": 8080.461677359844,
      "val_quality": 0.19158295447450724,
      "test_quality": 0.16193873486954813,
      "patience_counter": 5,
      "elbo_raw": -99145.08975670813,
      "elbo_relative": 447721313.28897065,
      "e_log_p_nodes": -9808.882823355163,
      "e_log_p_bonds": -791.7169604287133,
      "e_log_p_tau": -0.00012907306805141937,
      "h_nodes": -9537.538596543864,
      "h_bonds": 137.58323388468,
      "h_tau": -11.941994658380281,
      "tau_mean": 0.00012907306805141937,
      "bond_mean_avg": 5.1546119088036155,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7703.63735959146,
      "train_quality": 0.25122242292103625,
      "val_loss": 8301.348399570576,
      "val_quality": 0.169484143973898,
      "test_quality": 0.1595650186475277,
      "patience_counter": 6,
      "elbo_raw": -86667.91525204328,
      "elbo_relative": 447733790.46347535,
      "e_log_p_nodes": -9808.623321020166,
      "e_log_p_bonds": -1195.027687465858,
      "e_log_p_tau": -0.00012756933618872233,
      "h_nodes": 3436.676001766367,
      "h_bonds": 122.23889607442955,
      "h_tau": -11.953713291361055,
      "tau_mean": 0.00012756933618872233,
      "bond_mean_avg": 6.970177899470909,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 7996.075899516154,
      "train_quality": 0.22279800324132615,
      "val_loss": 8686.861704250636,
      "val_quality": 0.13091511918000132,
      "test_quality": 0.11124002434621938,
      "patience_counter": 7,
      "elbo_raw": -77603.6608723075,
      "elbo_relative": 447742854.7178551,
      "e_log_p_nodes": -9778.479908421217,
      "e_log_p_bonds": -1640.5384247177872,
      "e_log_p_tau": -0.00012219477515096954,
      "h_nodes": 13224.914603004192,
      "h_bonds": 102.48535546613316,
      "h_tau": -11.996757032109599,
      "tau_mean": 0.00012219477515096954,
      "bond_mean_avg": 8.85676924968314,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6931.522118319519,
      "train_quality": 0.3262704233134124,
      "val_loss": 7844.343912556914,
      "val_quality": 0.21520556831016058,
      "test_quality": 0.20327512396259462,
      "patience_counter": 8,
      "elbo_raw": -68454.3132153942,
      "elbo_relative": 447752004.065512,
      "e_log_p_nodes": -9777.722595895098,
      "e_log_p_bonds": -2061.7503783130787,
      "e_log_p_tau": -0.00014017592377250357,
      "h_nodes": 21899.13167840482,
      "h_bonds": 76.7731398551284,
      "h_tau": -11.859475089266198,
      "tau_mean": 0.00014017592377250357,
      "bond_mean_avg": 10.202594113809834,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 5838.0006404349015,
      "train_quality": 0.4325584434361138,
      "val_loss": 7231.734281031272,
      "val_quality": 0.2764946490771686,
      "test_quality": 0.2886485671536425,
      "patience_counter": 9,
      "elbo_raw": -59772.302459553415,
      "elbo_relative": 447760686.07626784,
      "e_log_p_nodes": -9799.48612950099,
      "e_log_p_bonds": -2418.742381454431,
      "e_log_p_tau": -0.00016691298656969073,
      "h_nodes": 29819.69532802574,
      "h_bonds": 45.398864666251995,
      "h_tau": -11.684900683270826,
      "tau_mean": 0.00016691298656969073,
      "bond_mean_avg": 10.730830027254235,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5223.233702309827,
      "train_quality": 0.4923125150402785,
      "val_loss": 6851.5400663752225,
      "val_quality": 0.3145315207325704,
      "test_quality": 0.32223536525142094,
      "patience_counter": 10,
      "elbo_raw": -51899.53516984385,
      "elbo_relative": 447768558.84355754,
      "e_log_p_nodes": -9830.970415824391,
      "e_log_p_bonds": -2740.7049061945636,
      "e_log_p_tau": -0.00018765816061523864,
      "h_nodes": 37293.090685399555,
      "h_bonds": 12.030146190522842,
      "h_tau": -11.567751308262814,
      "tau_mean": 0.00018765816061523864,
      "bond_mean_avg": 10.882373242765519,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 4821.74678220943,
      "train_quality": 0.5313362111501916,
      "val_loss": 6614.552026635134,
      "val_quality": 0.33824120200590047,
      "test_quality": 0.3475651452717786,
      "patience_counter": 0,
      "elbo_raw": -44411.84126229605,
      "elbo_relative": 447776046.5374651,
      "e_log_p_nodes": -9864.944485442142,
      "e_log_p_bonds": -3049.7322234773687,
      "e_log_p_tau": -0.00020419082071876542,
      "h_nodes": 44591.11511102008,
      "h_bonds": -21.926386670832528,
      "h_tau": -11.483318369078916,
      "tau_mean": 0.00020419082071876542,
      "bond_mean_avg": 10.904155398727038,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 4691.371237946878,
      "train_quality": 0.5440084437055988,
      "val_loss": 6572.528120226333,
      "val_quality": 0.34244552146398655,
      "test_quality": 0.3518295655547439,
      "patience_counter": 0,
      "elbo_raw": -37297.82418755734,
      "elbo_relative": 447783160.5545398,
      "e_log_p_nodes": -9899.129177210463,
      "e_log_p_bonds": -3353.1644965021405,
      "e_log_p_tau": -0.00021053568944339712,
      "h_nodes": 51871.18914512079,
      "h_bonds": -55.721200222220745,
      "h_tau": -11.452718136592011,
      "tau_mean": 0.00021053568944339712,
      "bond_mean_avg": 10.896669213104843,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4791.3248900891185,
      "train_quality": 0.5342931559814075,
      "val_loss": 6614.601958259417,
      "val_quality": 0.3382362065517057,
      "test_quality": 0.34627636338480516,
      "patience_counter": 1,
      "elbo_raw": -30471.053757379435,
      "elbo_relative": 447789987.32497,
      "e_log_p_nodes": -9933.084827650444,
      "e_log_p_bonds": -3653.1884520163435,
      "e_log_p_tau": -0.00020650921636904747,
      "h_nodes": 59195.03861021508,
      "h_bonds": -89.2310065423476,
      "h_tau": -11.4720282786584,
      "tau_mean": 0.00020650921636904747,
      "bond_mean_avg": 10.883293849598742,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 4943.71597512262,
      "train_quality": 0.5194810585145206,
      "val_loss": 6627.841678797111,
      "val_quality": 0.33691162681999876,
      "test_quality": 0.34299836268994444,
      "patience_counter": 2,
      "elbo_raw": -23376.517638060424,
      "elbo_relative": 447797081.8610893,
      "e_log_p_nodes": -9966.751448806139,
      "e_log_p_bonds": -3950.7396048637497,
      "e_log_p_tau": -0.00020012926449268904,
      "h_nodes": 66864.61669493496,
      "h_bonds": -122.45350387764435,
      "h_tau": -11.503409841156099,
      "tau_mean": 0.00020012926449268904,
      "bond_mean_avg": 10.870855831097133,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5053.387224786228,
      "train_quality": 0.5088212404616763,
      "val_loss": 6757.304466283912,
      "val_quality": 0.32395940597613104,
      "test_quality": 0.3228486744129244,
      "patience_counter": 3,
      "elbo_raw": -16022.077920169133,
      "elbo_relative": 447804436.3008072,
      "e_log_p_nodes": -10000.196812482192,
      "e_log_p_bonds": -4246.683843819358,
      "e_log_p_tau": -0.0001957463939447465,
      "h_nodes": 74730.06419565811,
      "h_bonds": -155.4753217605763,
      "h_tau": -11.525553408428095,
      "tau_mean": 0.0001957463939447465,
      "bond_mean_avg": 10.859975061827422,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5039.178794333004,
      "train_quality": 0.5102022704391083,
      "val_loss": 6850.025958284361,
      "val_quality": 0.31468300103633196,
      "test_quality": 0.3231444634454951,
      "patience_counter": 4,
      "elbo_raw": -8485.92197054009,
      "elbo_relative": 447811972.45675683,
      "e_log_p_nodes": -10033.496795392319,
      "e_log_p_bonds": -4541.68657477705,
      "e_log_p_tau": -0.00019617567311352383,
      "h_nodes": 82612.7174167121,
      "h_bonds": -188.36347620389375,
      "h_tau": -11.523362772197288,
      "tau_mean": 0.00019617567311352383,
      "bond_mean_avg": 10.851053729321006,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5043.53289208985,
      "train_quality": 0.509779061165806,
      "val_loss": 6769.650779234183,
      "val_quality": 0.3227242080088718,
      "test_quality": 0.3174567386483861,
      "patience_counter": 5,
      "elbo_raw": -959.5916513449774,
      "elbo_relative": 447819498.78707606,
      "e_log_p_nodes": -10066.71542785876,
      "e_log_p_bonds": -4836.173231543585,
      "e_log_p_tau": -0.0001959682425742366,
      "h_nodes": 90506.67484203493,
      "h_bonds": -221.1826726678749,
      "h_tau": -11.5244207029682,
      "tau_mean": 0.0001959682425742366,
      "bond_mean_avg": 10.842956471678551,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5035.475274324966,
      "train_quality": 0.510562244904265,
      "val_loss": 6847.805077750356,
      "val_quality": 0.3149051910239159,
      "test_quality": 0.3163690829561261,
      "patience_counter": 6,
      "elbo_raw": 6500.948150109893,
      "elbo_relative": 447826959.3268775,
      "e_log_p_nodes": -10099.913199744942,
      "e_log_p_bonds": -5130.592709048085,
      "e_log_p_tau": -0.00019630652046919876,
      "h_nodes": 98316.06058691969,
      "h_bonds": -253.99512265626714,
      "h_tau": -11.522696003805322,
      "tau_mean": 0.00019630652046919876,
      "bond_mean_avg": 10.834884107395686,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5070.528097225807,
      "train_quality": 0.5071551832038865,
      "val_loss": 6890.248927345106,
      "val_quality": 0.31065885797264314,
      "test_quality": 0.30846140442042713,
      "patience_counter": 7,
      "elbo_raw": 13936.639613208667,
      "elbo_relative": 447834395.0183406,
      "e_log_p_nodes": -10133.117701183073,
      "e_log_p_bonds": -5425.151313643592,
      "e_log_p_tau": -0.00019490491682130892,
      "h_nodes": 106160.43740894663,
      "h_bonds": -286.82427256681234,
      "h_tau": -11.529861487790185,
      "tau_mean": 0.00019490491682130892,
      "bond_mean_avg": 10.826801627388786,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5142.969320091722,
      "train_quality": 0.5001140465555418,
      "val_loss": 6854.534569772655,
      "val_quality": 0.31423193295082863,
      "test_quality": 0.3097927202443568,
      "patience_counter": 8,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10166.264044798945,
      "e_log_p_bonds": -5719.4875144645275,
      "e_log_p_tau": -0.00019213905644142716,
      "h_nodes": 0.0,
      "h_bonds": -319.60123493717555,
      "h_tau": -11.544153959206596,
      "tau_mean": 0.00019213905644142716,
      "bond_mean_avg": 10.820569722184155,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5150.88545743158,
      "train_quality": 0.4993446144210212,
      "val_loss": 6894.6674841999575,
      "val_quality": 0.3102167994838202,
      "test_quality": 0.315075412337258,
      "patience_counter": 9,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10199.292951652431,
      "e_log_p_bonds": -6013.098078172041,
      "e_log_p_tau": -0.0001917538608717877,
      "h_nodes": 0.0,
      "h_bonds": -352.27356152153845,
      "h_tau": -11.546160746423993,
      "tau_mean": 0.0001917538608717877,
      "bond_mean_avg": 10.815934526546629,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}