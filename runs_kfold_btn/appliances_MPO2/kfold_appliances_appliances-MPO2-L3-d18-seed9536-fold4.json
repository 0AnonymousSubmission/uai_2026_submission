{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed9536-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 9536
  },
  "hparams": {
    "seed": 9536,
    "fold": 4,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 129711.62724783088,
      "train_quality": -11.31670830304042,
      "val_loss": 123682.92033901431,
      "val_quality": -10.446028527773887,
      "patience_counter": 0,
      "elbo_raw": -873785205.1776214,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -105688.6372182204,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3728.6339436237536,
      "train_quality": 0.645949267410821,
      "val_loss": 6207.812262038043,
      "val_quality": 0.42550842063244365,
      "test_quality": 0.3374940666046752,
      "patience_counter": 0,
      "elbo_raw": -2373544.3536404544,
      "elbo_relative": 871411660.8239809,
      "e_log_p_nodes": -2279420.5802709963,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0002682346957200992,
      "h_nodes": -19637.041912198412,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.210510993805656,
      "tau_mean": 0.0002682346957200992,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7710.601411727868,
      "train_quality": 0.2678433657469057,
      "val_loss": 8153.117670372332,
      "val_quality": 0.2454833926172898,
      "test_quality": 0.22465578087664495,
      "patience_counter": 1,
      "elbo_raw": -107334.73041356626,
      "elbo_relative": 873677870.4472078,
      "e_log_p_nodes": -17380.146648615682,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012970171509353622,
      "h_nodes": -10591.481151428312,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.93713600661431,
      "tau_mean": 0.00012970171509353622,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8128.525912172282,
      "train_quality": 0.22815953574735715,
      "val_loss": 8413.834974923182,
      "val_quality": 0.22135574671926495,
      "test_quality": 0.20400466592498212,
      "patience_counter": 2,
      "elbo_raw": -105042.77673373125,
      "elbo_relative": 873680162.4008876,
      "e_log_p_nodes": -15680.38013462013,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001227292305338481,
      "h_nodes": -9628.457478825097,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.992392770385777,
      "tau_mean": 0.0001227292305338481,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8129.38192913594,
      "train_quality": 0.2280782530476676,
      "val_loss": 8394.07597812661,
      "val_quality": 0.2231843099549473,
      "test_quality": 0.20708410728386017,
      "patience_counter": 3,
      "elbo_raw": -104822.31083755115,
      "elbo_relative": 873680382.8667839,
      "e_log_p_nodes": -15534.809305686173,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012263738722791755,
      "h_nodes": -9548.54603795786,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.993141391460085,
      "tau_mean": 0.00012263738722791755,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8121.270035390213,
      "train_quality": 0.22884851421215424,
      "val_loss": 8380.609475318353,
      "val_quality": 0.2244305448828594,
      "test_quality": 0.20889218277116173,
      "patience_counter": 4,
      "elbo_raw": -104758.48711186514,
      "elbo_relative": 873680446.6905096,
      "e_log_p_nodes": -15496.254420941877,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012273975294932186,
      "h_nodes": -9528.87178137039,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.992307037231512,
      "tau_mean": 0.00012273975294932186,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8121.407740346236,
      "train_quality": 0.22883543850096932,
      "val_loss": 8379.308353748562,
      "val_quality": 0.22455095499740985,
      "test_quality": 0.20936398837381132,
      "patience_counter": 5,
      "elbo_raw": -99453.96782472936,
      "elbo_relative": 873685751.2097967,
      "e_log_p_nodes": -9792.918908011756,
      "e_log_p_bonds": -796.3793359240055,
      "e_log_p_tau": -0.00012272913380932953,
      "h_nodes": -9519.675969521752,
      "h_bonds": 137.76327289334705,
      "h_tau": -11.992393558502954,
      "tau_mean": 0.00012272913380932953,
      "bond_mean_avg": 5.189748075556773,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 8013.762212320565,
      "train_quality": 0.23905687043386592,
      "val_loss": 8291.766633707552,
      "val_quality": 0.2326523567286537,
      "test_quality": 0.21137354247925866,
      "patience_counter": 6,
      "elbo_raw": -86737.26571658158,
      "elbo_relative": 873698467.9119048,
      "e_log_p_nodes": -9808.958448175714,
      "e_log_p_bonds": -1203.1839547447985,
      "e_log_p_tau": -0.0001225582103649866,
      "h_nodes": 3645.907085047972,
      "h_bonds": 121.08334786527585,
      "h_tau": -11.993787217616045,
      "tau_mean": 0.0001225582103649866,
      "bond_mean_avg": 6.946574179097864,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8055.114213331674,
      "train_quality": 0.23513031007064,
      "val_loss": 8408.240235899495,
      "val_quality": 0.22187350246351034,
      "test_quality": 0.18487667179822842,
      "patience_counter": 7,
      "elbo_raw": -77485.98552605744,
      "elbo_relative": 873707719.1920953,
      "e_log_p_nodes": -9782.494263349416,
      "e_log_p_bonds": -1642.548256342443,
      "e_log_p_tau": -0.00012115619276761507,
      "h_nodes": 13407.216391468295,
      "h_bonds": 101.16507303174116,
      "h_tau": -12.005292758905853,
      "tau_mean": 0.00012115619276761507,
      "bond_mean_avg": 8.780173587427736,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6939.26585348751,
      "train_quality": 0.34108518127403453,
      "val_loss": 7641.664490578933,
      "val_quality": 0.29281496977030197,
      "test_quality": 0.27453322510319045,
      "patience_counter": 8,
      "elbo_raw": -68467.1057501943,
      "elbo_relative": 873716738.0718712,
      "e_log_p_nodes": -9781.172317805882,
      "e_log_p_bonds": -2065.0359131035243,
      "e_log_p_tau": -0.00014006229937791394,
      "h_nodes": 21899.25263773254,
      "h_bonds": 76.03711959145969,
      "h_tau": -11.860286002207431,
      "tau_mean": 0.00014006229937791394,
      "bond_mean_avg": 10.173854506672491,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 6198.098470318047,
      "train_quality": 0.41146239152045627,
      "val_loss": 7014.25035518744,
      "val_quality": 0.35087795916880116,
      "test_quality": 0.3229082196793117,
      "patience_counter": 9,
      "elbo_raw": -60127.42884511319,
      "elbo_relative": 873725077.7487762,
      "e_log_p_nodes": -9800.591104897981,
      "e_log_p_bonds": -2423.7222455472106,
      "e_log_p_tau": -0.00015747610320639675,
      "h_nodes": 29861.39318704228,
      "h_bonds": 45.233283496736505,
      "h_tau": -11.743099600309506,
      "tau_mean": 0.00015747610320639675,
      "bond_mean_avg": 10.751774224954216,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5769.983781744578,
      "train_quality": 0.4521138261781352,
      "val_loss": 6658.049116514919,
      "val_quality": 0.38384200568628957,
      "test_quality": 0.35581087420458024,
      "patience_counter": 10,
      "elbo_raw": -52429.52730529956,
      "elbo_relative": 873732775.6503161,
      "e_log_p_nodes": -9831.908254961078,
      "e_log_p_bonds": -2742.722847846541,
      "e_log_p_tau": -0.00016989297393653875,
      "h_nodes": 37433.645410522106,
      "h_bonds": 11.878363490332433,
      "h_tau": -11.667204647681501,
      "tau_mean": 0.00016989297393653875,
      "bond_mean_avg": 10.883631788456283,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5460.623650073068,
      "train_quality": 0.48148897614143105,
      "val_loss": 6439.841377976943,
      "val_quality": 0.4040356750582671,
      "test_quality": 0.35589994086453935,
      "patience_counter": 11,
      "elbo_raw": -44845.065632900936,
      "elbo_relative": 873740360.1119884,
      "e_log_p_nodes": -9865.779720557084,
      "e_log_p_bonds": -3050.5281573514753,
      "e_log_p_tau": -0.00018001377256713293,
      "h_nodes": 45005.368023873394,
      "h_bonds": -22.037104549900803,
      "h_tau": -11.609339959170029,
      "tau_mean": 0.00018001377256713293,
      "bond_mean_avg": 10.899844321390924,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 5299.22168572254,
      "train_quality": 0.49681482592546744,
      "val_loss": 6296.325283621152,
      "val_quality": 0.4173171314282207,
      "test_quality": 0.3719001237147975,
      "patience_counter": 12,
      "elbo_raw": -37523.31787577852,
      "elbo_relative": 873747681.8597456,
      "e_log_p_nodes": -9899.863740667886,
      "e_log_p_bonds": -3353.6903053883057,
      "e_log_p_tau": -0.00018597335114425045,
      "h_nodes": 52479.56575180769,
      "h_bonds": -55.8164459919515,
      "h_tau": -11.576769931358285,
      "tau_mean": 0.00018597335114425045,
      "bond_mean_avg": 10.891773243862993,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 5334.548422109296,
      "train_quality": 0.4934603918118414,
      "val_loss": 6273.102167537799,
      "val_quality": 0.41946627577624607,
      "test_quality": 0.35931776637374413,
      "patience_counter": 13,
      "elbo_raw": -30367.6476066908,
      "elbo_relative": 873754837.5300146,
      "e_log_p_nodes": -9933.698472506003,
      "e_log_p_bonds": -3653.586858519204,
      "e_log_p_tau": -0.00018499784956153183,
      "h_nodes": 60037.7342742186,
      "h_bonds": -89.29690515711653,
      "h_tau": -11.582029120370862,
      "tau_mean": 0.00018499784956153183,
      "bond_mean_avg": 10.879717325424245,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5356.2571254201,
      "train_quality": 0.49139905180717425,
      "val_loss": 6355.151992730581,
      "val_quality": 0.41187311224743195,
      "test_quality": 0.3620951316429224,
      "patience_counter": 14,
      "elbo_raw": -23098.764443798063,
      "elbo_relative": 873762106.4131776,
      "e_log_p_nodes": -9967.370594367285,
      "e_log_p_bonds": -3951.905475896708,
      "e_log_p_tau": -0.00018434918631544424,
      "h_nodes": 67695.50099390256,
      "h_bonds": -122.60808521939016,
      "h_tau": -11.58554161052598,
      "tau_mean": 0.00018434918631544424,
      "bond_mean_avg": 10.86732988298234,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5379.218314191927,
      "train_quality": 0.48921878261778773,
      "val_loss": 6382.612931554127,
      "val_quality": 0.4093317856979599,
      "test_quality": 0.3604847684515414,
      "patience_counter": 15,
      "elbo_raw": -15687.90710798047,
      "elbo_relative": 873769517.2705134,
      "e_log_p_nodes": -10000.939211238743,
      "e_log_p_bonds": -4249.167547038067,
      "e_log_p_tau": -0.0001835926781731672,
      "h_nodes": 75497.96289330143,
      "h_bonds": -155.79972367515538,
      "h_tau": -11.589653723232914,
      "tau_mean": 0.0001835926781731672,
      "bond_mean_avg": 10.855091825041386,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5410.498363135341,
      "train_quality": 0.48624859986150515,
      "val_loss": 6374.964552969663,
      "val_quality": 0.4100395920727531,
      "test_quality": 0.35893892407186967,
      "patience_counter": 16,
      "elbo_raw": -8295.974952176402,
      "elbo_relative": 873776909.2026691,
      "e_log_p_nodes": -10034.447814880485,
      "e_log_p_bonds": -4545.9418390770015,
      "e_log_p_tau": -0.00018253665912571642,
      "h_nodes": 83292.01205188704,
      "h_bonds": -188.91321845262826,
      "h_tau": -11.595422296617471,
      "tau_mean": 0.00018253665912571642,
      "bond_mean_avg": 10.844381906529632,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5439.192572963679,
      "train_quality": 0.4835239542769839,
      "val_loss": 6409.2045212673665,
      "val_quality": 0.4068709116045739,
      "test_quality": 0.36255233416850685,
      "patience_counter": 17,
      "elbo_raw": -860.0006137789169,
      "elbo_relative": 873784345.1770076,
      "e_log_p_nodes": -10067.886343108874,
      "e_log_p_bonds": -4842.286800952614,
      "e_log_p_tau": -0.00018159511139647573,
      "h_nodes": 91125.50608352266,
      "h_bonds": -221.94893760817592,
      "h_tau": -11.600593775212474,
      "tau_mean": 0.00018159511139647573,
      "bond_mean_avg": 10.83563515253299,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5417.2829330852455,
      "train_quality": 0.48560437412162694,
      "val_loss": 6421.940517012657,
      "val_quality": 0.40569228022822357,
      "test_quality": 0.357984511474043,
      "patience_counter": 18,
      "elbo_raw": 6660.168552395582,
      "elbo_relative": 873791865.3461738,
      "e_log_p_nodes": -10101.302533488033,
      "e_log_p_bonds": -5138.61698409573,
      "e_log_p_tau": -0.00018228228181455374,
      "h_nodes": 98983.10361231003,
      "h_bonds": -254.9745473870786,
      "h_tau": -11.596816836892685,
      "tau_mean": 0.00018228228181455374,
      "bond_mean_avg": 10.827510311914228,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5395.572526698508,
      "train_quality": 0.4876658758410911,
      "val_loss": 6373.926938088476,
      "val_quality": 0.41013561640253404,
      "test_quality": 0.363729321903585,
      "patience_counter": 19,
      "elbo_raw": 14126.256597270083,
      "elbo_relative": 873799331.4342186,
      "e_log_p_nodes": -10134.691530405884,
      "e_log_p_bonds": -5434.988542242422,
      "e_log_p_tau": -0.00018299559263676836,
      "h_nodes": 106785.75243436203,
      "h_bonds": -287.98961258416324,
      "h_tau": -11.592911252788326,
      "tau_mean": 0.00018299559263676836,
      "bond_mean_avg": 10.820470322234407,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5343.918365076965,
      "train_quality": 0.4925706731582591,
      "val_loss": 6367.021272446296,
      "val_quality": 0.41077468965312525,
      "test_quality": 0.3621010133753024,
      "patience_counter": 20,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10168.053403375736,
      "e_log_p_bonds": -5731.4544616755265,
      "e_log_p_tau": -0.0001848012021746311,
      "h_nodes": 0.0,
      "h_bonds": -321.00402498433834,
      "h_tau": -11.583092656932422,
      "tau_mean": 0.0001848012021746311,
      "bond_mean_avg": 10.814277893402133,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5398.83961269776,
      "train_quality": 0.4873556511826891,
      "val_loss": 6360.9229794705525,
      "val_quality": 0.4113390459537345,
      "test_quality": 0.3467543481176406,
      "patience_counter": 21,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10201.374620881976,
      "e_log_p_bonds": -6027.836052957576,
      "e_log_p_tau": -0.0001829758502155653,
      "h_nodes": 0.0,
      "h_bonds": -353.99749880278483,
      "h_tau": -11.593019143292622,
      "tau_mean": 0.0001829758502155653,
      "bond_mean_avg": 10.8089407334519,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}