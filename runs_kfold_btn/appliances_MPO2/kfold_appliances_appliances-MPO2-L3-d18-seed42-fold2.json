{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed42-fold2",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 2,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 2,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 65313.1693779975,
      "train_quality": -5.254079485587882,
      "val_loss": 69766.88247624364,
      "val_quality": -5.195859574548437,
      "patience_counter": 0,
      "elbo_raw": -441683847.95050174,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -106009.08764639017,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3713.7726419277205,
      "train_quality": 0.644386736775906,
      "val_loss": 7261.899605374088,
      "val_quality": 0.3550849829833317,
      "test_quality": 0.3579692128414561,
      "patience_counter": 0,
      "elbo_raw": -2324631.4098244137,
      "elbo_relative": 439359216.5406773,
      "e_log_p_nodes": -2230409.811774886,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00026930808307112024,
      "h_nodes": -19761.671367205156,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.20651730690588,
      "tau_mean": 0.00026930808307112024,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7674.738462240052,
      "train_quality": 0.26510342659749475,
      "val_loss": 8461.60847543522,
      "val_quality": 0.24854119851983592,
      "test_quality": 0.23849154123060867,
      "patience_counter": 1,
      "elbo_raw": -107465.66902351251,
      "elbo_relative": 441576382.2814782,
      "e_log_p_nodes": -17507.82836035113,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013030809492897805,
      "h_nodes": -10626.035682681864,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.932471713873383,
      "tau_mean": 0.00013030809492897805,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8106.669359020018,
      "train_quality": 0.2237437714702215,
      "val_loss": 8859.72735804629,
      "val_quality": 0.213185043807401,
      "test_quality": 0.2162405773295064,
      "patience_counter": 2,
      "elbo_raw": -105057.86484764784,
      "elbo_relative": 441578790.0856541,
      "e_log_p_nodes": -15692.86923096946,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001230648373593558,
      "h_nodes": -9649.387352190815,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.989661971900205,
      "tau_mean": 0.0001230648373593558,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8084.863752930345,
      "train_quality": 0.22583177294090473,
      "val_loss": 8817.06382505313,
      "val_quality": 0.21697390823702123,
      "test_quality": 0.21922408903177704,
      "patience_counter": 3,
      "elbo_raw": -104821.33031252614,
      "elbo_relative": 441579026.6201892,
      "e_log_p_nodes": -15551.452329852378,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012331793169162265,
      "h_nodes": -9568.056928917727,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.987607490395021,
      "tau_mean": 0.00012331793169162265,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8062.9424096480425,
      "train_quality": 0.22793085685650727,
      "val_loss": 8780.883113631213,
      "val_quality": 0.22018704603709127,
      "test_quality": 0.2207825145137453,
      "patience_counter": 4,
      "elbo_raw": -104748.97641229795,
      "elbo_relative": 441579098.97408944,
      "e_log_p_nodes": -15520.814343545488,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012363290614169744,
      "h_nodes": -9543.468565905943,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.985056580881064,
      "tau_mean": 0.00012363290614169744,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8057.673952048441,
      "train_quality": 0.2284353393813663,
      "val_loss": 8766.195269949434,
      "val_quality": 0.22149144453785852,
      "test_quality": 0.22101968972375763,
      "patience_counter": 5,
      "elbo_raw": -99421.12936228309,
      "elbo_relative": 441584426.82113945,
      "e_log_p_nodes": -9806.815336270953,
      "e_log_p_bonds": -791.357493177123,
      "e_log_p_tau": -0.00012370568789836972,
      "h_nodes": -9530.925610913164,
      "h_bonds": 137.53834924650607,
      "h_tau": -11.984468061658845,
      "tau_mean": 0.00012370568789836972,
      "bond_mean_avg": 5.146855786322756,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7992.640258057544,
      "train_quality": 0.2346626576287254,
      "val_loss": 8821.533610190745,
      "val_quality": 0.21657695541272826,
      "test_quality": 0.20752052712450852,
      "patience_counter": 6,
      "elbo_raw": -86857.15429061191,
      "elbo_relative": 441596990.7962111,
      "e_log_p_nodes": -9809.127189471044,
      "e_log_p_bonds": -1196.5461569473432,
      "e_log_p_tau": -0.00012295831668841326,
      "h_nodes": 3496.527659218587,
      "h_bonds": 122.22688385677561,
      "h_tau": -11.990527912166726,
      "tau_mean": 0.00012295831668841326,
      "bond_mean_avg": 6.980281456438543,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8203.704259990121,
      "train_quality": 0.21445216934277045,
      "val_loss": 9277.939375941423,
      "val_quality": 0.17604445728127804,
      "test_quality": 0.1683408546483206,
      "patience_counter": 7,
      "elbo_raw": -77754.6190957102,
      "elbo_relative": 441606093.33140606,
      "e_log_p_nodes": -9775.627343266262,
      "e_log_p_bonds": -1638.4570701950959,
      "e_log_p_tau": -0.0001191107541379022,
      "h_nodes": 13241.480967029263,
      "h_bonds": 101.5758483826823,
      "h_tau": -12.022319554074784,
      "tau_mean": 0.0001191107541379022,
      "bond_mean_avg": 8.78264294694512,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 7036.644756212624,
      "train_quality": 0.32620425503307293,
      "val_loss": 7997.224750841334,
      "val_quality": 0.289782203480452,
      "test_quality": 0.26967638364290925,
      "patience_counter": 8,
      "elbo_raw": -68594.19607188243,
      "elbo_relative": 441615253.7544299,
      "e_log_p_nodes": -9778.798248183355,
      "e_log_p_bonds": -2063.5564880667253,
      "e_log_p_tau": -0.0001380807875022221,
      "h_nodes": 21863.155365132665,
      "h_bonds": 76.80638673251961,
      "h_tau": -11.874534390837653,
      "tau_mean": 0.0001380807875022221,
      "bond_mean_avg": 10.217637935409055,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 6111.897383811395,
      "train_quality": 0.41475367969220056,
      "val_loss": 7538.108690906095,
      "val_quality": 0.33055539750624685,
      "test_quality": 0.3333778213991795,
      "patience_counter": 9,
      "elbo_raw": -60071.48669194783,
      "elbo_relative": 441623776.4638098,
      "e_log_p_nodes": -9798.961131891929,
      "e_log_p_bonds": -2421.0472321152115,
      "e_log_p_tau": -0.00015967401948767282,
      "h_nodes": 29819.627919853643,
      "h_bonds": 45.61795052501883,
      "h_tau": -11.729238962638192,
      "tau_mean": 0.00015967401948767282,
      "bond_mean_avg": 10.761712341611453,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5554.283022129967,
      "train_quality": 0.46814818762180355,
      "val_loss": 6958.608496628172,
      "val_quality": 0.3820196696613364,
      "test_quality": 0.36548204903976433,
      "patience_counter": 0,
      "elbo_raw": -52313.282330022485,
      "elbo_relative": 441631534.6681717,
      "e_log_p_nodes": -9830.619229079763,
      "e_log_p_bonds": -2740.3151441309146,
      "e_log_p_tau": -0.00017652639921854034,
      "h_nodes": 37288.80654178817,
      "h_bonds": 12.211551142284236,
      "h_tau": -11.62890288556082,
      "tau_mean": 0.00017652639921854034,
      "bond_mean_avg": 10.891603248896686,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5367.806993569481,
      "train_quality": 0.4860042481357941,
      "val_loss": 6889.593160813267,
      "val_quality": 0.3881487858554713,
      "test_quality": 0.36567694858573285,
      "patience_counter": 0,
      "elbo_raw": -45025.30841404222,
      "elbo_relative": 441638822.6420877,
      "e_log_p_nodes": -9864.555291348626,
      "e_log_p_bonds": -3047.4632925870765,
      "e_log_p_tau": -0.00018332890404459888,
      "h_nodes": 44697.95632844338,
      "h_bonds": -21.628857701311148,
      "h_tau": -11.591091491878615,
      "tau_mean": 0.00018332890404459888,
      "bond_mean_avg": 10.907529630546971,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 5258.3311538498065,
      "train_quality": 0.49648713558221125,
      "val_loss": 6878.907400631506,
      "val_quality": 0.3890977671942324,
      "test_quality": 0.37100238074531866,
      "patience_counter": 0,
      "elbo_raw": -37699.46720548291,
      "elbo_relative": 441646148.4832963,
      "e_log_p_nodes": -9898.810691777117,
      "e_log_p_bonds": -3351.2170843491454,
      "e_log_p_tau": -0.0001875498584483799,
      "h_nodes": 52242.91744886779,
      "h_bonds": -55.50062151812831,
      "h_tau": -11.568328599605593,
      "tau_mean": 0.0001875498584483799,
      "bond_mean_avg": 10.89741471779844,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 5230.955763115716,
      "train_quality": 0.499108473227138,
      "val_loss": 6846.781502072489,
      "val_quality": 0.3919508050413174,
      "test_quality": 0.3659990137247535,
      "patience_counter": 0,
      "elbo_raw": -30430.879339918603,
      "elbo_relative": 441653417.0711618,
      "e_log_p_nodes": -9932.907565510066,
      "e_log_p_bonds": -3652.7850790436314,
      "e_log_p_tau": -0.00018881025604101007,
      "h_nodes": 59835.898036464605,
      "h_bonds": -89.18048547590935,
      "h_tau": -11.561630746902665,
      "tau_mean": 0.00018881025604101007,
      "bond_mean_avg": 10.884223508313793,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5238.241376412552,
      "train_quality": 0.49841083743494485,
      "val_loss": 6928.716882064594,
      "val_quality": 0.3846742851424785,
      "test_quality": 0.3674512122801713,
      "patience_counter": 1,
      "elbo_raw": -23075.318100156,
      "elbo_relative": 441660772.6324016,
      "e_log_p_nodes": -9966.860474407466,
      "e_log_p_bonds": -3953.4224310982913,
      "e_log_p_tau": -0.00018865285293106918,
      "h_nodes": 67565.22216283687,
      "h_bonds": -122.74680837817901,
      "h_tau": -11.56246475221269,
      "tau_mean": 0.00018865285293106918,
      "bond_mean_avg": 10.871903119205458,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5291.8422037918535,
      "train_quality": 0.4932782762973382,
      "val_loss": 7153.121449709016,
      "val_quality": 0.3647453569796709,
      "test_quality": 0.36346454027870123,
      "patience_counter": 2,
      "elbo_raw": -15789.03603248339,
      "elbo_relative": 441668058.91446924,
      "e_log_p_nodes": -10000.593718468179,
      "e_log_p_bonds": -4252.484671438099,
      "e_log_p_tau": -0.0001867155472085276,
      "h_nodes": 75286.91935694891,
      "h_bonds": -156.10612816874522,
      "h_tau": -11.572787000564858,
      "tau_mean": 0.0001867155472085276,
      "bond_mean_avg": 10.861810858167306,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5318.5338914796985,
      "train_quality": 0.4907224068150573,
      "val_loss": 7237.058098501254,
      "val_quality": 0.357291108335954,
      "test_quality": 0.3563801585865143,
      "patience_counter": 3,
      "elbo_raw": -8409.514963419977,
      "elbo_relative": 441675438.4355383,
      "e_log_p_nodes": -10034.09012052736,
      "e_log_p_bonds": -4549.766208774907,
      "e_log_p_tau": -0.00018574669421716583,
      "h_nodes": 83065.26431974227,
      "h_bonds": -189.2328175683761,
      "h_tau": -11.577989434896153,
      "tau_mean": 0.00018574669421716583,
      "bond_mean_avg": 10.854045421651554,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5371.692969672994,
      "train_quality": 0.4856321454854112,
      "val_loss": 7209.278522059344,
      "val_quality": 0.3597581578666983,
      "test_quality": 0.3525331659198403,
      "patience_counter": 4,
      "elbo_raw": -998.7558547453373,
      "elbo_relative": 441682849.194647,
      "e_log_p_nodes": -10067.393603141569,
      "e_log_p_bonds": -4845.41186247002,
      "e_log_p_tau": -0.00018386273215133993,
      "h_nodes": 90906.32925360683,
      "h_bonds": -222.17306202076088,
      "h_tau": -11.588183863110316,
      "tau_mean": 0.00018386273215133993,
      "bond_mean_avg": 10.846628703731323,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5341.471174090241,
      "train_quality": 0.4885260413653958,
      "val_loss": 7321.440566112183,
      "val_quality": 0.34979726740004546,
      "test_quality": 0.3522416331207423,
      "patience_counter": 5,
      "elbo_raw": 6557.465712378937,
      "elbo_relative": 441690405.4162141,
      "e_log_p_nodes": -10100.578962956959,
      "e_log_p_bonds": -5139.921458112149,
      "e_log_p_tau": -0.00018478176054538648,
      "h_nodes": 98789.59121613108,
      "h_bonds": -254.9766129609377,
      "h_tau": -11.583197865402326,
      "tau_mean": 0.00018478176054538648,
      "bond_mean_avg": 10.839831437384067,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5318.991775673794,
      "train_quality": 0.49067856199520954,
      "val_loss": 7125.113467273647,
      "val_quality": 0.36723269079733223,
      "test_quality": 0.36304731792721123,
      "patience_counter": 6,
      "elbo_raw": 14054.658056234635,
      "elbo_relative": 441697902.608558,
      "e_log_p_nodes": -10133.855432092734,
      "e_log_p_bonds": -5435.082364067442,
      "e_log_p_tau": -0.0001856623501138866,
      "h_nodes": 106616.1973285994,
      "h_bonds": -287.8640107285263,
      "h_tau": -11.578443619342579,
      "tau_mean": 0.0001856623501138866,
      "bond_mean_avg": 10.832222282544436,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5298.225973916384,
      "train_quality": 0.4926669967321794,
      "val_loss": 7097.765571149421,
      "val_quality": 0.36966140364834355,
      "test_quality": 0.3608850099481328,
      "patience_counter": 7,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10167.13747706708,
      "e_log_p_bonds": -5730.440722764596,
      "e_log_p_tau": -0.000186473905578008,
      "h_nodes": 0.0,
      "h_bonds": -320.77137335896174,
      "h_tau": -11.574082008570258,
      "tau_mean": 0.000186473905578008,
      "bond_mean_avg": 10.824847958718946,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5316.021267450369,
      "train_quality": 0.49096300378112834,
      "val_loss": 7063.301282571328,
      "val_quality": 0.37272210931251426,
      "test_quality": 0.3545287674558192,
      "patience_counter": 8,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10200.315135938665,
      "e_log_p_bonds": -6025.1909430735805,
      "e_log_p_tau": -0.00018592239123226987,
      "h_nodes": 0.0,
      "h_bonds": -353.59783762210805,
      "h_tau": -11.577043986188073,
      "tau_mean": 0.00018592239123226987,
      "bond_mean_avg": 10.818480564358062,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}