{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed19540-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 19540
  },
  "hparams": {
    "seed": 19540,
    "fold": 4,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 54521.46438840632,
      "train_quality": -4.165848681138123,
      "val_loss": 52659.584027328056,
      "val_quality": -3.9793335811998576,
      "patience_counter": 0,
      "elbo_raw": -369271457.210166,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -105921.46341108611,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3732.349246791557,
      "train_quality": 0.6463640210260938,
      "val_loss": 6284.182900801345,
      "val_quality": 0.405786362989055,
      "test_quality": 0.3277811757220437,
      "patience_counter": 0,
      "elbo_raw": -2246551.3477239525,
      "elbo_relative": 367024905.862442,
      "e_log_p_nodes": -2152594.4510287545,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00026796768609447776,
      "h_nodes": -19463.484554509952,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.211506922423723,
      "tau_mean": 0.00026796768609447776,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7551.475086653584,
      "train_quality": 0.2845060554658906,
      "val_loss": 7924.376871084971,
      "val_quality": 0.25069450142637295,
      "test_quality": 0.21698907033279857,
      "patience_counter": 1,
      "elbo_raw": -107211.37223142682,
      "elbo_relative": 369164245.83793455,
      "e_log_p_nodes": -17327.494624009494,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013243614377882963,
      "h_nodes": -10660.784138425797,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.916272725873569,
      "tau_mean": 0.00013243614377882963,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8004.637542983058,
      "train_quality": 0.24156941200572857,
      "val_loss": 8241.478553171308,
      "val_quality": 0.22071030987924556,
      "test_quality": 0.19273757949685566,
      "patience_counter": 2,
      "elbo_raw": -104960.6962120762,
      "elbo_relative": 369166496.5139539,
      "e_log_p_nodes": -15702.15935342848,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012462512334097842,
      "h_nodes": -9627.476349278655,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.977063103411638,
      "tau_mean": 0.00012462512334097842,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8009.636796017734,
      "train_quality": 0.2410957382886787,
      "val_loss": 8228.044411695808,
      "val_quality": 0.2219806023249441,
      "test_quality": 0.19534939578892496,
      "patience_counter": 3,
      "elbo_raw": -104771.66940651076,
      "elbo_relative": 369166685.54075944,
      "e_log_p_nodes": -15569.637837474891,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012447210773333322,
      "h_nodes": -9562.727643605358,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.978291664854623,
      "tau_mean": 0.00012447210773333322,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8006.438765288152,
      "train_quality": 0.2413987481768387,
      "val_loss": 8213.572012167042,
      "val_quality": 0.22334906936290488,
      "test_quality": 0.196853582945396,
      "patience_counter": 4,
      "elbo_raw": -104716.01814388727,
      "elbo_relative": 369166741.1920221,
      "e_log_p_nodes": -15533.201834044223,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012450492981912707,
      "h_nodes": -9545.28999181807,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.978028009332775,
      "tau_mean": 0.00012450492981912707,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8011.1329387095075,
      "train_quality": 0.24095398041702598,
      "val_loss": 8210.827520587933,
      "val_quality": 0.22360858032060793,
      "test_quality": 0.19716861709254918,
      "patience_counter": 5,
      "elbo_raw": -99395.5878489292,
      "elbo_relative": 369172061.6223171,
      "e_log_p_nodes": -9817.256200215128,
      "e_log_p_bonds": -789.0775248339035,
      "e_log_p_tau": -0.00012442469278738512,
      "h_nodes": -9535.973320042393,
      "h_bonds": 137.38814068463853,
      "h_tau": -11.978672665711201,
      "tau_mean": 0.00012442469278738512,
      "bond_mean_avg": 5.125474135827838,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 8104.3744078853215,
      "train_quality": 0.23211945394250078,
      "val_loss": 8526.449231092955,
      "val_quality": 0.1937643304826715,
      "test_quality": 0.175315285515541,
      "patience_counter": 6,
      "elbo_raw": -87039.3268285533,
      "elbo_relative": 369184417.88333744,
      "e_log_p_nodes": -9810.484572753137,
      "e_log_p_bonds": -1195.5740788288877,
      "e_log_p_tau": -0.00012132718938909758,
      "h_nodes": 3405.5602833387675,
      "h_bonds": 121.0336626772894,
      "h_tau": -12.003882380609866,
      "tau_mean": 0.00012132718938909758,
      "bond_mean_avg": 6.896621310596506,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8210.413474999994,
      "train_quality": 0.2220723691631723,
      "val_loss": 8739.65035714857,
      "val_quality": 0.1736046663659282,
      "test_quality": 0.1428492279398299,
      "patience_counter": 7,
      "elbo_raw": -77821.50307993423,
      "elbo_relative": 369193635.707086,
      "e_log_p_nodes": -9781.217491897045,
      "e_log_p_bonds": -1635.8461030937235,
      "e_log_p_tau": -0.00011894427967157844,
      "h_nodes": 13187.666168285416,
      "h_bonds": 100.8661493038124,
      "h_tau": -12.023718175994873,
      "tau_mean": 0.00011894427967157844,
      "bond_mean_avg": 8.717723502857854,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 7021.594502379046,
      "train_quality": 0.3347116570237494,
      "val_loss": 7779.454362600081,
      "val_quality": 0.2643979426232508,
      "test_quality": 0.22543285895863163,
      "patience_counter": 8,
      "elbo_raw": -68696.89075861457,
      "elbo_relative": 369202760.31940734,
      "e_log_p_nodes": -9780.514174634043,
      "e_log_p_bonds": -2059.2356420834344,
      "e_log_p_tau": -0.0001383554011122198,
      "h_nodes": 21744.87790600207,
      "h_bonds": 76.44631528399671,
      "h_tau": -11.872547576436773,
      "tau_mean": 0.0001383554011122198,
      "bond_mean_avg": 10.16250191831137,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 6025.290186292708,
      "train_quality": 0.42911039328295486,
      "val_loss": 6962.9710050532585,
      "val_quality": 0.34160217953127237,
      "test_quality": 0.299838464738586,
      "patience_counter": 9,
      "elbo_raw": -60164.30822465655,
      "elbo_relative": 369211292.9019413,
      "e_log_p_nodes": -9799.588477059886,
      "e_log_p_bonds": -2418.506793450782,
      "e_log_p_tau": -0.00016180156101224186,
      "h_nodes": 29635.981034614215,
      "h_bonds": 45.70837951564366,
      "h_tau": -11.716002669025329,
      "tau_mean": 0.00016180156101224186,
      "bond_mean_avg": 10.7481766089472,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5497.614313291339,
      "train_quality": 0.47910710087674746,
      "val_loss": 6417.974020543758,
      "val_quality": 0.3931354727910996,
      "test_quality": 0.33213019439583713,
      "patience_counter": 10,
      "elbo_raw": -52289.5331016923,
      "elbo_relative": 369219167.6770643,
      "e_log_p_nodes": -9830.821322299696,
      "e_log_p_bonds": -2739.183298561172,
      "e_log_p_tau": -0.00017839985046556498,
      "h_nodes": 37240.62900754539,
      "h_bonds": 12.362066919323667,
      "h_tau": -11.618345939445135,
      "tau_mean": 0.00017839985046556498,
      "bond_mean_avg": 10.891976438797258,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5177.585137689489,
      "train_quality": 0.5094295126691221,
      "val_loss": 6266.6984645619705,
      "val_quality": 0.407439639256294,
      "test_quality": 0.3418793439059352,
      "patience_counter": 0,
      "elbo_raw": -44894.41043754464,
      "elbo_relative": 369226562.79972845,
      "e_log_p_nodes": -9864.596396096276,
      "e_log_p_bonds": -3045.4441078945656,
      "e_log_p_tau": -0.00019015841314724025,
      "h_nodes": 44581.15146004692,
      "h_bonds": -21.36254340081436,
      "h_tau": -11.554515843199624,
      "tau_mean": 0.00019015841314724025,
      "bond_mean_avg": 10.909096660724348,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 5058.2105358839635,
      "train_quality": 0.5207401246678268,
      "val_loss": 6237.956162870296,
      "val_quality": 0.4101574257838151,
      "test_quality": 0.3389778662842998,
      "patience_counter": 0,
      "elbo_raw": -37665.35467346753,
      "elbo_relative": 369233791.85549253,
      "e_log_p_nodes": -9898.469893667401,
      "e_log_p_bonds": -3346.329284297922,
      "e_log_p_tau": -0.0001950479557572448,
      "h_nodes": 52008.13163294871,
      "h_bonds": -54.90132247811418,
      "h_tau": -11.529127866102499,
      "tau_mean": 0.0001950479557572448,
      "bond_mean_avg": 10.900091966255918,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 5001.867553460639,
      "train_quality": 0.5260785601758946,
      "val_loss": 6200.877926686855,
      "val_quality": 0.41366343347396417,
      "test_quality": 0.34754608653938845,
      "patience_counter": 0,
      "elbo_raw": -30497.80461737235,
      "elbo_relative": 369240959.40554863,
      "e_log_p_nodes": -9932.145101195381,
      "e_log_p_bonds": -3644.648127335928,
      "e_log_p_tau": -0.00019753523368376107,
      "h_nodes": 59455.95485958834,
      "h_bonds": -88.22436396810953,
      "h_tau": -11.516456354562251,
      "tau_mean": 0.00019753523368376107,
      "bond_mean_avg": 10.886851716210165,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 4950.295242759121,
      "train_quality": 0.5309649797944647,
      "val_loss": 6125.012282094985,
      "val_quality": 0.42083706309435076,
      "test_quality": 0.3491542416947555,
      "patience_counter": 0,
      "elbo_raw": -23313.59700571958,
      "elbo_relative": 369248143.61316025,
      "e_log_p_nodes": -9965.612360942789,
      "e_log_p_bonds": -3941.2391966135096,
      "e_log_p_tau": -0.00019971440339892815,
      "h_nodes": 66929.71610378678,
      "h_bonds": -121.34392013495193,
      "h_tau": -11.505484958390298,
      "tau_mean": 0.00019971440339892815,
      "bond_mean_avg": 10.87448601065321,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5032.875590574923,
      "train_quality": 0.523140582822785,
      "val_loss": 6129.12777014684,
      "val_quality": 0.4204479147894763,
      "test_quality": 0.3545057040410391,
      "patience_counter": 1,
      "elbo_raw": -16247.682037185776,
      "elbo_relative": 369255209.5281288,
      "e_log_p_nodes": -9998.858024341951,
      "e_log_p_bonds": -4235.938633217114,
      "e_log_p_tau": -0.0001965325851593269,
      "h_nodes": 74464.24278476677,
      "h_bonds": -154.23275371072725,
      "h_tau": -11.521545076044276,
      "tau_mean": 0.0001965325851593269,
      "bond_mean_avg": 10.863505274586974,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5094.768827026782,
      "train_quality": 0.5172762668605713,
      "val_loss": 6300.542970442799,
      "val_quality": 0.4042394034818514,
      "test_quality": 0.34550249908304287,
      "patience_counter": 2,
      "elbo_raw": -8886.152860921167,
      "elbo_relative": 369262571.05730504,
      "e_log_p_nodes": -10031.986122544304,
      "e_log_p_bonds": -4529.833143211194,
      "e_log_p_tau": -0.00019407363131844117,
      "h_nodes": 82270.072976764,
      "h_bonds": -187.0181018815025,
      "h_tau": -11.534135691457777,
      "tau_mean": 0.00019407363131844117,
      "bond_mean_avg": 10.853513874911872,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5193.315672257165,
      "train_quality": 0.5079390618501358,
      "val_loss": 6415.0760629614915,
      "val_quality": 0.3934094950374354,
      "test_quality": 0.3392274872954273,
      "patience_counter": 3,
      "elbo_raw": -1590.602831043594,
      "elbo_relative": 369269866.6073349,
      "e_log_p_nodes": -10065.072828293583,
      "e_log_p_bonds": -4823.403113410432,
      "e_log_p_tau": -0.00019034695393097266,
      "h_nodes": 90055.14146689794,
      "h_bonds": -219.75502828963573,
      "h_tau": -11.553524841154285,
      "tau_mean": 0.00019034695393097266,
      "bond_mean_avg": 10.844338404502269,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5268.4900176264855,
      "train_quality": 0.5008163754506102,
      "val_loss": 6446.556342002854,
      "val_quality": 0.3904328135183628,
      "test_quality": 0.34176881889946165,
      "patience_counter": 4,
      "elbo_raw": 5858.197032130454,
      "elbo_relative": 369277315.40719813,
      "e_log_p_nodes": -10098.206610149866,
      "e_log_p_bonds": -5117.515407828316,
      "e_log_p_tau": -0.00018754578387370087,
      "h_nodes": 97963.44419013445,
      "h_bonds": -252.528236594,
      "h_tau": -11.56835032512754,
      "tau_mean": 0.00018754578387370087,
      "bond_mean_avg": 10.836685496591699,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5268.07116560748,
      "train_quality": 0.5008560612179358,
      "val_loss": 6559.594591188337,
      "val_quality": 0.37974425301174697,
      "test_quality": 0.3364316583582455,
      "patience_counter": 5,
      "elbo_raw": 13458.67867909724,
      "elbo_relative": 369284915.8888451,
      "e_log_p_nodes": -10131.384397515616,
      "e_log_p_bonds": -5411.981579522991,
      "e_log_p_tau": -0.0001874807209798334,
      "h_nodes": 105926.72124504157,
      "h_bonds": -285.34730724629605,
      "h_tau": -11.56869730271137,
      "tau_mean": 0.0001874807209798334,
      "bond_mean_avg": 10.82866116497676,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5224.781398014776,
      "train_quality": 0.504957719002335,
      "val_loss": 6428.573242039687,
      "val_quality": 0.39213324194358923,
      "test_quality": 0.33527353724390296,
      "patience_counter": 6,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10164.593831232396,
      "e_log_p_bonds": -5706.70156353934,
      "e_log_p_tau": -0.00018903585488055035,
      "h_nodes": 0.0,
      "h_bonds": -318.18099804919785,
      "h_tau": -11.560436615960498,
      "tau_mean": 0.00018903585488055035,
      "bond_mean_avg": 10.821493734932815,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5224.763714148381,
      "train_quality": 0.5049593945291925,
      "val_loss": 6463.919847275466,
      "val_quality": 0.3887909721235202,
      "test_quality": 0.33268368877413534,
      "patience_counter": 7,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10197.844709536894,
      "e_log_p_bonds": -6001.866464548825,
      "e_log_p_tau": -0.00018909247700377692,
      "h_nodes": 0.0,
      "h_bonds": -351.05134456381535,
      "h_tau": -11.560137129679788,
      "tau_mean": 0.00018909247700377692,
      "bond_mean_avg": 10.81515625011567,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}