{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed47659-fold3",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 3,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 3,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 65229.20673531464,
      "train_quality": -5.222822242405022,
      "val_loss": 65927.42869962429,
      "val_quality": -5.2261966897763985,
      "patience_counter": 0,
      "elbo_raw": -441112926.21459794,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -105730.28664019771,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3616.041354453934,
      "train_quality": 0.655032098408612,
      "val_loss": 7016.548241730942,
      "val_quality": 0.337356085350094,
      "test_quality": 0.32053393373518035,
      "patience_counter": 0,
      "elbo_raw": -2206557.0788939423,
      "elbo_relative": 438906369.135704,
      "e_log_p_nodes": -2112573.165917527,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0002765867123844405,
      "h_nodes": -19702.958274957728,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.179848942418175,
      "tau_mean": 0.0002765867123844405,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7556.842106672745,
      "train_quality": 0.2790823697341235,
      "val_loss": 8109.991627858831,
      "val_quality": 0.23409112074506377,
      "test_quality": 0.23945029067926937,
      "patience_counter": 1,
      "elbo_raw": -107257.40189472119,
      "elbo_relative": 441005668.8127032,
      "e_log_p_nodes": -17417.46069225345,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013234003825226125,
      "h_nodes": -10611.972007538323,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.916998663764389,
      "tau_mean": 0.00013234003825226125,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8010.204868864394,
      "train_quality": 0.2358318685914047,
      "val_loss": 8437.300857762839,
      "val_quality": 0.20317998582053098,
      "test_quality": 0.2185321083125661,
      "patience_counter": 2,
      "elbo_raw": -104953.12715471562,
      "elbo_relative": 441007973.08744323,
      "e_log_p_nodes": -15689.254416744949,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012453882281782548,
      "h_nodes": -9628.163098380777,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.977755824234919,
      "tau_mean": 0.00012453882281782548,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8038.478524375136,
      "train_quality": 0.23313458096225603,
      "val_loss": 8442.551010530788,
      "val_quality": 0.2026841605710199,
      "test_quality": 0.21845972602773311,
      "patience_counter": 3,
      "elbo_raw": -104772.27538639502,
      "elbo_relative": 441008153.93921155,
      "e_log_p_nodes": -15549.479519969067,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001240255578829366,
      "h_nodes": -9559.375065745211,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.981885665067239,
      "tau_mean": 0.0001240255578829366,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8041.259261685059,
      "train_quality": 0.2328693005020368,
      "val_loss": 8439.72058925773,
      "val_quality": 0.20295146599925484,
      "test_quality": 0.21911600693005218,
      "patience_counter": 4,
      "elbo_raw": -104715.5591823905,
      "elbo_relative": 441008210.65541553,
      "e_log_p_nodes": -15509.30483164502,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001239639242008658,
      "h_nodes": -9539.493209247858,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.98238273197785,
      "tau_mean": 0.0001239639242008658,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8045.137320117524,
      "train_quality": 0.23249933634826736,
      "val_loss": 8438.79635182221,
      "val_quality": 0.203038751127389,
      "test_quality": 0.2193384417287374,
      "patience_counter": 5,
      "elbo_raw": -99415.48490204121,
      "elbo_relative": 441013510.7296959,
      "e_log_p_nodes": -9821.83946353601,
      "e_log_p_bonds": -783.7154130341307,
      "e_log_p_tau": -0.00012389554178241058,
      "h_nodes": -9528.783069584904,
      "h_bonds": 138.1317192363419,
      "h_tau": -11.982934515792294,
      "tau_mean": 0.00012389554178241058,
      "bond_mean_avg": 5.134432562828403,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 8076.610722313371,
      "train_quality": 0.2294967950476624,
      "val_loss": 8293.751888103374,
      "val_quality": 0.2167367729930857,
      "test_quality": 0.20735225971266624,
      "patience_counter": 6,
      "elbo_raw": -86975.44351884496,
      "elbo_relative": 441025950.7710791,
      "e_log_p_nodes": -9811.873303308572,
      "e_log_p_bonds": -1192.4803112985626,
      "e_log_p_tau": -0.0001216920415661351,
      "h_nodes": 3445.803418184764,
      "h_bonds": 122.80954790154152,
      "h_tau": -12.000879717401403,
      "tau_mean": 0.0001216920415661351,
      "bond_mean_avg": 6.9897423472929265,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8209.003480598129,
      "train_quality": 0.21686661537476282,
      "val_loss": 8666.410863321536,
      "val_quality": 0.18154280101989972,
      "test_quality": 0.1641599431734193,
      "patience_counter": 7,
      "elbo_raw": -77783.43337277298,
      "elbo_relative": 441035142.78122514,
      "e_log_p_nodes": -9776.421839801897,
      "e_log_p_bonds": -1641.004491167749,
      "e_log_p_tau": -0.00011903841725113197,
      "h_nodes": 13218.473490952412,
      "h_bonds": 103.1936036472791,
      "h_tau": -12.022927046338737,
      "tau_mean": 0.00011903841725113197,
      "bond_mean_avg": 8.90793541668248,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6898.292646908256,
      "train_quality": 0.3419075431656383,
      "val_loss": 7782.87562226503,
      "val_quality": 0.264984007535484,
      "test_quality": 0.2611962387752995,
      "patience_counter": 8,
      "elbo_raw": -68490.67906256205,
      "elbo_relative": 441044435.5355354,
      "e_log_p_nodes": -9777.129405133352,
      "e_log_p_bonds": -2058.038928913296,
      "e_log_p_tau": -0.00014075507899866135,
      "h_nodes": 21830.819899548216,
      "h_bonds": 76.74233951287644,
      "h_tau": -11.855351969774347,
      "tau_mean": 0.00014075507899866135,
      "bond_mean_avg": 10.17636279466517,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 5881.238672157454,
      "train_quality": 0.4389338050591358,
      "val_loss": 6781.25682568359,
      "val_quality": 0.3595770435252029,
      "test_quality": 0.32153633757360534,
      "patience_counter": 0,
      "elbo_raw": -59958.53237911958,
      "elbo_relative": 441052967.68221885,
      "e_log_p_nodes": -9798.68939768339,
      "e_log_p_bonds": -2418.38750331955,
      "e_log_p_tau": -0.00016584481138236094,
      "h_nodes": 29675.13285080907,
      "h_bonds": 45.66435752249235,
      "h_tau": -11.691320841491688,
      "tau_mean": 0.00016584481138236094,
      "bond_mean_avg": 10.74747442475888,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5233.401132516273,
      "train_quality": 0.5007370685497146,
      "val_loss": 6436.571114602877,
      "val_quality": 0.3921292160529962,
      "test_quality": 0.3527957147256774,
      "patience_counter": 0,
      "elbo_raw": -52036.4786555202,
      "elbo_relative": 441060889.7359424,
      "e_log_p_nodes": -9830.307101713883,
      "e_log_p_bonds": -2739.8501063492718,
      "e_log_p_tau": -0.00018736808055586226,
      "h_nodes": 37164.86457850245,
      "h_bonds": 12.175106691180375,
      "h_tau": -11.569298293972679,
      "tau_mean": 0.00018736808055586226,
      "bond_mean_avg": 10.887344803864256,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 4982.0777784851125,
      "train_quality": 0.5247131466867223,
      "val_loss": 6313.0611679336325,
      "val_quality": 0.40379351475650216,
      "test_quality": 0.36328103563230596,
      "patience_counter": 0,
      "elbo_raw": -44759.67143443308,
      "elbo_relative": 441068166.5431635,
      "e_log_p_nodes": -9864.23254083695,
      "e_log_p_bonds": -3047.777707543497,
      "e_log_p_tau": -0.00019776182870907783,
      "h_nodes": 44455.06228878921,
      "h_bonds": -21.674143085091302,
      "h_tau": -11.51530990005267,
      "tau_mean": 0.00019776182870907783,
      "bond_mean_avg": 10.908254189006053,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 4957.029125809338,
      "train_quality": 0.5271027712247851,
      "val_loss": 6442.267822746117,
      "val_quality": 0.3915912180439176,
      "test_quality": 0.3583757542275151,
      "patience_counter": 1,
      "elbo_raw": -37808.156011996936,
      "elbo_relative": 441075118.05858594,
      "e_log_p_nodes": -9898.143763230579,
      "e_log_p_bonds": -3349.716880107567,
      "e_log_p_tau": -0.00019923637410764776,
      "h_nodes": 51726.175681727786,
      "h_bonds": -55.27680338790731,
      "h_tau": -11.507881391968112,
      "tau_mean": 0.00019923637410764776,
      "bond_mean_avg": 10.902869062378926,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4996.85106564398,
      "train_quality": 0.5233037850751565,
      "val_loss": 6488.922983429536,
      "val_quality": 0.3871850973633799,
      "test_quality": 0.3601568797522634,
      "patience_counter": 2,
      "elbo_raw": -30765.298583204356,
      "elbo_relative": 441082160.91601473,
      "e_log_p_nodes": -9931.768379567055,
      "e_log_p_bonds": -3648.620008891226,
      "e_log_p_tau": -0.00019780661269348638,
      "h_nodes": 59183.235203467964,
      "h_bonds": -88.61973038577958,
      "h_tau": -11.515083471553226,
      "tau_mean": 0.00019780661269348638,
      "bond_mean_avg": 10.892876742143681,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5148.904838224042,
      "train_quality": 0.5087979579248696,
      "val_loss": 6399.556223804565,
      "val_quality": 0.39562490813604256,
      "test_quality": 0.3584265253888237,
      "patience_counter": 3,
      "elbo_raw": -23689.236576972617,
      "elbo_relative": 441089236.97802097,
      "e_log_p_nodes": -9965.1941582363,
      "e_log_p_bonds": -3945.8382685640886,
      "e_log_p_tau": -0.00019202554889690665,
      "h_nodes": 66822.16110289311,
      "h_bonds": -121.78258006757157,
      "h_tau": -11.544744891041773,
      "tau_mean": 0.00019202554889690665,
      "bond_mean_avg": 10.882576247177077,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5269.60262093415,
      "train_quality": 0.49728347101864157,
      "val_loss": 6548.4805421791,
      "val_quality": 0.3815604721891266,
      "test_quality": 0.3503434843448078,
      "patience_counter": 4,
      "elbo_raw": -16402.612072616976,
      "elbo_relative": 441096523.6025253,
      "e_log_p_nodes": -9998.493879139787,
      "e_log_p_bonds": -4241.879186805669,
      "e_log_p_tau": -0.00018757452161258665,
      "h_nodes": 74628.53811316448,
      "h_bonds": -154.80380712293206,
      "h_tau": -11.56819710633863,
      "tau_mean": 0.00018757452161258665,
      "bond_mean_avg": 10.872968199511133,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5263.48795163211,
      "train_quality": 0.4978668063379271,
      "val_loss": 6608.61631332282,
      "val_quality": 0.3758812405458285,
      "test_quality": 0.3467585965027803,
      "patience_counter": 5,
      "elbo_raw": -8869.382444467497,
      "elbo_relative": 441104056.8321535,
      "e_log_p_nodes": -10031.74633143616,
      "e_log_p_bonds": -4537.1043970483215,
      "e_log_p_tau": -0.00018773485174467024,
      "h_nodes": 82517.43437956335,
      "h_bonds": -187.72801222251422,
      "h_tau": -11.567342717120482,
      "tau_mean": 0.00018773485174467024,
      "bond_mean_avg": 10.863629866824164,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5256.530494028447,
      "train_quality": 0.4985305430916538,
      "val_loss": 6647.922469053962,
      "val_quality": 0.3721691610437432,
      "test_quality": 0.3475357879069123,
      "patience_counter": 6,
      "elbo_raw": -1406.315861449897,
      "elbo_relative": 441111519.8987365,
      "e_log_p_nodes": -10065.01289560189,
      "e_log_p_bonds": -4832.23579938013,
      "e_log_p_tau": -0.0001879756910813738,
      "h_nodes": 90333.1892687658,
      "h_bonds": -220.6172902072755,
      "h_tau": -11.566060669683793,
      "tau_mean": 0.0001879756910813738,
      "bond_mean_avg": 10.855701689761963,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5257.474461239698,
      "train_quality": 0.498440489257608,
      "val_loss": 6711.024639975227,
      "val_quality": 0.366209782140954,
      "test_quality": 0.35535690259185315,
      "patience_counter": 7,
      "elbo_raw": 6218.030799852117,
      "elbo_relative": 441119144.2453978,
      "e_log_p_nodes": -10098.280366673998,
      "e_log_p_bonds": -5127.175713523527,
      "e_log_p_tau": -0.0001878730099039728,
      "h_nodes": 98322.27108589972,
      "h_bonds": -253.4843581773324,
      "h_tau": -11.56660706603725,
      "tau_mean": 0.0001878730099039728,
      "bond_mean_avg": 10.847778390815453,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5347.380180096986,
      "train_quality": 0.4898635444344901,
      "val_loss": 6730.8055490945,
      "val_quality": 0.3643416699862948,
      "test_quality": 0.3538981616345186,
      "patience_counter": 8,
      "elbo_raw": 13557.831022261598,
      "elbo_relative": 441126484.0456202,
      "e_log_p_nodes": -10131.567571054027,
      "e_log_p_bonds": -5422.331191639997,
      "e_log_p_tau": -0.00018469608177481913,
      "h_nodes": 106137.86940301416,
      "h_bonds": -286.38130955344957,
      "h_tau": -11.583661648408452,
      "tau_mean": 0.00018469608177481913,
      "bond_mean_avg": 10.839535734912953,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5429.591094575243,
      "train_quality": 0.48202067874918986,
      "val_loss": 6832.703532289974,
      "val_quality": 0.3547184084974062,
      "test_quality": 0.34874450112813093,
      "patience_counter": 9,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10164.83050075323,
      "e_log_p_bonds": -5717.445205245352,
      "e_log_p_tau": -0.00018187532519361142,
      "h_nodes": 0.0,
      "h_bonds": -319.2670374563495,
      "h_tau": -11.599051895456796,
      "tau_mean": 0.00018187532519361142,
      "bond_mean_avg": 10.83180898931407,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5323.754231326537,
      "train_quality": 0.4921174439814101,
      "val_loss": 6693.407976062604,
      "val_quality": 0.3678735026394041,
      "test_quality": 0.3580478995911195,
      "patience_counter": 10,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10198.135458479264,
      "e_log_p_bonds": -6012.685094522059,
      "e_log_p_tau": -0.00018532928032348773,
      "h_nodes": 0.0,
      "h_bonds": -352.1577033840965,
      "h_tau": -11.580239184804668,
      "tau_mean": 0.00018532928032348773,
      "bond_mean_avg": 10.82458955844523,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}