{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed47659-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 47659
  },
  "hparams": {
    "seed": 47659,
    "fold": 4,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 64086.794221749784,
      "train_quality": -5.184900899284764,
      "val_loss": 65368.93886846138,
      "val_quality": -5.367095627927173,
      "patience_counter": 0,
      "elbo_raw": -433435313.7935685,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -105730.28664019771,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3598.982020859059,
      "train_quality": 0.6526687376450715,
      "val_loss": 6818.31932330167,
      "val_quality": 0.33587890663847253,
      "test_quality": 0.38808624407549486,
      "patience_counter": 0,
      "elbo_raw": -2178744.5940270326,
      "elbo_relative": 431256569.19954145,
      "e_log_p_nodes": -2084836.572314693,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00027789774555210365,
      "h_nodes": -19658.810020976904,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.175120097119361,
      "tau_mean": 0.00027789774555210365,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7439.21484594422,
      "train_quality": 0.282054795385009,
      "val_loss": 7912.454970552883,
      "val_quality": 0.22930740010092965,
      "test_quality": 0.23769227976325202,
      "patience_counter": 1,
      "elbo_raw": -107120.57958399924,
      "elbo_relative": 433328193.2139845,
      "e_log_p_nodes": -17407.59720099508,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00013443207504550595,
      "h_nodes": -10590.278872470359,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.901314268165152,
      "tau_mean": 0.00013443207504550595,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 7867.539504514501,
      "train_quality": 0.24071795527391315,
      "val_loss": 8153.579836171288,
      "val_quality": 0.20582124437867133,
      "test_quality": 0.21136474367097635,
      "patience_counter": 2,
      "elbo_raw": -104838.02011010025,
      "elbo_relative": 433330475.7734584,
      "e_log_p_nodes": -15687.514588849652,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012679412022490962,
      "h_nodes": -9635.24742258404,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.959808650928608,
      "tau_mean": 0.00012679412022490962,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 7891.507545857449,
      "train_quality": 0.23840484284168317,
      "val_loss": 8134.861608156548,
      "val_quality": 0.20764444588412967,
      "test_quality": 0.209379970538344,
      "patience_counter": 3,
      "elbo_raw": -104652.04912321367,
      "elbo_relative": 433330661.74444526,
      "e_log_p_nodes": -15552.312254309789,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012633039577871654,
      "h_nodes": -9559.889168730579,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.963472657655075,
      "tau_mean": 0.00012633039577871654,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 7898.553077821307,
      "train_quality": 0.23772489126182372,
      "val_loss": 8127.030022331489,
      "val_quality": 0.2084072616301036,
      "test_quality": 0.20785281781254528,
      "patience_counter": 4,
      "elbo_raw": -104598.42382587779,
      "elbo_relative": 433330715.36974263,
      "e_log_p_nodes": -15513.860772970289,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012619863672140891,
      "h_nodes": -9537.714309217994,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.964516173866286,
      "tau_mean": 0.00012619863672140891,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 7906.193075084811,
      "train_quality": 0.23698756890829664,
      "val_loss": 8128.999724425966,
      "val_quality": 0.20821540779537484,
      "test_quality": 0.20653358002774558,
      "patience_counter": 5,
      "elbo_raw": -99294.5906998844,
      "elbo_relative": 433336019.2028686,
      "e_log_p_nodes": -9819.580982586882,
      "e_log_p_bonds": -784.2801033647704,
      "e_log_p_tau": -0.00012606839017724537,
      "h_nodes": -9526.433747044859,
      "h_bonds": 138.3091725013183,
      "h_tau": -11.96554878250754,
      "tau_mean": 0.00012606839017724537,
      "bond_mean_avg": 5.150818723876865,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7973.5275050193895,
      "train_quality": 0.23048924454502473,
      "val_loss": 8348.288504551896,
      "val_quality": 0.18685614057516098,
      "test_quality": 0.1910510043994993,
      "patience_counter": 6,
      "elbo_raw": -86902.4537463616,
      "elbo_relative": 433348411.3398221,
      "e_log_p_nodes": -9811.253942469468,
      "e_log_p_bonds": -1192.2077095688562,
      "e_log_p_tau": -0.00012329303737160447,
      "h_nodes": 3430.774639974725,
      "h_bonds": 122.22775319053795,
      "h_tau": -11.987809381818806,
      "tau_mean": 0.00012329303737160447,
      "bond_mean_avg": 6.950956676656377,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8221.465489373542,
      "train_quality": 0.2065611969492469,
      "val_loss": 8855.86907886578,
      "val_quality": 0.1374165426334243,
      "test_quality": 0.16739780106569957,
      "patience_counter": 7,
      "elbo_raw": -77835.35558677537,
      "elbo_relative": 433357478.4379817,
      "e_log_p_nodes": -9778.340598692876,
      "e_log_p_bonds": -1635.754452007236,
      "e_log_p_tau": -0.00011885104248109632,
      "h_nodes": 13174.45810922188,
      "h_bonds": 102.51566016579369,
      "h_tau": -12.02450235622382,
      "tau_mean": 0.00011885104248109632,
      "bond_mean_avg": 8.826464571695734,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 6898.835929257062,
      "train_quality": 0.3342057898037415,
      "val_loss": 7704.1179909997145,
      "val_quality": 0.24959993497468347,
      "test_quality": 0.26536401709996593,
      "patience_counter": 8,
      "elbo_raw": -68559.9093105736,
      "elbo_relative": 433366753.8842579,
      "e_log_p_nodes": -9777.030884741478,
      "e_log_p_bonds": -2057.4196163850456,
      "e_log_p_tau": -0.00014080595152098828,
      "h_nodes": 21757.953976293236,
      "h_bonds": 77.22622672564606,
      "h_tau": -11.854990609237575,
      "tau_mean": 0.00014080595152098828,
      "bond_mean_avg": 10.203177590018537,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 5973.11061000672,
      "train_quality": 0.423545870378079,
      "val_loss": 7091.813607739721,
      "val_quality": 0.3092398898079768,
      "test_quality": 0.32783826335772903,
      "patience_counter": 9,
      "elbo_raw": -60068.98106134778,
      "elbo_relative": 433375244.81250715,
      "e_log_p_nodes": -9798.53599098038,
      "e_log_p_bonds": -2414.946259968927,
      "e_log_p_tau": -0.00016326849098903472,
      "h_nodes": 29665.867714578562,
      "h_bonds": 45.96431792140345,
      "h_tau": -11.706977291723888,
      "tau_mean": 0.00016326849098903472,
      "bond_mean_avg": 10.742298680586712,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5453.374602008027,
      "train_quality": 0.47370465491860525,
      "val_loss": 6745.620244198595,
      "val_quality": 0.34295997597696903,
      "test_quality": 0.34902334690046655,
      "patience_counter": 0,
      "elbo_raw": -52354.2568377331,
      "elbo_relative": 433382959.53673077,
      "e_log_p_nodes": -9829.828311095915,
      "e_log_p_bonds": -2736.1765349553357,
      "e_log_p_tau": -0.00017971993753577862,
      "h_nodes": 37122.111346214086,
      "h_bonds": 12.68009504551631,
      "h_tau": -11.610973584749445,
      "tau_mean": 0.00017971993753577862,
      "bond_mean_avg": 10.893762323295341,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5106.9124476533825,
      "train_quality": 0.5071410924258655,
      "val_loss": 6659.697627260582,
      "val_quality": 0.35132905046580154,
      "test_quality": 0.36617901770373595,
      "patience_counter": 0,
      "elbo_raw": -44863.871463702315,
      "elbo_relative": 433390449.9221048,
      "e_log_p_nodes": -9863.726795389082,
      "e_log_p_bonds": -3043.8884939891013,
      "e_log_p_tau": -0.0001926775237582241,
      "h_nodes": 44520.74192920897,
      "h_bonds": -21.161007535097497,
      "h_tau": -11.541355391287652,
      "tau_mean": 0.0001926775237582241,
      "bond_mean_avg": 10.913544080847753,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 4911.576375809978,
      "train_quality": 0.5259926243378331,
      "val_loss": 6614.15603041308,
      "val_quality": 0.3557649141526824,
      "test_quality": 0.3620081553877861,
      "patience_counter": 0,
      "elbo_raw": -37624.551515700456,
      "elbo_relative": 433397689.2420528,
      "e_log_p_nodes": -9897.88048345587,
      "e_log_p_bonds": -3346.815758054371,
      "e_log_p_tau": -0.0002009338177735577,
      "h_nodes": 51849.33153552591,
      "h_bonds": -54.93073387704494,
      "h_tau": -11.499397732361103,
      "tau_mean": 0.0002009338177735577,
      "bond_mean_avg": 10.9040379673193,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4852.706295571463,
      "train_quality": 0.5316740695814242,
      "val_loss": 6526.672623963432,
      "val_quality": 0.36428601338365796,
      "test_quality": 0.3703543544150244,
      "patience_counter": 0,
      "elbo_raw": -30559.24715374435,
      "elbo_relative": 433404754.54641473,
      "e_log_p_nodes": -9931.794379311792,
      "e_log_p_bonds": -3646.79649876627,
      "e_log_p_tau": -0.00020375793793260644,
      "h_nodes": 59188.37716625621,
      "h_bonds": -88.435854454931,
      "h_tau": -11.485440610849764,
      "tau_mean": 0.00020375793793260644,
      "bond_mean_avg": 10.890757599768992,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 4928.465912912746,
      "train_quality": 0.5243626455803693,
      "val_loss": 6628.00244024607,
      "val_quality": 0.35441623973580805,
      "test_quality": 0.3834141008301222,
      "patience_counter": 1,
      "elbo_raw": -23479.549656014176,
      "elbo_relative": 433411834.24391246,
      "e_log_p_nodes": -9965.44033556209,
      "e_log_p_bonds": -3944.77847498305,
      "e_log_p_tau": -0.00020076447237926334,
      "h_nodes": 66732.28950179253,
      "h_bonds": -121.70327202524903,
      "h_tau": -11.500240879606281,
      "tau_mean": 0.00020076447237926334,
      "bond_mean_avg": 10.878731410842105,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5053.183560096669,
      "train_quality": 0.5123263704383254,
      "val_loss": 6719.252794149276,
      "val_quality": 0.3455282305461067,
      "test_quality": 0.37608668807426815,
      "patience_counter": 2,
      "elbo_raw": -16158.970686797431,
      "elbo_relative": 433419154.8228817,
      "e_log_p_nodes": -9998.88055562419,
      "e_log_p_bonds": -4241.2137030784925,
      "e_log_p_tau": -0.0001957531200319571,
      "h_nodes": 74585.45552726754,
      "h_bonds": -154.77632070780191,
      "h_tau": -11.525519047783746,
      "tau_mean": 0.0001957531200319571,
      "bond_mean_avg": 10.868275954917262,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5115.998826273207,
      "train_quality": 0.5062641824168777,
      "val_loss": 6776.177896205726,
      "val_quality": 0.33998358541805496,
      "test_quality": 0.3779669598666274,
      "patience_counter": 3,
      "elbo_raw": -8676.735114521405,
      "elbo_relative": 433426637.058454,
      "e_log_p_nodes": -10032.236553899502,
      "e_log_p_bonds": -4537.017229145245,
      "e_log_p_tau": -0.00019322960799797857,
      "h_nodes": 82516.92092265106,
      "h_bonds": -187.7672381101629,
      "h_tau": -11.53849416084995,
      "tau_mean": 0.00019322960799797857,
      "bond_mean_avg": 10.858625541332795,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5170.879656762286,
      "train_quality": 0.5009677324700927,
      "val_loss": 6822.3568656177995,
      "val_quality": 0.33548564007374626,
      "test_quality": 0.3753024506943189,
      "patience_counter": 4,
      "elbo_raw": -1076.4869107523264,
      "elbo_relative": 433434237.30665773,
      "e_log_p_nodes": -10065.60044562926,
      "e_log_p_bonds": -4832.955358067604,
      "e_log_p_tau": -0.0001911511449550726,
      "h_nodes": 90552.04506007474,
      "h_bonds": -220.76393015204894,
      "h_tau": -11.549308871442918,
      "tau_mean": 0.0001911511449550726,
      "bond_mean_avg": 10.84958314893694,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5179.421591652365,
      "train_quality": 0.500143365743299,
      "val_loss": 6716.779069737321,
      "val_quality": 0.3457691773957985,
      "test_quality": 0.3762610135977702,
      "patience_counter": 5,
      "elbo_raw": 6523.271287942625,
      "elbo_relative": 433441837.0648564,
      "e_log_p_nodes": -10099.05644030534,
      "e_log_p_bonds": -5129.77571214604,
      "e_log_p_tau": -0.00019085432891763164,
      "h_nodes": 98525.59657878213,
      "h_bonds": -253.8457536712618,
      "h_tau": -11.550862860152847,
      "tau_mean": 0.00019085432891763164,
      "bond_mean_avg": 10.841363409438223,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5196.502986497422,
      "train_quality": 0.4984948711412337,
      "val_loss": 6755.589864240801,
      "val_quality": 0.34198891043297186,
      "test_quality": 0.3726780417109008,
      "patience_counter": 6,
      "elbo_raw": 14025.385412561503,
      "elbo_relative": 433449339.17898107,
      "e_log_p_nodes": -10132.457235600537,
      "e_log_p_bonds": -5426.377846496765,
      "e_log_p_tau": -0.00019024536731205763,
      "h_nodes": 106412.18558869949,
      "h_bonds": -286.8770135085029,
      "h_tau": -11.554058675472334,
      "tau_mean": 0.00019024536731205763,
      "bond_mean_avg": 10.834936473162596,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5188.5011782661595,
      "train_quality": 0.4992671112185606,
      "val_loss": 6904.59679420069,
      "val_quality": 0.3274752684999497,
      "test_quality": 0.3600625090424996,
      "patience_counter": 7,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10165.830811024505,
      "e_log_p_bonds": -5723.05286743344,
      "e_log_p_tau": -0.00019056583273567356,
      "h_nodes": 0.0,
      "h_bonds": -319.9088282754366,
      "h_tau": -11.552375607854628,
      "tau_mean": 0.00019056583273567356,
      "bond_mean_avg": 10.829122625303935,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5262.747251624084,
      "train_quality": 0.4921017566169421,
      "val_loss": 7028.257873474443,
      "val_quality": 0.3154303748422289,
      "test_quality": 0.3567212251145203,
      "patience_counter": 8,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10199.112412395638,
      "e_log_p_bonds": -6019.234839150221,
      "e_log_p_tau": -0.00018789234940587738,
      "h_nodes": 0.0,
      "h_bonds": -352.8742206616353,
      "h_tau": -11.566504132111731,
      "tau_mean": 0.00018789234940587738,
      "bond_mean_avg": 10.824168402931035,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}