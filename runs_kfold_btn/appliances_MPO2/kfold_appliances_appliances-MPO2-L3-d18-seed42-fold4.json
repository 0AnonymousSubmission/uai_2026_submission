{
  "experiment_name": "kfold_appliances",
  "run_name": "appliances-MPO2-L3-d18-seed42-fold4",
  "config": {
    "params": {
      "model": "MPO2",
      "L": 3,
      "bond_dim": 18,
      "init_strength": 0.1,
      "bond_prior_alpha": 5.0,
      "added_bias": true,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 4,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 4,
    "dataset": "appliances",
    "n_features": 28,
    "n_train": 13420,
    "n_val": 2368,
    "n_test": 3947,
    "L": 3,
    "bond_dim": 18,
    "model": "MPO2",
    "init_strength": 0.1,
    "bond_prior_alpha": 5.0,
    "added_bias": true,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 66683.22798017289,
      "train_quality": -5.31250048286087,
      "val_loss": 65727.48013306715,
      "val_quality": -5.285143481685506,
      "patience_counter": 0,
      "elbo_raw": -450874838.4867709,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -106009.08764639017,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -1.0,
      "h_nodes": -6058.2757484830745,
      "h_bonds": 258.4299787944893,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 1,
      "train_loss": 3669.5921238430046,
      "train_quality": 0.6526217647929564,
      "val_loss": 7141.151791033334,
      "val_quality": 0.317132445359647,
      "test_quality": 0.3422928814491297,
      "patience_counter": 0,
      "elbo_raw": -2329945.9729808792,
      "elbo_relative": 448544892.5137901,
      "e_log_p_nodes": -2235847.3086486813,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0002725504516367984,
      "h_nodes": -19719.05821135154,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.194549580803141,
      "tau_mean": 0.0002725504516367984,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 2,
      "train_loss": 7652.73304029639,
      "train_quality": 0.2755617495535787,
      "val_loss": 8563.59731440906,
      "val_quality": 0.1811121051427721,
      "test_quality": 0.2539673316859842,
      "patience_counter": 1,
      "elbo_raw": -107466.39859800646,
      "elbo_relative": 450767372.0881729,
      "e_log_p_nodes": -17516.322427175073,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.0001306833038745889,
      "h_nodes": -10637.574846862932,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.929596452806436,
      "tau_mean": 0.0001306833038745889,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 3,
      "train_loss": 8123.01135390468,
      "train_quality": 0.2310433275807552,
      "val_loss": 8687.688822907467,
      "val_quality": 0.16924594301100804,
      "test_quality": 0.2270386828960893,
      "patience_counter": 2,
      "elbo_raw": -105110.2922011822,
      "elbo_relative": 450769728.19456977,
      "e_log_p_nodes": -15728.821730574973,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012282111585647546,
      "h_nodes": -9652.56334872433,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.991644367233675,
      "tau_mean": 0.00012282111585647546,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 4,
      "train_loss": 8132.168782388541,
      "train_quality": 0.2301764488546184,
      "val_loss": 8639.915203054452,
      "val_quality": 0.17381426138876732,
      "test_quality": 0.22956763159510984,
      "patience_counter": 3,
      "elbo_raw": -104878.02234584768,
      "elbo_relative": 450769960.4644251,
      "e_log_p_nodes": -15561.390039314801,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012260664524845892,
      "h_nodes": -9575.98906192054,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.9933920966796,
      "tau_mean": 0.00012260664524845892,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 5,
      "train_loss": 8122.628046237501,
      "train_quality": 0.23107961301425084,
      "val_loss": 8600.822422664887,
      "val_quality": 0.17755248067465823,
      "test_quality": 0.23177988011856665,
      "patience_counter": 4,
      "elbo_raw": -104802.17765890271,
      "elbo_relative": 450770036.309112,
      "e_log_p_nodes": -15517.871446442496,
      "e_log_p_bonds": -509.61221570343224,
      "e_log_p_tau": -0.00012273127484653456,
      "h_nodes": -9550.48429633114,
      "h_bonds": 258.4299787944893,
      "h_tau": -11.992376113426872,
      "tau_mean": 0.00012273127484653456,
      "bond_mean_avg": 5.0,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 6,
      "train_loss": 8121.344689928422,
      "train_quality": 0.23120110064414112,
      "val_loss": 8581.556616886517,
      "val_quality": 0.17939475963259477,
      "test_quality": 0.23248922456972798,
      "patience_counter": 5,
      "elbo_raw": -99485.97979041465,
      "elbo_relative": 450775352.50698054,
      "e_log_p_nodes": -9814.060028841046,
      "e_log_p_bonds": -789.8429247081386,
      "e_log_p_tau": -0.00012274243775335238,
      "h_nodes": -9537.050237435622,
      "h_bonds": 136.99970759037393,
      "h_tau": -11.992285163512861,
      "tau_mean": 0.00012274243775335238,
      "bond_mean_avg": 5.103133825823063,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 7,
      "train_loss": 7962.594023462224,
      "train_quality": 0.246229072280732,
      "val_loss": 8620.978402666988,
      "val_quality": 0.17562507944049077,
      "test_quality": 0.24347335053629304,
      "patience_counter": 6,
      "elbo_raw": -86881.31404142614,
      "elbo_relative": 450787957.1727295,
      "e_log_p_nodes": -9809.704534414826,
      "e_log_p_bonds": -1194.1666345173235,
      "e_log_p_tau": -0.00012340250575839236,
      "h_nodes": 3446.595330120605,
      "h_bonds": 121.99445989623823,
      "h_tau": -11.986921904142946,
      "tau_mean": 0.00012340250575839236,
      "bond_mean_avg": 6.949018629880078,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 8,
      "train_loss": 8335.735468376579,
      "train_quality": 0.2109060139564165,
      "val_loss": 9093.166151414849,
      "val_quality": 0.1304724622221516,
      "test_quality": 0.18456606173208512,
      "patience_counter": 7,
      "elbo_raw": -77928.05279489126,
      "elbo_relative": 450796910.43397605,
      "e_log_p_nodes": -9779.391394421878,
      "e_log_p_bonds": -1636.234749325761,
      "e_log_p_tau": -0.0001172754614766771,
      "h_nodes": 13173.201365337725,
      "h_bonds": 102.17041565755463,
      "h_tau": -12.037847782186873,
      "tau_mean": 0.0001172754614766771,
      "bond_mean_avg": 8.806772049101276,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 9,
      "train_loss": 7020.875298995831,
      "train_quality": 0.3353759249897933,
      "val_loss": 8184.213737045629,
      "val_quality": 0.2173903895604442,
      "test_quality": 0.27629997850369403,
      "patience_counter": 8,
      "elbo_raw": -68750.63568299165,
      "elbo_relative": 450806087.8510879,
      "e_log_p_nodes": -9777.923414696017,
      "e_log_p_bonds": -2057.5768153531917,
      "e_log_p_tau": -0.00013846149504714525,
      "h_nodes": 21681.14415739241,
      "h_bonds": 77.04025507037154,
      "h_tau": -11.871781048517732,
      "tau_mean": 0.00013846149504714525,
      "bond_mean_avg": 10.191187015564731,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 10,
      "train_loss": 5903.238333595487,
      "train_quality": 0.4411759004476481,
      "val_loss": 7320.747383612435,
      "val_quality": 0.2999587447133918,
      "test_quality": 0.348139152031531,
      "patience_counter": 9,
      "elbo_raw": -60046.47055170488,
      "elbo_relative": 450814792.0162192,
      "e_log_p_nodes": -9798.435234080922,
      "e_log_p_bonds": -2416.510161015602,
      "e_log_p_tau": -0.00016517964386674025,
      "h_nodes": 29611.67169380512,
      "h_bonds": 46.0286048822785,
      "h_tau": -11.69533968903852,
      "tau_mean": 0.00016517964386674025,
      "bond_mean_avg": 10.75681833164837,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 11,
      "train_loss": 5320.309627620767,
      "train_quality": 0.496358258131847,
      "val_loss": 7027.269088760236,
      "val_quality": 0.32802239766604,
      "test_quality": 0.3677414883637673,
      "patience_counter": 0,
      "elbo_raw": -52244.842981127505,
      "elbo_relative": 450822593.6437898,
      "e_log_p_nodes": -9830.031378638305,
      "e_log_p_bonds": -2736.683786027048,
      "e_log_p_tau": -0.00018435475335336587,
      "h_nodes": 37061.43494090337,
      "h_bonds": 12.611463403822611,
      "h_tau": -11.585511412646156,
      "tau_mean": 0.00018435475335336587,
      "bond_mean_avg": 10.892403191270377,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 12,
      "train_loss": 5038.809068584008,
      "train_quality": 0.5230062244746506,
      "val_loss": 7044.506649768004,
      "val_quality": 0.326374068169933,
      "test_quality": 0.3729642974615597,
      "patience_counter": 1,
      "elbo_raw": -44929.79470578892,
      "elbo_relative": 450829908.6920651,
      "e_log_p_nodes": -9863.953413884587,
      "e_log_p_bonds": -3044.691695663402,
      "e_log_p_tau": -0.00019549940368257838,
      "h_nodes": 44358.38798245061,
      "h_bonds": -21.277522092637483,
      "h_tau": -11.526815992190677,
      "tau_mean": 0.00019549940368257838,
      "bond_mean_avg": 10.911319637540869,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 13,
      "train_loss": 4967.356793997409,
      "train_quality": 0.5297701819417895,
      "val_loss": 7114.289582154808,
      "val_quality": 0.3197011249544639,
      "test_quality": 0.36953835226632226,
      "patience_counter": 2,
      "elbo_raw": -37833.478514327835,
      "elbo_relative": 450837005.0082566,
      "e_log_p_nodes": -9898.011158568035,
      "e_log_p_bonds": -3347.6285196498516,
      "e_log_p_tau": -0.00019878100456316095,
      "h_nodes": 51713.711945272196,
      "h_bonds": -54.99877744321381,
      "h_tau": -11.51016958222317,
      "tau_mean": 0.00019878100456316095,
      "bond_mean_avg": 10.905216483646718,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 14,
      "train_loss": 4995.264738448674,
      "train_quality": 0.5271283045438231,
      "val_loss": 7249.979205646851,
      "val_quality": 0.30672590133571576,
      "test_quality": 0.3620834200072114,
      "patience_counter": 3,
      "elbo_raw": -30788.749414713835,
      "elbo_relative": 450844049.7373562,
      "e_log_p_nodes": -9931.775932945067,
      "e_log_p_bonds": -3646.940012607987,
      "e_log_p_tau": -0.00019788388058729142,
      "h_nodes": 59155.27699340683,
      "h_bonds": -88.40627903648752,
      "h_tau": -11.514692924414703,
      "tau_mean": 0.00019788388058729142,
      "bond_mean_avg": 10.893660121397227,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 15,
      "train_loss": 5156.3078720779195,
      "train_quality": 0.5118833188167028,
      "val_loss": 7257.390993975432,
      "val_quality": 0.30601715435489885,
      "test_quality": 0.3609412323385133,
      "patience_counter": 4,
      "elbo_raw": -23768.927331725237,
      "elbo_relative": 450851069.5594392,
      "e_log_p_nodes": -9965.238704159556,
      "e_log_p_bonds": -3943.278078143233,
      "e_log_p_tau": -0.00019173357758618426,
      "h_nodes": 66749.89493082864,
      "h_bonds": -121.50644186465307,
      "h_tau": -11.546266529730929,
      "tau_mean": 0.00019173357758618426,
      "bond_mean_avg": 10.880712990218806,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 16,
      "train_loss": 5305.664177416123,
      "train_quality": 0.49774465489590314,
      "val_loss": 7221.958584917648,
      "val_quality": 0.3094053532388221,
      "test_quality": 0.364317267958864,
      "patience_counter": 5,
      "elbo_raw": -16599.402875359403,
      "elbo_relative": 450858239.08389556,
      "e_log_p_nodes": -9998.470367181842,
      "e_log_p_bonds": -4237.4705372805565,
      "e_log_p_tau": -0.00018624837496490214,
      "h_nodes": 74474.47386727108,
      "h_bonds": -154.3460553721709,
      "h_tau": -11.575292189190804,
      "tau_mean": 0.00018624837496490214,
      "bond_mean_avg": 10.869141666420473,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 17,
      "train_loss": 5358.316989382934,
      "train_quality": 0.4927603295860471,
      "val_loss": 7044.281759137753,
      "val_quality": 0.32639557317630086,
      "test_quality": 0.3671935031702078,
      "patience_counter": 6,
      "elbo_raw": -9085.833634118331,
      "elbo_relative": 450865752.6531368,
      "e_log_p_nodes": -10031.52489666975,
      "e_log_p_bonds": -4530.199211388831,
      "e_log_p_tau": -0.00018432408549851485,
      "h_nodes": 82416.1826570306,
      "h_bonds": -187.0045147047473,
      "h_tau": -11.585677778879472,
      "tau_mean": 0.00018432408549851485,
      "bond_mean_avg": 10.858792550623688,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 18,
      "train_loss": 5394.873597172631,
      "train_quality": 0.4892997352010118,
      "val_loss": 6884.109270563539,
      "val_quality": 0.3417119533337246,
      "test_quality": 0.36792190750165454,
      "patience_counter": 0,
      "elbo_raw": -1579.2307515393331,
      "elbo_relative": 450873259.2560194,
      "e_log_p_nodes": -10064.596383089687,
      "e_log_p_bonds": -4823.231876442302,
      "e_log_p_tau": -0.00018302654486339348,
      "h_nodes": 90328.96950887778,
      "h_bonds": -219.67101815325265,
      "h_tau": -11.592742125169025,
      "tau_mean": 0.00018302654486339348,
      "bond_mean_avg": 10.850064459498771,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 19,
      "train_loss": 5405.097014724639,
      "train_quality": 0.4883319456954899,
      "val_loss": 6918.300970619389,
      "val_quality": 0.33844239636457407,
      "test_quality": 0.36579795200590404,
      "patience_counter": 1,
      "elbo_raw": 5990.812164167961,
      "elbo_relative": 450880829.2989351,
      "e_log_p_nodes": -10097.733716673169,
      "e_log_p_bonds": -5116.87524425027,
      "e_log_p_tau": -0.00018268072353113163,
      "h_nodes": 98271.20918612058,
      "h_bonds": -252.4015933000331,
      "h_tau": -11.594633372435055,
      "tau_mean": 0.00018268072353113163,
      "bond_mean_avg": 10.84159490924161,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 20,
      "train_loss": 5367.616734648684,
      "train_quality": 0.491879978585373,
      "val_loss": 7099.230237631107,
      "val_quality": 0.3211411640504398,
      "test_quality": 0.3637708513296838,
      "patience_counter": 2,
      "elbo_raw": 13601.584042364688,
      "elbo_relative": 450888440.0708133,
      "e_log_p_nodes": -10130.960400881202,
      "e_log_p_bonds": -5411.279273431233,
      "e_log_p_tau": -0.000183945866340481,
      "h_nodes": 106196.12330986965,
      "h_bonds": -285.22471452408246,
      "h_tau": -11.587731811741833,
      "tau_mean": 0.000183945866340481,
      "bond_mean_avg": 10.832653784634342,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 21,
      "train_loss": 5332.448764841452,
      "train_quality": 0.4952091189571526,
      "val_loss": 7033.4666055625285,
      "val_quality": 0.327429764535214,
      "test_quality": 0.371663504931522,
      "patience_counter": 3,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10164.19839829065,
      "e_log_p_bonds": -5706.0418449585195,
      "e_log_p_tau": -0.00018517452743395906,
      "h_nodes": 0.0,
      "h_bonds": -318.0648180808273,
      "h_tau": -11.58107454948913,
      "tau_mean": 0.00018517452743395906,
      "bond_mean_avg": 10.82527448537168,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    },
    {
      "step": 22,
      "train_loss": 5306.18634418709,
      "train_quality": 0.4976952245054781,
      "val_loss": 6995.645983339741,
      "val_quality": 0.33104633460233956,
      "test_quality": 0.3733323856425892,
      "patience_counter": 4,
      "elbo_raw": 0.0,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -10197.417810316752,
      "e_log_p_bonds": -6001.056006273413,
      "e_log_p_tau": -0.0001861643995768914,
      "h_nodes": 0.0,
      "h_bonds": -350.9190059281807,
      "h_tau": -11.57574316937098,
      "tau_mean": 0.0001861643995768914,
      "bond_mean_avg": 10.818931627329393,
      "n_parameters": 10080,
      "dim_x0": 28,
      "dim_b0": 18,
      "dim_x1": 28,
      "dim_b1": 18,
      "dim_x2": 28
    }
  ],
  "summary": {}
}