{
  "experiment_name": "kfold_energy_efficiency",
  "run_name": "energy_efficiency-BTT-L4-d18-seed42-fold2",
  "config": {
    "params": {
      "model": "BTT",
      "L": 4,
      "bond_dim": 18,
      "init_strength": 0.01,
      "bond_prior_alpha": 1.0,
      "added_bias": false,
      "n_epochs": 100,
      "batch_size": 256,
      "patience": 100,
      "min_delta": 0.0001,
      "warmup_epochs": 5,
      "trim_every": 3,
      "trimming_threshold": 0.3,
      "trim_method": "relevance",
      "soft_trim_relaxation": 2
    },
    "fold": 2,
    "seed": 42
  },
  "hparams": {
    "seed": 42,
    "fold": 2,
    "dataset": "energy_efficiency",
    "n_features": 8,
    "n_train": 522,
    "n_val": 92,
    "n_test": 154,
    "L": 4,
    "bond_dim": 18,
    "model": "BTT",
    "init_strength": 0.01,
    "bond_prior_alpha": 1.0,
    "added_bias": false,
    "n_epochs": 100,
    "batch_size": 256,
    "patience": 100,
    "min_delta": 0.0001,
    "warmup_epochs": 5,
    "trim_every": 3,
    "trimming_threshold": 0.3,
    "trim_method": "relevance",
    "soft_trim_relaxation": 2
  },
  "metrics_log": [
    {
      "step": 0,
      "train_loss": 1244.8982134627026,
      "train_quality": -11.245679817945144,
      "val_loss": 947.3950671302428,
      "val_quality": -9.35688884278397,
      "patience_counter": 0,
      "elbo_raw": -352125.3471857807,
      "elbo_relative": 0.0,
      "e_log_p_nodes": -11962.623181658504,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -1.0,
      "h_nodes": -12042.574143844482,
      "h_bonds": 140.0,
      "h_tau": 1.0,
      "tau_mean": 1.0,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 1,
      "train_loss": 0.18459673725840706,
      "train_quality": 0.9981841788224467,
      "val_loss": 0.35402344532226576,
      "val_quality": 0.9961298284125032,
      "test_quality": 0.9957570426525847,
      "patience_counter": 0,
      "elbo_raw": -8226.37262102457,
      "elbo_relative": 343898.97456475615,
      "e_log_p_nodes": -18662.615259035523,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -1.631579525842231,
      "h_nodes": 13571.079330385213,
      "h_bonds": 140.0,
      "h_tau": -0.876958618048775,
      "tau_mean": 1.631579525842231,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 2,
      "train_loss": 0.11269067901920661,
      "train_quality": 0.9988914965425988,
      "val_loss": 0.23266597248139373,
      "val_quality": 0.9974565039463555,
      "test_quality": 0.9970442164775958,
      "patience_counter": 0,
      "elbo_raw": -6919.970648045764,
      "elbo_relative": 345205.37653773493,
      "e_log_p_nodes": -18444.032911506405,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -2.7867845644958624,
      "h_nodes": 14518.639914492347,
      "h_bonds": 140.0,
      "h_tau": -0.34161875254881124,
      "tau_mean": 2.7867845644958624,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 3,
      "train_loss": 0.10752182162686635,
      "train_quality": 0.9989423409987693,
      "val_loss": 0.2394669742745357,
      "val_quality": 0.9973821556390495,
      "test_quality": 0.9968652078999033,
      "patience_counter": 1,
      "elbo_raw": -6749.917388866708,
      "elbo_relative": 345375.429796914,
      "e_log_p_nodes": -18438.515481346574,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -4.104548386024549,
      "h_nodes": 14581.727379009113,
      "h_bonds": 140.0,
      "h_tau": 0.045588523351625554,
      "tau_mean": 4.104548386024549,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 4,
      "train_loss": 0.10654914926325254,
      "train_quality": 0.9989519088768527,
      "val_loss": 0.22327988202737956,
      "val_quality": 0.9975591123500439,
      "test_quality": 0.997172835307681,
      "patience_counter": 0,
      "elbo_raw": -6091.751633229134,
      "elbo_relative": 346033.59555255156,
      "e_log_p_nodes": -17943.154600096008,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -5.278456228013613,
      "h_nodes": 14678.62934825598,
      "h_bonds": 140.0,
      "h_tau": 0.2971264759926271,
      "tau_mean": 5.278456228013613,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 5,
      "train_loss": 0.11151073144567236,
      "train_quality": 0.9989031033230016,
      "val_loss": 0.2091345244625026,
      "val_quality": 0.9977137488908322,
      "test_quality": 0.9973012028855134,
      "patience_counter": 0,
      "elbo_raw": -5881.870867703832,
      "elbo_relative": 346243.4763180769,
      "e_log_p_nodes": -17857.244568439703,
      "e_log_p_bonds": -2659.547584987337,
      "e_log_p_tau": -6.177325789546547,
      "h_nodes": 14761.40010573183,
      "h_bonds": 140.0,
      "h_tau": 0.45437825976523527,
      "tau_mean": 6.177325789546547,
      "bond_mean_avg": 1.0,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 6,
      "train_loss": 0.11098447489582508,
      "train_quality": 0.9989082799463928,
      "val_loss": 0.21084404803693185,
      "val_quality": 0.9976950604405238,
      "test_quality": 0.9972095338506755,
      "patience_counter": 1,
      "elbo_raw": -605.1814754915722,
      "elbo_relative": 351520.16571028915,
      "e_log_p_nodes": -12642.317083536062,
      "e_log_p_bonds": -2429.6864496057424,
      "e_log_p_tau": -6.906752621207683,
      "h_nodes": 14768.939344108267,
      "h_bonds": -64.8813366690494,
      "h_tau": 0.5659923758853438,
      "tau_mean": 6.906752621207683,
      "bond_mean_avg": 2.6916860500759823,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 7,
      "train_loss": 0.10138051822174794,
      "train_quality": 0.9990027511064798,
      "val_loss": 0.23443288883763966,
      "val_quality": 0.9974371880802179,
      "test_quality": 0.9970940581824661,
      "patience_counter": 2,
      "elbo_raw": 8236.565477419786,
      "elbo_relative": 360361.91266320046,
      "e_log_p_nodes": -12737.905472636043,
      "e_log_p_bonds": -2838.8381274108774,
      "e_log_p_tau": -6.1290007836628275,
      "h_nodes": 24188.725272427142,
      "h_bonds": -106.87962498626388,
      "h_tau": 0.44652453444905404,
      "tau_mean": 6.1290007836628275,
      "bond_mean_avg": 3.1188576253819997,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 8,
      "train_loss": 0.11721453448970112,
      "train_quality": 0.9988469967714245,
      "val_loss": 0.25288009434040526,
      "val_quality": 0.997235523892298,
      "test_quality": 0.996901824302156,
      "patience_counter": 3,
      "elbo_raw": 16439.2847446474,
      "elbo_relative": 368564.6319304281,
      "e_log_p_nodes": -12782.805505574332,
      "e_log_p_bonds": -3302.7947662209435,
      "e_log_p_tau": -5.1730040833728825,
      "h_nodes": 32990.73421192759,
      "h_bonds": -152.88319018102595,
      "h_tau": 0.2769463824677132,
      "tau_mean": 5.1730040833728825,
      "bond_mean_avg": 3.7468405661264006,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 9,
      "train_loss": 0.1885221649777591,
      "train_quality": 0.9981455656005144,
      "val_loss": 0.414710503536294,
      "val_quality": 0.9954663996720283,
      "test_quality": 0.9958644010246918,
      "patience_counter": 4,
      "elbo_raw": 24438.00149380541,
      "elbo_relative": 376563.3486795861,
      "e_log_p_nodes": -12823.815851891215,
      "e_log_p_bonds": -3796.041454122978,
      "e_log_p_tau": -3.5824681455214966,
      "h_nodes": 41671.18721123032,
      "h_bonds": -204.10315881230827,
      "h_tau": -0.0904552089250501,
      "tau_mean": 3.5824681455214966,
      "bond_mean_avg": 4.1447031103252465,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 10,
      "train_loss": 0.5462674282312519,
      "train_quality": 0.994626535769149,
      "val_loss": 0.8328024930392298,
      "val_quality": 0.9908958330609348,
      "test_quality": 0.9889952472956247,
      "patience_counter": 5,
      "elbo_raw": 32303.49433649517,
      "elbo_relative": 384428.8415222759,
      "e_log_p_nodes": -12866.852374681665,
      "e_log_p_bonds": -4287.32963582113,
      "e_log_p_tau": -1.493323340616342,
      "h_nodes": 50352.1986807047,
      "h_bonds": -256.0346049018334,
      "h_tau": -0.9655031317311114,
      "tau_mean": 1.493323340616342,
      "bond_mean_avg": 4.435514592558124,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 11,
      "train_loss": 0.8309293807085385,
      "train_quality": 0.9918264039280951,
      "val_loss": 0.950031230435937,
      "val_quality": 0.989614292714651,
      "test_quality": 0.9884679837995892,
      "patience_counter": 6,
      "elbo_raw": 40475.86776971262,
      "elbo_relative": 392601.21495549334,
      "e_log_p_nodes": -12907.368200216835,
      "e_log_p_bonds": -4768.131682837882,
      "e_log_p_tau": -0.8892597721560869,
      "h_nodes": 59232.8230270743,
      "h_bonds": -307.1546626723468,
      "h_tau": -1.4838730769185986,
      "tau_mean": 0.8892597721560869,
      "bond_mean_avg": 4.688200331538509,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 12,
      "train_loss": 0.7806864429271427,
      "train_quality": 0.9923206282128842,
      "val_loss": 1.0414000915722965,
      "val_quality": 0.9886154516067408,
      "test_quality": 0.9890779844507926,
      "patience_counter": 7,
      "elbo_raw": 48762.033866978134,
      "elbo_relative": 400887.38105275884,
      "e_log_p_nodes": -12954.964939854231,
      "e_log_p_bonds": -5267.913407900767,
      "e_log_p_tau": -0.7828660678145682,
      "h_nodes": 68154.35853389758,
      "h_bonds": -361.75958524823005,
      "h_tau": -1.6113008455831732,
      "tau_mean": 0.7828660678145682,
      "bond_mean_avg": 4.786598482923026,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 13,
      "train_loss": 0.576905107923203,
      "train_quality": 0.9943251623622189,
      "val_loss": 0.9398035495163436,
      "val_quality": 0.9897261013550787,
      "test_quality": 0.9918118983420114,
      "patience_counter": 8,
      "elbo_raw": 56941.05006528789,
      "elbo_relative": 409066.3972510686,
      "e_log_p_nodes": -12989.47401710962,
      "e_log_p_bonds": -5737.2547728364,
      "e_log_p_tau": -0.8446850846836716,
      "h_nodes": 76866.99361885664,
      "h_bonds": -411.4405836184999,
      "h_tau": -1.5352985998513304,
      "tau_mean": 0.8446850846836716,
      "bond_mean_avg": 5.062532756111436,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 14,
      "train_loss": 0.72607561267251,
      "train_quality": 0.9928578181089402,
      "val_loss": 1.3082922735465292,
      "val_quality": 0.9856977958603496,
      "test_quality": 0.9895356315175082,
      "patience_counter": 9,
      "elbo_raw": 64981.49544176756,
      "elbo_relative": 417106.84262754826,
      "e_log_p_nodes": -13038.314534493184,
      "e_log_p_bonds": -6228.595571440526,
      "e_log_p_tau": -0.7633245585138517,
      "h_nodes": 85527.99199524432,
      "h_bonds": -465.2767256521725,
      "h_tau": -1.636579164480736,
      "tau_mean": 0.7633245585138517,
      "bond_mean_avg": 5.146715431154406,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 15,
      "train_loss": 1.7783276020931045,
      "train_quality": 0.982507139787699,
      "val_loss": 1.9495080121649093,
      "val_quality": 0.9786880484386848,
      "test_quality": 0.9833209142236367,
      "patience_counter": 10,
      "elbo_raw": 72674.56325903883,
      "elbo_relative": 424799.91044481954,
      "e_log_p_nodes": -13087.000826776737,
      "e_log_p_bonds": -6721.217899488387,
      "e_log_p_tau": -0.42102660021051413,
      "h_nodes": 93972.34282496246,
      "h_bonds": -519.3644281997939,
      "h_tau": -2.231566461813827,
      "tau_mean": 0.42102660021051413,
      "bond_mean_avg": 5.220743567257781,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    },
    {
      "step": 16,
      "train_loss": 3.1786990146527665,
      "train_quality": 0.9687321180558336,
      "val_loss": 3.6205873052953406,
      "val_quality": 0.960419869632503,
      "test_quality": 0.955960213138403,
      "patience_counter": 11,
      "elbo_raw": 80603.85551661107,
      "elbo_relative": 432729.2027023918,
      "e_log_p_nodes": -13130.70903919737,
      "e_log_p_bonds": -7210.652793056431,
      "e_log_p_tau": -0.22115208973180897,
      "h_nodes": 102656.51735374574,
      "h_bonds": -572.4161689591608,
      "h_tau": -2.8754118232418477,
      "tau_mean": 0.22115208973180897,
      "bond_mean_avg": 5.374651157631705,
      "n_parameters": 12564,
      "dim_x0": 8,
      "dim_b_leaf_0": 18,
      "dim_x1": 8,
      "dim_b_leaf_1": 18,
      "dim_x2": 8,
      "dim_b_leaf_2": 18,
      "dim_x3": 8,
      "dim_b_leaf_3": 18,
      "dim_b_lvl0_0": 18,
      "dim_b_lvl0_1": 18
    }
  ],
  "summary": {}
}